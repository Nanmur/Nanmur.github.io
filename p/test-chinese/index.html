<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="ËøôÊòØ‰∏Ä‰∏™ÂâØÊ†áÈ¢ò">
<title>StarcodeÁÆóÊ≥ïÂü∫Á°ÄÁè≠Á¨îËÆ∞</title>

<link rel='canonical' href='http://localhost:1313/p/test-chinese/'>

<link rel="stylesheet" href="/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css"><meta property='og:title' content="Chinese Test">
<meta property='og:description' content="ËøôÊòØ‰∏Ä‰∏™ÂâØÊ†áÈ¢ò">
<meta property='og:url' content='http://localhost:1313/p/test-chinese/'>
<meta property='og:site_name' content='NanmurSpace'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2024-12-14T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2024-12-14T00:00:00&#43;00:00'/><meta property='og:image' content='http://localhost:1313/p/test-chinese/helena-hertz-wWZzXlDpMog-unsplash.jpg' />
<meta name="twitter:title" content="Chinese Test">
<meta name="twitter:description" content="ËøôÊòØ‰∏Ä‰∏™ÂâØÊ†áÈ¢ò"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='http://localhost:1313/p/test-chinese/helena-hertz-wWZzXlDpMog-unsplash.jpg' />
    <link rel="shortcut icon" href="/favicon.ico" />

  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="ÂàáÊç¢ËèúÂçï">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu13739649187745961479.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üò¥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">NanmurSpace</a></h1>
            <h2 class="site-description">ÈöèÊ≥¢ÈÄêÊµÅÂç≥‰∏∫ÂêåÊµÅÂêàÊ±°</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/40694002'
                        target="_blank"
                        
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" /><path d="M8 3l2 3" /><path d="M16 3l-2 3" /><path d="M9 13v-2" /><path d="M15 11v2" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/Nanmur'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>‰∏ªÈ°µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>ÂÖ≥‰∫é</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>ÂΩíÊ°£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>ÊêúÁ¥¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>ÂèãÊÉÖÈìæÊé•</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>ÊöóËâ≤Ê®°Âºè</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ÁõÆÂΩï</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#1ÂâçÁºÄÂíåÂ∑ÆÂàÜ">1.ÂâçÁºÄÂíåÂ∑ÆÂàÜ</a>
      <ol>
        <li><a href="#ËæìÂÖ•ËæìÂá∫">ËæìÂÖ•ËæìÂá∫</a>
          <ol>
            <li><a href="#scanf-Âíå-printf">scanf Âíå printf</a></li>
            <li><a href="#cin-Âíå-cout">cin Âíå cout</a></li>
            <li><a href="#Êé®ËçêÂÜôÊ≥ï">Êé®ËçêÂÜôÊ≥ïÔºö</a></li>
          </ol>
        </li>
        <li><a href="#ÂâçÁºÄÂíåÊï∞ÁªÑ">ÂâçÁºÄÂíåÊï∞ÁªÑ</a>
          <ol>
            <li><a href="#ÂÖ∂ÂÆûËøôÁßçÊÄùÊÉ≥‰∏ç‰∏ÄÂÆöÈùûË¶ÅÊòØÂâçÁºÄÂíåÂâçÁºÄÁßØÂâçÁºÄÂºÇÊàñÈÉΩÂèØ‰ª•Âè™Ë¶ÅÊòØÊª°Ë∂≥ÂèØÂä†ÊÄßÁöÑËøêÁÆóÈÉΩÂèØ‰ª•‰ΩøÁî®">ÂÖ∂ÂÆûËøôÁßçÊÄùÊÉ≥‰∏ç‰∏ÄÂÆöÈùûË¶ÅÊòØÂâçÁºÄÂíåÔºåÂâçÁºÄÁßØÔºåÂâçÁºÄÂºÇÊàñÈÉΩÂèØ‰ª•ÔºåÂè™Ë¶ÅÊòØÊª°Ë∂≥ÂèØÂä†ÊÄßÁöÑËøêÁÆóÈÉΩÂèØ‰ª•‰ΩøÁî®</a></li>
          </ol>
        </li>
        <li><a href="#‰∫åÁª¥ÂâçÁºÄÂíå">‰∫åÁª¥ÂâçÁºÄÂíå</a></li>
        <li><a href="#Â∑ÆÂàÜÊï∞ÁªÑ">Â∑ÆÂàÜÊï∞ÁªÑ</a></li>
        <li><a href="#‰∫åÁª¥Â∑ÆÂàÜÊï∞ÁªÑ">‰∫åÁª¥Â∑ÆÂàÜÊï∞ÁªÑ</a></li>
      </ol>
    </li>
    <li><a href="#2‰ΩçËøêÁÆóÂèåÊåáÈíàÊéíÂ∫è‰∫åÂàÜ">2.‰ΩçËøêÁÆó„ÄÅÂèåÊåáÈíà„ÄÅÊéíÂ∫è‰∫åÂàÜ</a>
      <ol>
        <li><a href="#‰ΩçËøêÁÆóÈÉΩÂª∫Á´ãÂú®‰∫åËøõÂà∂ÁöÑÂü∫Á°Ä‰∏ä">‰ΩçËøêÁÆóÔºàÈÉΩÂª∫Á´ãÂú®‰∫åËøõÂà∂ÁöÑÂü∫Á°Ä‰∏äÔºâ</a>
          <ol>
            <li><a href="#‰∏éËøêÁÆó-">‰∏éËøêÁÆó &amp;</a></li>
            <li><a href="#ÊàñËøêÁÆó-">ÊàñËøêÁÆó |</a></li>
            <li><a href="#ÈùûËøêÁÆó-">ÈùûËøêÁÆó !</a></li>
            <li><a href="#ÂºÇÊàñËøêÁÆó-">ÂºÇÊàñËøêÁÆó ^</a></li>
            <li><a href="#Áßª‰ΩçËøêÁÆó--">Áßª‰ΩçËøêÁÆó &laquo; &raquo;</a></li>
            <li><a href="#ÂèñÂèçËøêÁÆó-">ÂèñÂèçËøêÁÆó ~</a></li>
          </ol>
        </li>
        <li><a href="#ÂèåÊåáÈíà">ÂèåÊåáÈíà</a></li>
        <li><a href="#‰∫åÂàÜ">‰∫åÂàÜ</a></li>
        <li><a href="#ÊéíÂ∫è">ÊéíÂ∫è</a>
          <ol>
            <li><a href="#ÊéíÂ∫èÂπ∂ÂéªÈáçÊ®°Êùø">ÊéíÂ∫èÂπ∂ÂéªÈáçÊ®°Êùø</a></li>
            <li><a href="#ÁªìÊûÑ‰ΩìÊéíÂ∫èÊ®°Êùø">ÁªìÊûÑ‰ΩìÊéíÂ∫èÊ®°Êùø</a></li>
            <li><a href="#Ê°∂ÊéíÂ∫èÊ®°Êùø">Ê°∂ÊéíÂ∫èÊ®°Êùø</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#3Ê†à‰ºòÂÖàÈòüÂàómapsetbitset">3.Ê†à„ÄÅ‰ºòÂÖàÈòüÂàó„ÄÅmap„ÄÅset„ÄÅbitset</a>
      <ol>
        <li><a href="#Ê†à">Ê†à</a></li>
        <li><a href="#‰ºòÂÖàÈòüÂàóÂ†Üpriority_queue">‰ºòÂÖàÈòüÂàó/Â†Ü(priority_queue)</a></li>
        <li><a href="#map">map</a></li>
        <li><a href="#set">set</a></li>
        <li><a href="#bitset">bitset</a></li>
      </ol>
    </li>
    <li><a href="#4ÂçïË∞ÉÊ†àÂçïË∞ÉÈòüÂàó">4.ÂçïË∞ÉÊ†à„ÄÅÂçïË∞ÉÈòüÂàó</a>
      <ol>
        <li><a href="#ÂçïË∞ÉÊ†à">ÂçïË∞ÉÊ†à</a></li>
        <li><a href="#ÂçïË∞ÉÈòüÂàó">ÂçïË∞ÉÈòüÂàó</a></li>
      </ol>
    </li>
    <li><a href="#5Ê†ëÁä∂Êï∞ÁªÑÂíåÁ¶ªÊï£Âåñ">5.Ê†ëÁä∂Êï∞ÁªÑÂíåÁ¶ªÊï£Âåñ</a>
      <ol>
        <li><a href="#Ê†ëÁä∂Êï∞ÁªÑ">Ê†ëÁä∂Êï∞ÁªÑ</a></li>
        <li><a href="#Á¶ªÊï£Âåñ">Á¶ªÊï£Âåñ</a></li>
      </ol>
    </li>
    <li><a href="#6ÂõæÁöÑÂ≠òÂÇ®dfsbfs">6.ÂõæÁöÑÂ≠òÂÇ®„ÄÅDFS„ÄÅBFS</a>
      <ol>
        <li><a href="#ÂõæÁöÑÂ≠òÂÇ®">ÂõæÁöÑÂ≠òÂÇ®</a>
          <ol>
            <li><a href="#ÈÇªÊé•Áü©Èòµ">ÈÇªÊé•Áü©Èòµ</a></li>
          </ol>
        </li>
        <li><a href="#Ê∑±Â∫¶‰ºòÂÖàÊêúÁ¥¢dfs">Ê∑±Â∫¶‰ºòÂÖàÊêúÁ¥¢ÔºàDFSÔºâ</a>
          <ol>
            <li><a href="#ÂÖ®ÊéíÂàó">ÂÖ®ÊéíÂàó</a></li>
          </ol>
        </li>
        <li><a href="#ÂπøÂ∫¶‰ºòÂÖàÊêúÁ¥¢bfs">ÂπøÂ∫¶‰ºòÂÖàÊêúÁ¥¢ÔºàBFSÔºâ</a></li>
        <li><a href="#ÈÇªÊé•Ë°®">ÈÇªÊé•Ë°®</a></li>
      </ol>
    </li>
    <li><a href="#7Âπ∂Êü•ÈõÜÊúÄÁü≠Ë∑Ø">7.Âπ∂Êü•ÈõÜ„ÄÅÊúÄÁü≠Ë∑Ø</a>
      <ol>
        <li><a href="#Âπ∂Êü•ÈõÜ">Âπ∂Êü•ÈõÜ</a></li>
        <li><a href="#ÊúÄÁü≠Ë∑Ø">ÊúÄÁü≠Ë∑Ø</a>
          <ol>
            <li><a href="#Â∏∏ËßÅÁöÑÊúÄÁü≠Ë∑ØÂæÑÁÆóÊ≥ï">Â∏∏ËßÅÁöÑÊúÄÁü≠Ë∑ØÂæÑÁÆóÊ≥ï####</a></li>
          </ol>
        </li>
        <li><a href="#ÁÆóÊ≥ïÂØπÊØî">ÁÆóÊ≥ïÂØπÊØî</a></li>
      </ol>
    </li>
    <li><a href="#8ÊúÄÂ∞èÁîüÊàêÊ†ëË¥®Âõ†Êï∞ÂàÜËß£">8.ÊúÄÂ∞èÁîüÊàêÊ†ë„ÄÅË¥®Âõ†Êï∞ÂàÜËß£</a>
      <ol>
        <li><a href="#ÊúÄÂ∞èÁîüÊàêÊ†ë">ÊúÄÂ∞èÁîüÊàêÊ†ë</a>
          <ol>
            <li><a href="#Âü∫‰∫éÁÇπÁöÑÊúÄÂ∞èÁîüÊàêÊ†ëprimÁÆóÊ≥ï">Âü∫‰∫éÁÇπÁöÑÊúÄÂ∞èÁîüÊàêÊ†ëprimÁÆóÊ≥ï</a></li>
            <li><a href="#Âü∫‰∫éËæπÁöÑÊúÄÂ∞èÁîüÊàêÊ†ëkruskalÁÆóÊ≥ï">Âü∫‰∫éËæπÁöÑÊúÄÂ∞èÁîüÊàêÊ†ëkruskalÁÆóÊ≥ï</a></li>
          </ol>
        </li>
        <li><a href="#Ë¥®Âõ†Êï∞ÂàÜËß£">Ë¥®Âõ†Êï∞ÂàÜËß£</a>
          <ol>
            <li><a href="#Ë¥®Êï∞Á¥†Êï∞Âà§Êñ≠">Ë¥®Êï∞ÔºàÁ¥†Êï∞ÔºâÂà§Êñ≠</a></li>
            <li><a href="#Ê±ÇnÁöÑÊâÄÊúâÂõ†Êï∞">Ê±ÇNÁöÑÊâÄÊúâÂõ†Êï∞</a></li>
            <li><a href="#Ê±ÇnÁöÑÊâÄÊúâË¥®Âõ†Â≠ê">Ê±ÇNÁöÑÊâÄÊúâË¥®Âõ†Â≠ê</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#9ÂüÉÊ∞èÁ≠õÊ≥ïgcdÂíålcmÂø´ÈÄüÂπÇ‰πòÊ≥ïÈÄÜÂÖÉ">9.ÂüÉÊ∞èÁ≠õÊ≥ï„ÄÅgcdÂíålcm„ÄÅÂø´ÈÄüÂπÇ„ÄÅ‰πòÊ≥ïÈÄÜÂÖÉ</a>
      <ol>
        <li><a href="#ÂüÉÊ∞èÁ≠õÊ≥ï">ÂüÉÊ∞èÁ≠õÊ≥ï</a></li>
        <li><a href="#gcdÂíålcm">gcdÂíålcm</a></li>
        <li><a href="#Âø´ÈÄüÂπÇ">Âø´ÈÄüÂπÇ</a></li>
        <li><a href="#‰πòÊ≥ïÈÄÜÂÖÉ">‰πòÊ≥ïÈÄÜÂÖÉ</a></li>
      </ol>
    </li>
    <li><a href="#10ÁªÑÂêàÊï∞01ËÉåÂåÖÂÆåÂÖ®ËÉåÂåÖ">10.ÁªÑÂêàÊï∞„ÄÅ01ËÉåÂåÖ„ÄÅÂÆåÂÖ®ËÉåÂåÖ</a>
      <ol>
        <li><a href="#ÁªÑÂêàÊï∞">ÁªÑÂêàÊï∞</a></li>
        <li><a href="#0-1ËÉåÂåÖ">0-1ËÉåÂåÖ</a></li>
        <li><a href="#Êó†Á©∑ÂÆåÂÖ®ËÉåÂåÖ">Êó†Á©∑/ÂÆåÂÖ®ËÉåÂåÖ</a></li>
      </ol>
    </li>
    <li><a href="#11Â§öÈáçËÉåÂåÖÁöÑ‰∫åËøõÂà∂‰ºòÂåñÂçïË∞ÉÊ†à‰∫åÂàÜdp">11.Â§öÈáçËÉåÂåÖÁöÑ‰∫åËøõÂà∂‰ºòÂåñ„ÄÅÂçïË∞ÉÊ†à‰∫åÂàÜdp</a>
      <ol>
        <li><a href="#Â§öÈáçËÉåÂåÖÁöÑ‰∫åËøõÂà∂‰ºòÂåñ">Â§öÈáçËÉåÂåÖÁöÑ‰∫åËøõÂà∂‰ºòÂåñ</a>
          <ol>
            <li><a href="#Â§öÈáçËÉåÂåÖ">Â§öÈáçËÉåÂåÖ</a></li>
            <li><a href="#Â§öÈáçËÉåÂåÖÁöÑ‰∫åËøõÂà∂‰ºòÂåñ-1">Â§öÈáçËÉåÂåÖÁöÑ‰∫åËøõÂà∂‰ºòÂåñ</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#12dpÂàÜÁ±ª‰∏éÁ≤æËÆ≤Á∫øÊÄßdpÂå∫Èó¥dpÊ†ëÂΩ¢dp">12.DPÂàÜÁ±ª‰∏éÁ≤æËÆ≤Á∫øÊÄßdp„ÄÅÂå∫Èó¥dp„ÄÅÊ†ëÂΩ¢dp</a>
      <ol>
        <li><a href="#1-Á∫øÊÄß-dp">1. Á∫øÊÄß DP**</a></li>
        <li><a href="#2Âå∫Èó¥dp">2.Âå∫Èó¥DP</a></li>
        <li><a href="#3Ê†ëÂΩ¢dp">3.Ê†ëÂΩ¢DP</a>
          <ol>
            <li><a href="#ÊÄªÁªì"><strong>ÊÄªÁªì</strong></a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/test-chinese/">
                <img src="/p/test-chinese/helena-hertz-wWZzXlDpMog-unsplash_hu4773291511026196957.jpg"
                        srcset="/p/test-chinese/helena-hertz-wWZzXlDpMog-unsplash_hu4773291511026196957.jpg 800w, /p/test-chinese/helena-hertz-wWZzXlDpMog-unsplash_hu4180424280031756831.jpg 1600w"
                        width="800" 
                        height="600" 
                        loading="lazy"
                        alt="Featured image of post StarcodeÁÆóÊ≥ïÂü∫Á°ÄÁè≠Á¨îËÆ∞" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/test/" style="background-color: #2a9d8f; color: #fff;">
                Test
            </a>
        
            <a href="/categories/%E6%B5%8B%E8%AF%95/" >
                ÊµãËØï
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/test-chinese/">Chinese Test</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            ËøôÊòØ‰∏Ä‰∏™ÂâØÊ†áÈ¢ò
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2020-09-09</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="1ÂâçÁºÄÂíåÂ∑ÆÂàÜ">1.ÂâçÁºÄÂíåÂ∑ÆÂàÜ
</h2><h3 id="ËæìÂÖ•ËæìÂá∫">ËæìÂÖ•ËæìÂá∫
</h3><h4 id="scanf-Âíå-printf">scanf Âíå printf
</h4><p>‰ºòÁÇπÔºöÊ†ºÂºèÂåñËæìÂÖ•„ÄÅËæìÂá∫  %.nlfÂèØ‰ª•‰øùÁïôn‰ΩçËæìÂá∫ÊµÆÁÇπÊï∞Ôºà‰∏ÄËà¨Á´ûËµõ‰∏≠Âè™Áî®double Âõ†‰∏∫floatËÉΩÂÅöÁöÑdoubleÈÉΩËÉΩÂÅöÔºâ</p>
<h4 id="cin-Âíå-cout">cin Âíå cout
</h4><p>‰ºòÁÇπÔºöÁÆÄÊ¥ÅÔºåÂú®ÂèñÊ∂àÂêåÊ≠•ÊµÅÁöÑÊÉÖÂÜµ‰∏ã‰∏ÄËà¨ÊØîscanfÊõ¥Âø´
ÂèñÊ∂àÂêåÊ≠•ÊµÅÔºà<strong>‰∏ÄÂÆöË¶ÅÊää‰∏â‰∏™ËØ≠Âè•ÂÜôÂÆåÊï¥</strong>ÔºâÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="n">ios</span><span class="o">::</span> <span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÂΩìÂèñÊ∂à‰∫ÜÂêåÊ≠•ÊµÅ‰πãÂêéÔºåÂ∫îËØ•ÈÅøÂÖç‰ΩøÁî® endlÔºåÂõ†‰∏∫ÂÆÉ‰ºöÂØºËá¥ÁºìÂÜ≤Âå∫Á´ãÂç≥Âà∑Êñ∞ÔºåÂºïËµ∑‰∏çÂøÖË¶ÅÁöÑÁ≥ªÁªüË∞ÉÁî®ÔºåÈôç‰ΩéÁ®ãÂ∫èÁöÑÊâßË°åÊïàÁéá„ÄÇÁõ∏ÂèçÔºåÊé®Ëçê‰ΩøÁî® &lsquo;\n&rsquo; Êù•Êõø‰ª£ endlÔºåÂÆÉÂè™ÊèíÂÖ•‰∏Ä‰∏™Êç¢Ë°åÁ¨¶Ôºå‰∏ç‰ºöÂà∑Êñ∞ÁºìÂÜ≤Âå∫</strong></p>
<h4 id="Êé®ËçêÂÜôÊ≥ï">Êé®ËçêÂÜôÊ≥ïÔºö
</h4><p>1.Á°ÆÂÆöÊï∞ÁªÑNÁöÑÂ§ßÂ∞èÔºåÁî®const int‰∏çË¶ÅÁî®define
2.Âª∫ËÆÆÂºÄÂÖ®Â±ÄÊï∞ÁªÑ„ÄÇÊ≥®ÊÑèÔºåÂÖ®Â±ÄÁöÑÊï∞ÁªÑËá™Âä®ÂàùÂßãÂåñ‰∏∫0„ÄÇÂáΩÊï∞ÈáåÈù¢ÁöÑÊï∞ÁªÑ‰ΩøÁî®ÁöÑÊòØÊ†àÁ©∫Èó¥ÔºàÂæàÂ∞èÔºâÔºå‰∏î‰∏ç‰ºöÂàùÂßãÂåñ„ÄÇ
3.ËæìÂÖ•Ë¶ÅÂçïÁã¨ÂÅöÔºåÂ¶ÇÊûúÂºÄÂæ™ÁéØÁöÑËØùÔºåÂè™Âú®Âæ™ÁéØÈáåÂÅöËæìÂÖ•ÊàñËæìÂá∫ÔºåÂÖ∂‰ªñÁöÑÊìç‰Ωú‰∏çË¶ÅÂú®Ëøô‰∏™Âæ™ÁéØÂÜÖÂÅö„ÄÇ</p>
<h3 id="ÂâçÁºÄÂíåÊï∞ÁªÑ">ÂâçÁºÄÂíåÊï∞ÁªÑ
</h3><p>ÂâçÁºÄÂíåÊï∞ÁªÑÊòØ‰∏ÄÁßçÂú®ÁÆóÊ≥ï‰∏≠Â∏∏Áî®ÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÁî®‰∫éÂ≠òÂÇ®‰∏Ä‰∏™Â∫èÂàóÔºàÈÄöÂ∏∏ÊòØÊï∞ÁªÑÔºâÁöÑÂâçÁºÄÔºàÂç≥‰ªéÂºÄÂßãÂà∞ÂΩìÂâç‰ΩçÁΩÆÁöÑÊâÄÊúâÂÖÉÁ¥†ÁöÑÂíåÔºâ„ÄÇËøôÁßçÊï∞ÊçÆÁªìÊûÑÂèØ‰ª•Âø´ÈÄüÂú∞ËÆ°ÁÆóÊüê‰∏™Â∫èÂàóÁöÑ‰ªª‰Ωï‰∏ÄÊÆµÂå∫Èó¥ÁöÑÂíåÔºåËÄå‰∏çÈúÄË¶ÅÈáçÂ§çËÆ°ÁÆó„ÄÇ</p>
<h4 id="ÂÖ∂ÂÆûËøôÁßçÊÄùÊÉ≥‰∏ç‰∏ÄÂÆöÈùûË¶ÅÊòØÂâçÁºÄÂíåÂâçÁºÄÁßØÂâçÁºÄÂºÇÊàñÈÉΩÂèØ‰ª•Âè™Ë¶ÅÊòØÊª°Ë∂≥ÂèØÂä†ÊÄßÁöÑËøêÁÆóÈÉΩÂèØ‰ª•‰ΩøÁî®">ÂÖ∂ÂÆûËøôÁßçÊÄùÊÉ≥‰∏ç‰∏ÄÂÆöÈùûË¶ÅÊòØÂâçÁºÄÂíåÔºåÂâçÁºÄÁßØÔºåÂâçÁºÄÂºÇÊàñÈÉΩÂèØ‰ª•ÔºåÂè™Ë¶ÅÊòØÊª°Ë∂≥ÂèØÂä†ÊÄßÁöÑËøêÁÆóÈÉΩÂèØ‰ª•‰ΩøÁî®
</h4><p><strong>ÂâçÁºÄÂíåÊï∞ÁªÑÂú®ÁÆóÊ≥ï‰∏≠ÈùûÂ∏∏ÊúâÁî®ÔºåÂ∞§ÂÖ∂ÊòØÂú®Â§ÑÁêÜÂå∫Èó¥Âíå„ÄÅËøûÁª≠Â≠êÊï∞ÁªÑÂíåÁ≠âÈóÆÈ¢òÊó∂„ÄÇÂÆÉÂèØ‰ª•Â∞ÜÊó∂Èó¥Â§çÊùÇÂ∫¶‰ªé O(n^2) Èôç‰ΩéÂà∞ O(n)„ÄÇ</strong>
ÂÖ∂ÈÄíÊé®Âºè‰∏∫Ôºö<strong>prefix[i] = p[i-1] - a[i]</strong>
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="n">nums</span><span class="p">[]</span> <span class="p">(</span><span class="err">Êï∞ÁªÑ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="n">prefix_sum</span><span class="p">[]</span> <span class="p">(</span><span class="err">ÂâçÁºÄÂíåÊï∞ÁªÑ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">prefix_sum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">ËÆ°ÁÆóÂâçÁºÄÂíå</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="n">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">prefix_sum</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefix_sum</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">Êü•ËØ¢‰ªªÊÑèÂå∫Èó¥</span> <span class="p">[</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">]</span> <span class="err">ÁöÑÂíå</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">function</span> <span class="n">range_sum</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">prefix_sum</span><span class="p">[</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">prefix_sum</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="err">Á§∫‰æã</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">range_sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="err">Ë°®Á§∫</span> <span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">nums</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">nums</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">prefix</span><span class="p">[</span><span class="n">N</span><span class="p">];</span><span class="c1">//aÁî®Êù•Â≠òÊúÄÂàùÁöÑÊï∞ÁªÑÔºåprefixÂç≥ÊòØÂâçÁºÄÂíåÊï∞ÁªÑ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefix</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="c1">//Âà©Áî®ÂâçÁºÄÂíåÊï∞ÁªÑÁöÑÂèØÂä†ÊÄß ÁÆÄ‰æøËÆ°ÁÆó
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="‰∫åÁª¥ÂâçÁºÄÂíå">‰∫åÁª¥ÂâçÁºÄÂíå
</h3><p>‰∫åÁª¥ÂâçÁºÄÂíåÊòØ‰∏ÄÁßçÁî®‰∫éÂø´ÈÄüËÆ°ÁÆó‰∫åÁª¥Êï∞ÁªÑ‰∏≠‰ªªÊÑèÂ≠êÁü©ÈòµÂå∫ÂüüÂíåÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÇÂÆÉÈÄöËøáÊûÑÂª∫‰∏Ä‰∏™‰∏éÂéüÁü©ÈòµÂ§ßÂ∞èÁõ∏ÂêåÁöÑ‰∫åÁª¥ÂâçÁºÄÂíåÊï∞ÁªÑÊù•ÂÆûÁé∞ÔºåÂÖ∂‰∏≠ÊØè‰∏™ÂÖÉÁ¥†Â≠òÂÇ®‰∫ÜÂéüÊï∞ÁªÑ‰∏≠‰ªéÂ∑¶‰∏äËßíËµ∑ÁÇπ (0, 0) Âà∞ÂΩìÂâç‰ΩçÁΩÆ (i, j) ÁöÑÂ≠êÁü©ÈòµÂå∫ÂüüÂÜÖÊâÄÊúâÂÖÉÁ¥†ÁöÑÂíå„ÄÇ
ÂÖ∂ÈÄíÊé®Âºè‰∏∫Ôºö<strong>prefix[i][j] = prefix[i-1][j] + prefix[i][j-1] +a[i][j]-p[i-1][j-1]</strong>
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="n">matrix</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">m</span><span class="p">]</span> <span class="p">(</span><span class="err">‰∫åÁª¥Áü©Èòµ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="n">prefix_sum</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="p">(</span><span class="err">‰∫åÁª¥ÂâçÁºÄÂíåÊï∞ÁªÑ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="err">ÂàõÂª∫‰∏Ä‰∏™Â§ßÂ∞è‰∏∫</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="n">x</span> <span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="err">ÁöÑ‰∫åÁª¥Êï∞ÁªÑ</span> <span class="n">prefix_sum</span><span class="err">ÔºåÊâÄÊúâÂÖÉÁ¥†ÂàùÂßãÂåñ‰∏∫</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">ËÆ°ÁÆó‰∫åÁª¥ÂâçÁºÄÂíå</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">m</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">           <span class="n">prefix_sum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                             <span class="o">+</span> <span class="n">prefix_sum</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                             <span class="o">+</span> <span class="n">prefix_sum</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                             <span class="o">-</span> <span class="n">prefix_sum</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">Êü•ËØ¢‰ªªÊÑèÂ≠êÁü©ÈòµÂíå</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">function</span> <span class="n">range_sum</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="cp"># Áü©ÈòµÂå∫Âüü [(x1, y1), (x2, y2)]ÔºåÊ≥®ÊÑèËøôÈáåÊòØ1-based‰∏ãÊ†á
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>       <span class="k">return</span> <span class="n">prefix_sum</span><span class="p">[</span><span class="n">x2</span><span class="p">][</span><span class="n">y2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">              <span class="o">-</span> <span class="n">prefix_sum</span><span class="p">[</span><span class="n">x1</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">y2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">              <span class="o">-</span> <span class="n">prefix_sum</span><span class="p">[</span><span class="n">x2</span><span class="p">][</span><span class="n">y1</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">              <span class="o">+</span> <span class="n">prefix_sum</span><span class="p">[</span><span class="n">x1</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">y1</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="err">Á§∫‰æã</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="err">ËæìÂÖ•</span><span class="o">:</span> <span class="err">Áü©Èòµ</span> <span class="na">[[1, 2], [3, 4]]</span>
</span></span><span class="line"><span class="cl">   <span class="nl">prefix_sum</span><span class="p">:</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">   <span class="n">range_sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">prefix</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">q</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="c1">//Ëá≥Ê≠§Â∑≤ÁªèÊûÑÈÄ†Âá∫‰∫åÁª¥ÂâçÁºÄÂíåÊï∞ÁªÑ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span><span class="p">(</span><span class="n">q</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x1</span> <span class="o">&gt;&gt;</span> <span class="n">y1</span> <span class="o">&gt;&gt;</span> <span class="n">x2</span> <span class="o">&gt;&gt;</span> <span class="n">y2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">area</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">area</span> <span class="o">=</span> <span class="n">prefix</span><span class="p">[</span><span class="n">x2</span><span class="p">][</span><span class="n">y2</span><span class="p">]</span> <span class="o">-</span> <span class="n">prefix</span><span class="p">[</span><span class="n">x2</span><span class="p">][</span><span class="n">y1</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span><span class="n">prefix</span><span class="p">[</span><span class="n">x1</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">y2</span><span class="p">]</span> <span class="o">+</span> <span class="n">prefix</span><span class="p">[</span><span class="n">x1</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">y1</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="Â∑ÆÂàÜÊï∞ÁªÑ">Â∑ÆÂàÜÊï∞ÁªÑ
</h3><p>Â∑ÆÂàÜÊï∞ÁªÑÊòØ‰∏ÄÁßçÂ§ÑÁêÜÂ∫èÂàóÂä®ÊÄÅ‰øÆÊîπÈóÆÈ¢òÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÂÆÉÈÄöËøáËÆ∞ÂΩïÊØè‰∏™ÂÖÉÁ¥†‰∏éÂÖ∂Ââç‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÂ∑ÆÂÄºÊù•Ë°®Á§∫ÂéüÂßãÊï∞ÁªÑÁöÑÂèòÂåñ„ÄÇËøôÁßçÊï∞ÊçÆÁªìÊûÑÁöÑ‰∏ªË¶ÅÁî®ÈÄîÊòØÁÆÄÂåñÂØπÂéüÊï∞ÁªÑÁöÑÈ¢ëÁπÅÊõ¥Êñ∞ÂíåÊü•ËØ¢Êìç‰ΩúÔºå‰ªéËÄåÊèêÈ´òÁÆóÊ≥ïÊïàÁéá„ÄÇ
Â∑ÆÂàÜÊï∞ÁªÑÁöÑ‰∏ªË¶Å‰ºòÁÇπÊòØËÉΩÂ§üÈ´òÊïàÂú∞Â§ÑÁêÜÂ§ßÈáèÂå∫Èó¥‰øÆÊîπÊìç‰Ωú„ÄÇÈÄöËøá‰øÆÊîπÂ∑ÆÂàÜÊï∞ÁªÑÔºåÂèØ‰ª•Èó¥Êé•ÂÆûÁé∞ÂéüÊï∞ÁªÑÁöÑÂå∫Èó¥‰øÆÊîπÔºåËÄå‰∏çÈúÄË¶ÅÁõ¥Êé•Êìç‰ΩúÂéüÊï∞ÁªÑÔºå‰ªéËÄåÊûÅÂ§ßÂú∞ÊèêÈ´ò‰∫ÜÁÆóÊ≥ïÊïàÁéá„ÄÇ
ÂÖ∂ÈÄíÊé®Âºè‰∏∫Ôºö<strong>diff[i] = a[i] - a[i-1]</strong>
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="n">nums</span><span class="p">[]</span> <span class="p">(</span><span class="err">ÂéüÊï∞ÁªÑ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="n">diff</span><span class="p">[]</span> <span class="p">(</span><span class="err">Â∑ÆÂàÜÊï∞ÁªÑ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñÂ∑ÆÂàÜÊï∞ÁªÑ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">diff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="n">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">diff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">Âå∫Èó¥‰øÆÊîπ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">function</span> <span class="n">update_range</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">diff</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">+=</span> <span class="n">val</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">           <span class="n">diff</span><span class="p">[</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">val</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">ËÆ°ÁÆó‰øÆÊîπÂêéÁöÑÊï∞ÁªÑ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="n">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">diff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="err">Á§∫‰æã</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="err">ÂàùÂßãÊï∞ÁªÑ</span><span class="o">:</span> <span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="err">‰øÆÊîπÂå∫Èó¥</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="err">Â¢ûÂä†ÂÄº</span> <span class="mi">2</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">diff</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">       <span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">diff</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">prefix</span><span class="p">[</span><span class="n">N</span><span class="p">];</span><span class="c1">//aÁî®Êù•Â≠òÊúÄÂàùÁöÑÊï∞ÁªÑÔºåprefixÂç≥ÊòØÂâçÁºÄÂíåÊï∞ÁªÑ,diffÂç≥ÊòØÂ∑ÆÂàÜÊï∞ÁªÑ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="n">diff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="‰∫åÁª¥Â∑ÆÂàÜÊï∞ÁªÑ">‰∫åÁª¥Â∑ÆÂàÜÊï∞ÁªÑ
</h3><p>‰∫åÁª¥Â∑ÆÂàÜÊï∞ÁªÑÊòØ‰∏ÄÁßçÁî®‰∫éÂ§ÑÁêÜ‰∫åÁª¥Êï∞ÁªÑ‰∏≠Âå∫Èó¥Êõ¥Êñ∞ÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÇÂÆÉÈÄöËøáËÆ∞ÂΩïÊØè‰∏™ÂÖÉÁ¥†‰∏éÂÖ∂Áõ∏ÈÇªÂÖÉÁ¥†ÔºàÂ∑¶„ÄÅ‰∏ä„ÄÅÂè≥„ÄÅ‰∏ãÔºâÁöÑÂ∑ÆÂÄºÊù•Ë°®Á§∫ÂéüÂßãÊï∞ÁªÑÁöÑÂèòÂåñ„ÄÇËøôÁßçÊï∞ÊçÆÁªìÊûÑÁöÑ‰∏ªË¶ÅÁî®ÈÄîÊòØÁÆÄÂåñÂØπÂéüÊï∞ÁªÑÁöÑÈ¢ëÁπÅÊõ¥Êñ∞Êìç‰ΩúÔºå‰ªéËÄåÊèêÈ´òÁÆóÊ≥ïÊïàÁéá„ÄÇ
‰∫åÁª¥Â∑ÆÂàÜÊï∞ÁªÑ diff Áî±ÂéüÊï∞ÁªÑ arr Ë°çÁîüËÄåÊù•ÔºåÂÖ∂‰∏≠ diff[i][j] Ë°®Á§∫ÂéüÊï∞ÁªÑ‰∏≠ÂÖÉÁ¥† arr[i][j] ‰∏éÂÖ∂Â∑¶‰æßÂÖÉÁ¥† arr[i][j-1]„ÄÅ‰∏ä‰æßÂÖÉÁ¥† arr[i-1][j] ÁöÑÂ∑ÆÂÄº„ÄÇ
ÂÖ∑‰ΩìÊù•ËØ¥Ôºö
<strong>diff[i][j] = arr[i][j] - arr[i][j-1]ÔºàÂ¶ÇÊûú j &gt; 0Ôºâ
diff[i][j] = arr[i][j] - arr[i-1][j]ÔºàÂ¶ÇÊûú i &gt; 0Ôºâ</strong>
ËøôÊ†∑ÔºåÂéüÊï∞ÁªÑ‰∏≠‰ªªÊÑè‰ΩçÁΩÆ (i, j) ÁöÑÂÄºÂèØ‰ª•ÈÄöËøáÁ¥ØÂä†ÂâçÈù¢ÊâÄÊúâÂ∑ÆÂàÜÂÄºÊù•ÊÅ¢Â§çÔºö
<strong>arr[i][j] = diff[i][j] + arr[i][j-1]ÔºàÂ¶ÇÊûú j &gt; 0Ôºâ
arr[i][j] = diff[i][j] + arr[i-1][j]ÔºàÂ¶ÇÊûú i &gt; 0Ôºâ</strong>
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="n">matrix</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">m</span><span class="p">]</span> <span class="p">(</span><span class="err">‰∫åÁª¥Áü©Èòµ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="n">diff</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="p">(</span><span class="err">‰∫åÁª¥Â∑ÆÂàÜÊï∞ÁªÑ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñÂ∑ÆÂàÜÊï∞ÁªÑ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="err">ÂàõÂª∫Â§ßÂ∞è‰∏∫</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="n">x</span> <span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="err">ÁöÑ‰∫åÁª¥Êï∞ÁªÑ</span> <span class="n">diff</span><span class="err">ÔºåÊâÄÊúâÂÖÉÁ¥†ÂàùÂßãÂåñ‰∏∫</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">Âå∫Âüü‰øÆÊîπ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">function</span> <span class="n">update_range</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">diff</span><span class="p">[</span><span class="n">x1</span><span class="p">][</span><span class="n">y1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">val</span>
</span></span><span class="line"><span class="cl">       <span class="n">diff</span><span class="p">[</span><span class="n">x1</span><span class="p">][</span><span class="n">y2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">val</span>
</span></span><span class="line"><span class="cl">       <span class="n">diff</span><span class="p">[</span><span class="n">x2</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">y1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">val</span>
</span></span><span class="line"><span class="cl">       <span class="n">diff</span><span class="p">[</span><span class="n">x2</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">y2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">val</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">ËÆ°ÁÆó‰øÆÊîπÂêéÁöÑÁü©Èòµ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">m</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">           <span class="n">diff</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">diff</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">diff</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">diff</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">           <span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">diff</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="err">Á§∫‰æã</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="err">ÂàùÂßãÁü©Èòµ</span><span class="o">:</span> <span class="na">[[0, 0], [0, 0]]</span>
</span></span><span class="line"><span class="cl">   <span class="err">‰øÆÊîπÂå∫Âüü</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="err">Â¢ûÂä†ÂÄº</span> <span class="mi">2</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="nl">diff</span><span class="p">:</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">              <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">       <span class="err">ÁªìÊûúÁü©Èòµ</span><span class="o">:</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                 <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">diff</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">prefix</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">q</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">       <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">       <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">       <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="c1">//Ëá≥Ê≠§Â∑≤ÁªèÊûÑÂª∫Âá∫‰∫åÁª¥Â∑ÆÂàÜÊï∞ÁªÑ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span><span class="p">(</span><span class="n">q</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x1</span> <span class="o">&gt;&gt;</span> <span class="n">y1</span> <span class="o">&gt;&gt;</span><span class="n">x2</span> <span class="o">&gt;&gt;</span> <span class="n">y2</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span><span class="p">[</span><span class="n">x1</span><span class="p">][</span><span class="n">y1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span><span class="p">[</span><span class="n">x1</span><span class="p">][</span><span class="n">y2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span><span class="p">[</span><span class="n">x2</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">y1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span><span class="p">[</span><span class="n">x2</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">y2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span><span class="p">(</span><span class="n">q</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x1</span> <span class="o">&gt;&gt;</span> <span class="n">y1</span> <span class="o">&gt;&gt;</span> <span class="n">x2</span> <span class="o">&gt;&gt;</span> <span class="n">y2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">area</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">area</span> <span class="o">=</span> <span class="n">prefix</span><span class="p">[</span><span class="n">x2</span><span class="p">][</span><span class="n">y2</span><span class="p">]</span> <span class="o">-</span> <span class="n">prefix</span><span class="p">[</span><span class="n">x2</span><span class="p">][</span><span class="n">y1</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span><span class="n">prefix</span><span class="p">[</span><span class="n">x1</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">y2</span><span class="p">]</span> <span class="o">+</span> <span class="n">prefix</span><span class="p">[</span><span class="n">x1</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">y1</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>egÔºö
<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÂú®‰∏Ä‰∏™Âè´ÂÅöÈÖ±Ë•øÂäüÁà∑ÊûùÂè∂È∏°Ê†ëÂ≠¶Èô¢ÁöÑÂú∞ÊñπÊúâ ( n ) Âè™Â∞èÂä®Áâ©ÔºåË¶Å‰πàÊòØÈº†Èº†ÔºåË¶Å‰πàÊòØÈ∏≠È∏≠Ôºå‰ªé1Âà∞ ( n ) ÁºñÂè∑ÔºåÊØèÂè™Â∞èÂä®Áâ©Êúâ‰∏™‰ΩìÈáç ( a_i )„ÄÇÂú®Ëøô‰∏™Â≠¶Ê†°ÈáåÔºåÂ≠òÂú®‰∏ÄÁßçÁ•ûÂ•áÁöÑÈ≠îÊ≥ïÔºåÂèØ‰ª•Â∞ÜÁºñÂè∑‰Ωç‰∫éÊüê‰∏™Âå∫Èó¥ ([l, r]) ÂÜÖÁöÑÊâÄÊúâÈº†Èº†ÈÉΩÂèò‰∏∫È∏≠È∏≠ÔºåÈ∏≠È∏≠ÈÉΩÂèò‰∏∫Èº†Èº†ÔºàÈ≠îÊ≥ïÂπ∂‰∏ç‰ºöÊîπÂèò‰ΩìÈáçÔºâ„ÄÇÁé∞Âú®‰Ω†ÂèØ‰ª•ÊñΩÊîæËøô‰∏™È≠îÊ≥ïËá≥Â§ö1Ê¨°„ÄÇÔºà‰πüÂèØ‰ª•‰∏çÊñΩÊîæÔºâÈóÆÊúÄÁªàÈ∏≠È∏≠ÁöÑÊÄªÈáçÈáèÊúÄÂ§öÊòØÂ§öÂ∞ëÔºü
<strong>ËæìÂÖ•Ê†ºÂºè</strong>ÔºöÁ¨¨‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞ ( T ) Ë°®Á§∫Ê†∑‰æã‰∏™Êï∞„ÄÇ ( (1 \leq T \leq 10) )ÂØπ‰∫éÊØè‰∏™Ê†∑‰æã:Á¨¨‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞ ( n ) Ë°®Á§∫Â∞èÂä®Áâ©ÁöÑ‰∏™Êï∞„ÄÇ ( \left(1 \leq n \leq 10^5\right) )Á¨¨‰∫åË°å ( n ) ‰∏™Êï¥Êï∞ÔºåË°®Á§∫Á¨¨ ( i ) ‰∏™Â∞èÂä®Áâ©ÁöÑÁ±ªÂûã„ÄÇ 0 Ë°®Á§∫Èº†Èº†Ôºå 1 Ë°®Á§∫È∏≠È∏≠„ÄÇÁ¨¨‰∏âË°å ( n ) ‰∏™Êï¥Êï∞ÔºåË°®Á§∫Á¨¨ ( i ) ‰∏™Â∞èÂä®Áâ©ÁöÑ‰ΩìÈáç ( a_i )„ÄÇ ( \left(1 \leq a_i \leq 10^9\right) )
<strong>ËæìÂá∫Ê†ºÂºè</strong>ÔºöÂØπ‰∫éÊØè‰∏™Ê†∑‰æã‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞Ë°®Á§∫Á≠îÊ°à„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">prefix</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">// ÂàÜÂà´Â≠òÂéüÂä®Áâ©Á±ªÂûã„ÄÅÈáçÈáè„ÄÅÂíåÂâçÁºÄÂíåÊï∞ÁªÑ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefix</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">((</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Áúãa[i] Â¶ÇÊûúÂéüÊù•ÊòØÈº†(0)ÔºåÂèòÂÆåÂ∞±ÊòØÈ∏≠Â≠ê(1)ÔºåÁªìÊûú‰ºöÁõ∏ËæÉ‰∫éÂü∫Á°ÄÁªìÊûúÂä†‰∏äw[i]ÔºõÂèç‰πãÂáèÂ∞ëw[i]„ÄÇ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">ess</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// Âü∫Á°ÄÁªìÊûú
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">ess</span> <span class="o">+=</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">mi</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Fix</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// miË°®Á§∫ min(prefix[j])  0 &lt;= j &lt; i
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Fix</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Fix</span><span class="p">,</span> <span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">mi</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">mi</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ess</span> <span class="o">+</span> <span class="n">Fix</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="2‰ΩçËøêÁÆóÂèåÊåáÈíàÊéíÂ∫è‰∫åÂàÜ">2.‰ΩçËøêÁÆó„ÄÅÂèåÊåáÈíà„ÄÅÊéíÂ∫è‰∫åÂàÜ
</h2><h3 id="‰ΩçËøêÁÆóÈÉΩÂª∫Á´ãÂú®‰∫åËøõÂà∂ÁöÑÂü∫Á°Ä‰∏ä">‰ΩçËøêÁÆóÔºàÈÉΩÂª∫Á´ãÂú®‰∫åËøõÂà∂ÁöÑÂü∫Á°Ä‰∏äÔºâ
</h3><h4 id="‰∏éËøêÁÆó-">‰∏éËøêÁÆó &amp;
</h4><p>a + b = 2(a &amp; b) + (a ^ b)</p>
<h4 id="ÊàñËøêÁÆó-">ÊàñËøêÁÆó |
</h4><h4 id="ÈùûËøêÁÆó-">ÈùûËøêÁÆó !
</h4><h4 id="ÂºÇÊàñËøêÁÆó-">ÂºÇÊàñËøêÁÆó ^
</h4><p>ÂΩì 0 &lt; a, b Êó∂ÔºåÊúâ a + b &gt;= a ^ b
ÁªìÂêàÂæãÔºö a ^ (b ^ c) = (a ^ b) ^ c
‰∫§Êç¢ÂæãÔºö a ^ b = b ^ a
Ê≤°ÊúâÂàÜÈÖçÂæã
a ^ a = 0    a ^ 0 = a</p>
<p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÁªôÂÆö‰∏§‰∏™Ê≠£Êï¥Êï∞ ( a, b )Ôºå‰Ω†ÂèØ‰ª•ÂÜôÂá∫‰∏Ä‰∫õÈùûË¥üÊï¥Êï∞Êï∞ÁªÑÔºå‰ΩøÂæóËØ•Êï∞ÁªÑÁöÑ MEX Âíå XOR ÂÄºÂàÜÂà´‰∏∫ ( a ) Âíå ( b )„ÄÇ‰Ω†ÈúÄË¶ÅÊ±ÇÂá∫Êª°Ë∂≥Êù°‰ª∂ÁöÑÈùûË¥üÊï¥Êï∞Êï∞ÁªÑÁöÑÊúÄÂ∞èÈïøÂ∫¶„ÄÇ
**ÊèêÁ§∫:**MEX ÂÄºÊòØÊåáÔºöÊúÄÂ∞èÁöÑ‰∏çÂ≠òÂú®‰∫éËØ•Êï∞ÁªÑ‰πã‰∏≠ÁöÑÈùûË¥üÊï¥Êï∞„ÄÇ‰æãÂ¶ÇÔºåÊï∞ÁªÑ ( (0,3,2,2) ) ÁöÑ MEX ÂÄº‰∏∫ 1„ÄÇXOR ÂÄºÊòØÊåáÔºöÊï∞ÁªÑ‰∏≠ÁöÑÊâÄÊúâÂÖÉÁ¥†ÂÅöÂºÇÊàñËøêÁÆóÁöÑÁªìÊûú„ÄÇ‰æãÂ¶ÇÔºåÊï∞ÁªÑ ( (3,5,5) ) ÁöÑ XOR ÂÄº‰∏∫ ( 3 \oplus 5 \oplus 5 = 3 )„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>ÔºöÁ¨¨‰∏ÄË°åÔºö‰∏Ä‰∏™Êï¥Êï∞ ( t )ÔºåË°®Á§∫ÊµãËØïÁî®‰æãÁöÑÊï∞Èáè„ÄÇ ( \left(1 \leq t \leq 10^5\right) )  Êé•‰∏ãÊù• ( t ) Ë°åÔºåÊØèË°å‰∏§‰∏™Êï¥Êï∞ ( a, b )„ÄÇ ( \left(1 \leq a \leq 2 \times 10^5, 0 \leq b \leq 2 \times 10^5\right) )
<strong>ËæìÂá∫ÊèèËø∞</strong>ÔºöÂÖ± ( t ) Ë°åÔºöÁ¨¨ ( i ) Ë°å‰∏∫Á¨¨ ( i ) ‰∏™ÊµãËØïÁî®‰æãÁöÑÁ≠îÊ°à„ÄÇ
<strong>Êï¥Êï∞a‰∏ÄÂÆöÂèØ‰ª•Áî±bÂíåcÈÄöËøáÂºÇÊàñÊûÑÈÄ†Âá∫Êù• ÔºàbÔºåc &gt; aÔºâ</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">prexor</span><span class="p">[</span><span class="n">N</span><span class="p">];</span><span class="c1">//ÊûÑÈÄ†ÂºÇÊàñÂâçÁºÄÂíå Èò≤Ê≠¢Êó∂Èó¥Ë∂ÖÈôê
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">;</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">prexor</span><span class="p">[</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">b</span><span class="p">;</span>  <span class="c1">//yÊòØ‰ΩøXOR=bÁöÑÈÇ£‰∏™Áº∫Â∞ëÁöÑÂÄºÔºàÈô§‰∫Ü0~a-1‰πãÂ§ñÔºâ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">a</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;&lt;</span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>    <span class="c1">//Áº∫Â∞ëa ÂàôÈúÄË¶Å‰∏§‰∏™ÊØîaÂ§ßÁöÑÊï∞Â≠óÊù•ÊûÑÈÄ†Âá∫a ÊâÄ‰ª•ÊúÄÂ∞è a+2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>   <span class="c1">//Áº∫Â∞ë0 0Â∑≤ÁªèÂåÖÂê´Âú®0~a-1ÂÜÖ ÊâÄ‰ª•ÊúÄÂ∞èÊï∞Â≠óÈõÜÂêàÂ∞±ÊòØa
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">else</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>         <span class="c1">//ÂÖ∂‰ΩôÊÉÖÂÜµ Âè™Ë¶ÅÂú®0~a-1Âä†‰∏äËøô‰∏™Êï∞Â≠óÂ∞±Ë°å ÊâÄ‰ª• a+1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mf">2e5</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">prexor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prexor</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span> <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="Áßª‰ΩçËøêÁÆó--">Áßª‰ΩçËøêÁÆó &laquo; &raquo;
</h4><p>Â∑¶ÁßªÈ´ò‰ΩçÊ∫¢Âá∫Áõ¥Êé•‰∏¢ÊéâÔºåÂè≥Áßª‰Ωé‰ΩçÊ∫¢Âá∫Áõ¥Êé•‰∏¢Êéâ„ÄÇ
Â∑¶ÁßªÁõ∏ÂΩì‰∫é √ó2
Âè≥ÁßªÁõ∏ÂΩì‰∫é /2
‰∏ÄËà¨‰∏çÂØπË¥üÊï∞Áßª‰ΩçÔºåÁßª‰ΩçÊó∂‰ºöÊääÁ¨¶Âè∑‰Ωç‰πüÁßªÂá∫Âéª„ÄÇ</p>
<h4 id="ÂèñÂèçËøêÁÆó-">ÂèñÂèçËøêÁÆó ~
</h4><p>Êåâ‰ΩçÂèñÂèç</p>
<h3 id="ÂèåÊåáÈíà">ÂèåÊåáÈíà
</h3><p><strong>ÁâπÂæÅÔºö1.‰∏§‰∏™ÊåáÈíàÂú®Âêå‰∏Ä‰∏™ÂÆπÂô®ÂÜÖ
2.‰∏ÄÂø´‰∏ÄÊÖ¢
3.Âè™ÂæÄÂêå‰∏Ä‰∏™ÊñπÂêëËµ∞
4.Âå∫Èó¥ÂÜÖÁª¥Êä§ÊüêÁßçÊù°‰ª∂</strong>
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞(Ê±ÇÂíå‰∏∫ÁõÆÊ†áÂÄºÁöÑÊï∞)</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="n">nums</span><span class="p">[]</span> <span class="p">(</span><span class="err">ÂçáÂ∫èÊï∞ÁªÑ</span><span class="p">),</span> <span class="n">target</span> <span class="p">(</span><span class="err">ÁõÆÊ†áÂÄº</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="n">pairs</span> <span class="p">(</span><span class="err">ÊâÄÊúâÊª°Ë∂≥Êù°‰ª∂ÁöÑÊï∞ÂØπ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">   <span class="n">pairs</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">ÂºÄÂßãÁßªÂä®ÊåáÈíà</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">while</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="nl">right</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">sum</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">+</span> <span class="n">nums</span><span class="p">[</span><span class="n">right</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="n">sum</span> <span class="o">==</span> <span class="nl">target</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">           <span class="n">pairs</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">nums</span><span class="p">[</span><span class="n">left</span><span class="p">],</span> <span class="n">nums</span><span class="p">[</span><span class="n">right</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">           <span class="n">left</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">           <span class="n">right</span> <span class="o">-=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">       <span class="k">else</span> <span class="k">if</span> <span class="n">sum</span> <span class="o">&lt;</span> <span class="nl">target</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">           <span class="n">left</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="err">#</span> <span class="err">ÈúÄË¶ÅÊõ¥Â§ßÁöÑÂÄº</span>
</span></span><span class="line"><span class="cl">       <span class="k">else</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">           <span class="n">right</span> <span class="o">-=</span> <span class="mi">1</span>  <span class="err">#</span> <span class="err">ÈúÄË¶ÅÊõ¥Â∞èÁöÑÂÄº</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">ËøîÂõûÁªìÊûú</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">return</span> <span class="n">pairs</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:
<strong>È¢òÁõÆÊèèËø∞</strong>:Êú¨È¢òÊúâ ( T ) ÁªÑÊµãËØïÊ†∑‰æãÔºåÂØπ‰∫éÊØèÁªÑÊ†∑‰æãÔºöÁªôÂÆö‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ ( n ) ÁöÑÊï∞ÁªÑÔºåÊ±ÇÂÖ∂‰∏≠ÊúÄÈïøÁöÑËøûÁª≠‰∏îÊó†ÈáçÂ§çÊï∞Â≠óÁöÑÂ≠êÂ∫èÂàóÁöÑÈïøÂ∫¶„ÄÇ
<strong>ËæìÂÖ•Ê†ºÂºè</strong>:Á¨¨‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞ ( T )ÔºåË°®Á§∫Ê†∑‰æãÊï∞„ÄÇ ( (1 \leq T \leq 10) ) Á¨¨‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞ ( n )„ÄÇ ( \left(1 \leq n \leq 10^5\right) ) Á¨¨‰∫åË°å ( n ) ‰∏™Êï¥Êï∞ ( a_i )„ÄÇ ( \left(1 \leq a_i \leq 10^5\right) ) Êï∞ÊçÆ‰øùËØÅ ( \sum n \leq 10^5 )„ÄÇ
<strong>ËæìÂá∫Ê†ºÂºè</strong>:‰∏Ä‰∏™Êï¥Êï∞Ë°®Á§∫Á≠îÊ°à„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">// a[N]ÊòØËØªÂÖ•ÁöÑÊï∞ÁªÑ c[N]Áî®Êù•ËÆ∞ÂΩïÊï∞ÁªÑ‰∏≠ÊØè‰∏™Êï∞ÁöÑÂá∫Áé∞Ê¨°Êï∞ÔºåÂÖ∂ÂÆûÊòØÈááÁî®‰∫ÜÊ°∂ÁöÑÊÄùÊÉ≥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">c</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">            <span class="n">c</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="o">++</span><span class="n">j</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span> <span class="c1">// Ëã•ÂΩìÂâçÊï∞Â≠ó a[j+1]Âú®Á™óÂè£ÂÜÖÊ≤°ÊúâÈáçÂ§çÔºàc[a[j+1]] == 0ÔºâÔºåÂè≥Áßª jÔºåÂπ∂Â∞Ü c[a[j+1]] ËÆ°Êï∞Â¢ûÂä†ÔºåË°®Á§∫ËØ•Êï∞Â≠óËøõÂÖ•Á™óÂè£„ÄÇ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">ans</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1ll</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="‰∫åÂàÜ">‰∫åÂàÜ
</h3><p>‰∫åÂàÜÊ≥ïÔºàBinary SearchÔºâÊòØ‰∏ÄÁßçÂú®<strong>ÊúâÂ∫è</strong>Êï∞ÁªÑ‰∏≠Êü•ÊâæÁâπÂÆöÂÖÉÁ¥†ÁöÑÈ´òÊïàÁÆóÊ≥ï„ÄÇÂÆÉÈÄöËøáÂ∞ÜÁõÆÊ†áÂÄº‰∏éÊï∞ÁªÑ‰∏≠Èó¥ÂÖÉÁ¥†ËøõË°åÊØîËæÉÔºå‰ªéËÄåÂ∞ÜÊêúÁ¥¢ËåÉÂõ¥Áº©Â∞è‰∏ÄÂçäÔºåËøô‰ΩøÂæó‰∫åÂàÜÊ≥ïÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶‰∏∫ O(log n)ÔºåÂÖ∂‰∏≠ n ÊòØÊï∞ÁªÑÁöÑÈïøÂ∫¶„ÄÇ‰∫åÂàÜÊ≥ï‰πüÂèØ‰ª•Êâ©Â±ïÂà∞Êü•ÊâæÊúÄÂ∞èÂÄº„ÄÅÊúÄÂ§ßÂÄº„ÄÅÊª°Ë∂≥ÁâπÂÆöÊù°‰ª∂ÁöÑÁ¨¨‰∏Ä‰∏™ÊàñÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†Á≠â„ÄÇ
<strong>‰∫åÂàÜÈáåÈáçË¶ÅÁöÑ‰∏§‰∏™ÂáΩÊï∞</strong>Ôºö
<strong>lower_boundÔºàËµ∑Âßã‰ΩçÁΩÆÔºåÁªìÊùü‰ΩçÁΩÆÔºåÁªôÂÆöÂÄºÔºâ</strong>
lower_bound ÂáΩÊï∞ËøîÂõû‰∏Ä‰∏™Ëø≠‰ª£Âô®ÔºåÊåáÂêëÂÆπÂô®‰∏≠Á¨¨‰∏Ä‰∏™<strong>‰∏çÂ∞è‰∫é</strong>ÁªôÂÆöÂÄºÁöÑÂÖÉÁ¥†„ÄÇÂ¶ÇÊûúÊâÄÊúâÂÖÉÁ¥†ÈÉΩÂ∞è‰∫éÁªôÂÆöÂÄºÔºåÂàôËøîÂõûÊåáÂêëÂÆπÂô®Êú´Â∞æÁöÑËø≠‰ª£Âô®„ÄÇ
<strong>upper_boundÔºàËµ∑Âßã‰ΩçÁΩÆÔºåÁªìÊùü‰ΩçÁΩÆÔºåÁªôÂÆöÂÄºÔºâ</strong>
upper_bound ÂáΩÊï∞ËøîÂõû‰∏Ä‰∏™Ëø≠‰ª£Âô®ÔºåÊåáÂêëÂÆπÂô®‰∏≠Á¨¨‰∏Ä‰∏™<strong>Â§ß‰∫é</strong>ÁªôÂÆöÂÄºÁöÑÂÖÉÁ¥†„ÄÇÂ¶ÇÊûúÊâÄÊúâÂÖÉÁ¥†ÈÉΩ‰∏çÂ§ß‰∫éÁªôÂÆöÂÄºÔºåÂàôËøîÂõûÊåáÂêëÂÆπÂô®Êú´Â∞æÁöÑËø≠‰ª£Âô®„ÄÇ
<strong>‰∫åÂàÜÊÄùË∑ØÔºö</strong>
1.Á°ÆÂÆö‰∫åÂàÜËåÉÂõ¥ÔºåÂç≥lÂíår
2.Âæ™ÁéØÊù°‰ª∂‰∏ÄÂÆöÊòØwhile(l + 1 != r)
3.mid = (l + r) / 2
4.if(check()) l == mid (ÊàñËÄÖ r == mid)
5.else r == mid (ÊàñËÄÖ l == mid)
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="n">nums</span><span class="p">[]</span> <span class="p">(</span><span class="err">ÂçáÂ∫èÊï∞ÁªÑ</span><span class="p">),</span> <span class="n">target</span> <span class="p">(</span><span class="err">Êü•ÊâæÁöÑÁõÆÊ†áÂÄº</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="n">index</span> <span class="p">(</span><span class="err">ÊâæÂà∞ÁöÑÁõÆÊ†áÂÄº‰∏ãÊ†áÔºåËã•‰∏çÂ≠òÂú®ÂàôËøîÂõû</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">ÂºÄÂßãÊü•Êâæ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">while</span> <span class="n">left</span> <span class="o">&lt;=</span> <span class="nl">right</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">mid</span> <span class="o">=</span> <span class="n">left</span> <span class="o">+</span> <span class="p">(</span><span class="n">right</span> <span class="o">-</span> <span class="n">left</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="n">nums</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span> <span class="o">==</span> <span class="nl">target</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">           <span class="k">return</span> <span class="n">mid</span>  <span class="err">#</span> <span class="err">ÊâæÂà∞ÁõÆÊ†áÂÄº</span>
</span></span><span class="line"><span class="cl">       <span class="k">else</span> <span class="k">if</span> <span class="n">nums</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nl">target</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">           <span class="n">left</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>  <span class="err">#</span> <span class="err">ÊéíÈô§Â∑¶ÂçäÈÉ®ÂàÜ</span>
</span></span><span class="line"><span class="cl">       <span class="k">else</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">           <span class="n">right</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">-</span> <span class="mi">1</span>  <span class="err">#</span> <span class="err">ÊéíÈô§Âè≥ÂçäÈÉ®ÂàÜ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">Êú™ÊâæÂà∞</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>‰∫ãÂÆû‰∏ä Ë¶ÅËÆ∞‰Ωè midÂç≥ÊòØ‰Ω†ÊÉ≥Ë¶ÅÁöÑÁ≠îÊ°àÔºåÊâÄÂÅöÁöÑÊØè‰∏ÄÊ≠•Â∞±ÊòØÊäämidÂ§πÈÄºÂà∞È¢òÁõÆÊâÄÈóÆÁöÑ‰ΩçÁΩÆ</strong>
eg:
<strong>‰∫åÂàÜÊü•ÊâæÊ®°Êùø</strong>
<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏Ä‰∏™Â§ßÂ∞è‰∏∫ ( n ) ÁöÑÂçïË∞É‰∏çÂáèÁöÑÈùûË¥üÊï¥Êï∞Â∫èÂàó ( a )Ôºà‰∏ãÊ†á‰ªé 1 ÂºÄÂßãÔºâÔºåÂÜçÁªôÂá∫ ( q ) ‰∏™ËØ¢ÈóÆ„ÄÇÂØπ‰∫éÊØè‰∏™ËØ¢ÈóÆÔºåÁªôÂá∫‰∏Ä‰∏™Êï¥Êï∞ ( x )Ôºå‰Ω†ÈúÄË¶ÅÂõûÁ≠îÂá∫Ôºå( x ) Á¨¨‰∏ÄÊ¨°Âú®ÁªôÂÆöÂ∫èÂàó ( a ) ‰∏≠Âá∫Áé∞ÁöÑ‰∏ãÊ†á„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>:Á¨¨‰∏ÄË°åÔºö‰∏§‰∏™Êï¥Êï∞ ( n, q )„ÄÇ ( \left(1 \leq n, q \leq 2 \times 10^5\right) ) Á¨¨‰∫åË°åÔºö( n ) ‰∏™Êï¥Êï∞ÔºåË°®Á§∫ ( a_1, a_2, \cdots, a_n )„ÄÇ ( \left(0 \leq a_i \leq 10^9, 1 \leq i \leq n\right) ) Á¨¨‰∏âË°åÔºö( q ) ‰∏™Êï¥Êï∞ÔºåË°®Á§∫ËØ¢ÈóÆÁöÑÂÖ∑‰ΩìÊï∞Â≠ó„ÄÇ ( \left(0 \leq x \leq 10^9\right) )
<strong>ËæìÂá∫ÊèèËø∞</strong>:ÂÖ±‰∏ÄË°åÔºå( q ) ‰∏™Êï¥Êï∞ÔºåË°®Á§∫ÊØè‰∏™ËØ¢ÈóÆÊï∞Â≠óÂú®Â∫èÂàó‰∏≠Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰∏ãÊ†áÔºåËã•‰∏çÂ≠òÂú®ÔºåÂàô‰∏∫ -1„ÄÇËØ∑Ê≥®ÊÑèÔºåÊØè‰∏™Êï¥Êï∞Âêé‰∏∫Á©∫Ê†ºÔºåËÄå‰∏çÊòØÊç¢Ë°å„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span> <span class="c1">// Ê≥®ÊÑèËøôÈáåÁöÑÂàùÂßãÂÄºÂ∫îËØ•ÊòØ 1 Âíå nÔºåÂõ†‰∏∫Êï∞ÁªÑÊòØ‰ªé 1 ÂºÄÂßãÁ¥¢ÂºïÁöÑ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">while</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">!=</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">l</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">                <span class="n">r</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">r</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöFarmer JohnÂª∫ÈÄ†‰∫Ü‰∏Ä‰∏™Êúâ ( N )Ôºà( 2 \leq N \leq 10^5 )Ôºâ‰∏™ÈöîÈó¥ÁöÑÁâõÊ£öÔºåËøô‰∫õÈöîÈó¥ÂàÜÂ∏ÉÂú®‰∏ÄÊù°Áõ¥Á∫ø‰∏äÔºåÂùêÊ†áÊòØ ( x_1, x_2, \cdots, x_N )Ôºà( 0 \leq x_i \leq 10^9 )Ôºâ„ÄÇ‰ªñÁöÑ ( C )Ôºà( 2 \leq C \leq N )ÔºâÂ§¥Áâõ‰∏çÊª°‰∫éÈöîÈó¥ÁöÑ‰ΩçÁΩÆÂàÜÂ∏ÉÔºåÂÆÉ‰ª¨‰∏∫ÁâõÊ£öÈáåÂÖ∂‰ªñÁöÑÁâõÁöÑÂ≠òÂú®ËÄåÊÑ§ÊÄí„ÄÇ‰∏∫‰∫ÜÈò≤Ê≠¢Áâõ‰πãÈó¥ÁöÑ‰∫íÁõ∏ÊâìÊñóÔºåFarmer JohnÊÉ≥ÊääËøô‰∫õÁâõÂÆâÁΩÆÂú®ÊåáÂÆöÁöÑÈöîÈó¥ÔºåÊâÄÊúâÁâõ‰∏≠Áõ∏ÈÇª‰∏§Â§¥ÁöÑÊúÄËøëË∑ùÁ¶ªË∂äÂ§ßË∂äÂ•Ω„ÄÇÈÇ£‰πàÔºåËøô‰∏™ÊúÄÂ§ßÁöÑÊúÄËøëË∑ùÁ¶ªÊòØÂ§öÂ∞ëÂë¢Ôºü
<strong>ËæìÂÖ•Ê†ºÂºè</strong>ÔºöÁ¨¨ 1 Ë°åÔºö‰∏§‰∏™Áî®Á©∫Ê†ºÈöîÂºÄÁöÑÊï∞Â≠ó ( N ) Âíå ( C )„ÄÇÁ¨¨ 2 Ëá≥ ( N+1 ) Ë°åÔºöÊØèË°å‰∏Ä‰∏™Êï¥Êï∞ÔºåË°®Á§∫ÊØè‰∏™ÈöîÈó¥ÁöÑÂùêÊ†á„ÄÇ
<strong>ËæìÂá∫Ê†ºÂºè</strong>ÔºöËæìÂá∫Âè™Êúâ‰∏ÄË°åÔºåÂç≥Áõ∏ÈÇª‰∏§Â§¥ÁâõÊúÄÂ§ßÁöÑÊúÄËøëË∑ùÁ¶ª„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">f</span><span class="p">(</span><span class="kt">int</span> <span class="n">mid</span><span class="p">)</span> <span class="c1">// Âú®midÁöÑÊù°‰ª∂‰∏ã ËÉΩÊîæÁöÑÁâõÁöÑÊúÄÂ§ßÊï∞Èáè ÔºàÊîæÁöÑÁâõÊï∞ÈáèË∂äÂ§ßÔºåÁõ∏ÈÇª‰∏§Â§¥ÁöÑÊúÄËøëË∑ùÁ¶ªË∂äÂ∞èÔºâ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">pre</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e9</span><span class="p">;</span> <span class="c1">// resÊòØË¥™ÂøÉÁÆóÊ≥ïÁÆóÂá∫ÁöÑÂèØ‰ª•ÊîæÁΩÆÁâõÁöÑÊúÄÂ§ßÊï∞Èáè preË°®Á§∫‰∏ä‰∏Ä‰∏™Êîæ‰∫ÜÁâõÁöÑÁÇπÁöÑ‰ΩçÁΩÆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">pre</span> <span class="o">&gt;=</span> <span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">pre</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">sort</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="mf">1e9</span> <span class="o">+</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">!=</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">l</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">l</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÊéíÂ∫è">ÊéíÂ∫è
</h3><h4 id="ÊéíÂ∫èÂπ∂ÂéªÈáçÊ®°Êùø">ÊéíÂ∫èÂπ∂ÂéªÈáçÊ®°Êùø
</h4><p><strong>sort(a.begin(),a.end());
a.erase(unique(a.begin(),a.end()),a.end());
sort(a,b)ÊòØ‰∏Ä‰∏™Â∑¶Èó≠Âè≥ÂºÄÁöÑÂå∫Èó¥ ‰ªéÂ∞èÂà∞Â§ßÊéíÂ∫è Ëã•Ë¶Å‰ªéÂ§ßÂà∞Â∞è ÂàôÂÜçreverse(a,b)Âç≥ÂèØ</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">1005</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">x</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">a</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">a</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="n">a</span><span class="p">.</span><span class="n">end</span><span class="p">()));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ÁªìÊûÑ‰ΩìÊéíÂ∫èÊ®°Êùø">ÁªìÊûÑ‰ΩìÊéíÂ∫èÊ®°Êùø
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">A</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//ÂáΩÊï∞ÈáçËΩΩÔºö
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">bool</span> <span class="k">operator</span> <span class="o">&lt;</span> <span class="p">(</span><span class="k">const</span> <span class="n">A</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">)</span> <span class="k">const</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">u</span><span class="p">.</span><span class="n">a</span> <span class="o">&amp;</span> <span class="n">b</span> <span class="o">==</span> <span class="n">u</span><span class="p">.</span><span class="n">b</span><span class="p">)</span> <span class="k">return</span> <span class="n">c</span> <span class="o">&lt;</span><span class="n">u</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">u</span><span class="p">.</span><span class="n">a</span><span class="p">)</span> <span class="k">return</span> <span class="n">b</span> <span class="o">&lt;</span><span class="n">u</span><span class="p">.</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">u</span><span class="p">.</span><span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="n">p</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">sort</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">a</span> <span class="o">&lt;&lt;</span><span class="sc">&#39; &#39;</span><span class="o">&lt;&lt;</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">b</span> <span class="o">&lt;&lt;</span><span class="sc">&#39; &#39;</span><span class="o">&lt;&lt;</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="Ê°∂ÊéíÂ∫èÊ®°Êùø">Ê°∂ÊéíÂ∫èÊ®°Êùø
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">c</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">x</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="mf">2e5</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span><span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="3Ê†à‰ºòÂÖàÈòüÂàómapsetbitset">3.Ê†à„ÄÅ‰ºòÂÖàÈòüÂàó„ÄÅmap„ÄÅset„ÄÅbitset
</h2><h3 id="Ê†à">Ê†à
</h3><p><strong>Ê†àÔºöÂÖàËøõÂêéÂá∫ÁöÑÊï∞ÊçÆÁªìÊûÑÔºà‰∏Ä‰∏™ÊîæÂú®Âú∞‰∏äÁöÑÊ°∂Ôºâ
Áª¥Êä§Ê†àÁöÑÊó∂ÂÄôÂè™Áª¥Êä§Ê†àÈ°∂</strong></p>
<p><strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÁé∞Âú®Êúâ ( n ) ÈÉ®ÁÅ´ËΩ¶ÔºåÊØè‰∏ÄÈÉ®ÁÅ´ËΩ¶ÈÉΩÊúâ‰∏Ä‰∏™1~( n ) ÁöÑÁºñÂè∑‰∏îÂêÑ‰∏çÁõ∏ÂêåÔºàÁÅ´ËΩ¶ÁºñÂè∑ÊûÑÊàê‰∏Ä‰∏™ÊéíÂàóÔºâ„ÄÇÁé∞Âú®‰ªñ‰ª¨ÊåâÁÖßÁªôÂÆöÁöÑÈ°∫Â∫èÊéíÂàóÂú®‰∏ÄÊù°ËΩ®ÈÅì‰∏äÔºåÂè™ËÉΩÊåâÁÖßÁÆ≠Â§¥ÊâÄÊåáÊñπÂêëÁßªÂä®ÔºåÈóÆ‰ªñ‰ª¨ËÉΩÂê¶ÈÄöËøá‰∏Ä‰∏™ËΩ¶Á´ôÔºå‰∏îÊØèÈÉ®ÁÅ´ËΩ¶Ëá≥Â§öËøõÁ´ô‰∏ÄÊ¨°Ôºå‰ΩøÂæóÂá∫Á´ôÂè£ÁöÑÁºñÂè∑È°∫Â∫èÂèò‰∏∫ÂçáÂ∫èÔºàÂç≥Âá∫Á´ôÈ°∫Â∫è‰∏∫ 1, 2, 3,&hellip;ÔºâÔºüÂ¶ÇÊûúÂèØ‰ª•ËæìÂá∫ &ldquo;Yes&rdquo;ÔºåÂ¶ÇÊûú‰∏çË°åËæìÂá∫ &ldquo;No&rdquo;„ÄÇÔºà‰∏çÂ∏¶ÂºïÂè∑Ôºâ
<strong>ËæìÂÖ•Ê†ºÂºè</strong>ÔºöÁ¨¨‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞ ( n )„ÄÇ ( (1 \leq n \leq 10^5) ) Á¨¨‰∫åË°å ( n ) ‰∏™Êï¥Êï∞ ( a_i ) Ë°®Á§∫Âú®ËøõÁ´ôÂè£ÁöÑÁºñÂè∑„ÄÇ ( (1 \leq a_i \leq n, a_i \neq a_j) )
<strong>ËæìÂá∫Ê†ºÂºè</strong>ÔºöÂ¶ÇÊûúÂèØ‰ª•Âèò‰∏∫ÂçáÂ∫èËæìÂá∫ &ldquo;Yes&rdquo;ÔºåÂèç‰πãËæìÂá∫ &ldquo;No&rdquo;„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">pos</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="c1">// Âè≥ËæπÂæÖËøõÁ´ôÂàóËΩ¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">stack</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">stk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">pos</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// Ë°®Á§∫ÂΩìÂâçÊòØÁ¨¨Âá†ËæÜËΩ¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// iË°®Á§∫Â∑¶ËæπËΩ®ÈÅìÊâÄÈúÄÁöÑÂàóËΩ¶ÁºñÂè∑
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Â¶ÇÊûú‰∏çÊòØÊÉ≥Ë¶ÅÁöÑÔºàÁõÆÊ†áÂàóËΩ¶Â≠òÂú®‰∏îËΩ¶Á´ôÊòØÁ©∫ÁöÑÊàñËÄÖÊ†àÈ°∂‰∏çÊòØÁõÆÊ†áÂàóËΩ¶Ôºâ Â∞±‰∏ÄÁõ¥ÊâæÔºàÂè≥‰æßËøõÁ´ôÔºâ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">while</span> <span class="p">(</span><span class="n">pos</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">stk</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">||</span> <span class="n">stk</span><span class="p">.</span><span class="n">top</span><span class="p">()</span> <span class="o">!=</span> <span class="n">i</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">stk</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">pos</span><span class="o">++</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ÊâæÂà∞‰∫ÜÁõÆÊ†áÂàóËΩ¶ ÂàôÂºπÂá∫ÔºàÁõÆÊ†áÂàóËΩ¶ËøõÂÖ•Â∑¶‰æßËΩ®ÈÅìÔºâ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="n">stk</span><span class="p">.</span><span class="n">top</span><span class="p">()</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">stk</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;No&#34;</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Yes&#34;</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="‰ºòÂÖàÈòüÂàóÂ†Üpriority_queue">‰ºòÂÖàÈòüÂàó/Â†Ü(priority_queue)
</h3><p><strong>ÊòØ‰∏ÄÁßç‰∫åÂèâÊ†ëÁä∂ÁªìÊûÑÔºåÂè™ÂØπÂ†ÜÈ°∂(top)ËøõË°åÁª¥Êä§ÔºåÂ†ÜÈ°∂ÂÖÉÁ¥†ÊòØÊúÄÂ§ß/ÊúÄÂ∞èÁöÑÔºàÁî±ÊØîËæÉÂáΩÊï∞ÂÜ≥ÂÆöÔºâÈªòËÆ§ÊòØÂ§ßÊ†πÂ†Ü</strong>
eg:<strong>È¢òÁõÆÊèèËø∞</strong>Ôºö‰Ω†Êúâ‰∏Ä‰∏™ËèúÁØÆÂ≠ê„ÄÇ
Êé•‰∏ãÊù• ( Q ) Ê¨°Êìç‰ΩúÔºåÊØèÊ¨°Êìç‰ΩúÂ¶Ç‰∏ãÔºö</p>
<ul>
<li>&ldquo;1 x&rdquo;ÔºåÂ∞Ü‰∏Ä‰∏™ÈáçÈáè‰∏∫ ( x ) ÁöÑËèúÊîæÂÖ•Âà∞ËèúÁØÆÂ≠ê‰∏≠„ÄÇ</li>
<li>&ldquo;2&rdquo;ÔºåÂ∞ÜËèúÁØÆÂ≠ê‰∏≠ÈáçÈáèÊúÄÂ§ßÁöÑËèú‰∏¢ÊéâÔºàÂ¶ÇÊûúËèúÁØÆÂ≠ê‰∏∫Á©∫ÔºåÂàôË∑≥ËøáÔºâ„ÄÇ</li>
</ul>
<p>ÈóÆ ( Q ) Ê¨°Êìç‰ΩúÂêéÔºåËèúÁØÆÂ≠ê‰∏≠Ââ©‰∏ãÁöÑËèúÁöÑÊÄªÈáçÈáè„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>Ôºö
Á¨¨‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞ ( Q )ÔºåË°®Á§∫Êìç‰ΩúÊ¨°Êï∞„ÄÇ ( \left(1 \leq Q \leq 10^5\right) ) Êé•‰∏ãÊù• ( Q ) Ë°åÔºåÊØèË°å‰∏ÄÊù°Êìç‰Ωú„ÄÇ ( \left(1 \leq x \leq 10^9\right) )
<strong>ËæìÂá∫ÊèèËø∞</strong>:‰∏Ä‰∏™Êï¥Êï∞Ë°®Á§∫Á≠îÊ°à„ÄÇ
<strong>Ê≥®ÊÑèÔºå‰ºòÂÖàÈòüÂàóÈáåÊ≤°ÊúâÂØπ‰∫éÈòüÂàóÈáåÊâÄÊúâÂÖÉÁ¥†Ê±ÇÂíåsumÁöÑÂÜÖÁΩÆÂáΩÊï∞ÔºåÈúÄË¶ÅËá™Â∑±Áª¥Êä§</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">pq</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">op</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">op</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">op</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ll</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">sum</span> <span class="o">+=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">pq</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">sum</span> <span class="o">-=</span> <span class="n">pq</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">pq</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">sum</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Â∞èÊ†πÂ†ÜÊ®°Êùø1</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span><span class="p">,</span><span class="n">greater</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;&gt;</span> <span class="n">pq</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Â∞èÊ†πÂ†ÜÊ®°Êùø2</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">cmp</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">bool</span> <span class="nf">oprator</span><span class="p">()(</span><span class="k">const</span> <span class="n">ll</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span><span class="k">const</span> <span class="n">ll</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">)</span><span class="k">const</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">u</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span><span class="p">,</span><span class="n">cmp</span><span class="o">&gt;</span> <span class="n">pq</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="map">map
</h3><p>map ÊòØ‰∏Ä‰∏™ÂÖ≥ËÅîÂÆπÂô®ÔºåÂÆÉÂ≠òÂÇ®‰∫Ü<strong>ÈîÆÂÄºÂØπÔºàkey-value pairsÔºâ</strong>„ÄÇstd::map ‰∏≠ÁöÑÂÖÉÁ¥†ÊòØÊåâÈîÆÊéíÂ∫èÁöÑÔºåÈÄöÂ∏∏ÊòØ<strong>Ê†πÊçÆÈîÆÁöÑÈ°∫Â∫èËá™Âä®ÊéíÂ∫è</strong>ÁöÑÔºåËøôÊÑèÂë≥ÁùÄÂÆÉÊòØ‰∏Ä‰∏™<strong>ÊúâÂ∫è</strong>ÁöÑÂÆπÂô®„ÄÇstd::map Âü∫‰∫é<strong>Á∫¢ÈªëÊ†ë</strong>ÂÆûÁé∞ÔºåËøôÁ°Æ‰øù‰∫ÜÂç≥‰ΩøÂú®ÊúÄÂùèÊÉÖÂÜµ‰∏ãÔºåÂü∫Êú¨Êìç‰ΩúÔºàÂ¶ÇÊü•Êâæ„ÄÅÊèíÂÖ•ÂíåÂà†Èô§ÔºâÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶‰πüÊòØÂØπÊï∞Á∫ßÁöÑÔºàO(log n)Ôºâ„ÄÇ
<strong>mapÂèØÁî®[]ËøêÁÆóÁ¨¶ÂÉèÊï∞ÁªÑ‰∏ÄÊ†∑Êìç‰Ωú,Âè™‰∏çËøá‰∏ãË°®ÂèòÊàê‰∫ÜÈîÆÂÄºÔºå‰πüÂèØ‰ª•ÂÉèÊôÆÈÄöSTL‰∏ÄÊ†∑Áî®ÂÜÖÁΩÆÂáΩÊï∞Êìç‰Ωú„ÄÇ‰∏ÄËà¨‰∏çÂÅöeraseÂè™ÂÅöinsert‰πãÂêéËøõË°åÊü•ÊâæÂç≥ÈÄöËøákeyÂéªÊâævalue„ÄÇ</strong>
Â∏∏Áî®‰∏ìÈó®ÂáΩÊï∞:
<strong>count(key)</strong> ËøîÂõûkeyÊâÄÂØπÂ∫îÁöÑvalueÁöÑ‰∏™Êï∞Ôºà0/1Ôºâ„ÄÇ
<strong>find(key)</strong> ËøîÂõûkeyÊâÄÂØπÂ∫îÁöÑiterator,Ëã•iterator = end()ÔºåËØ¥ÊòéÊ≤°ÊúâËøô‰∏™key„ÄÇ
eg:<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÁ©∫‰∏≠Êúâ ( n ) ‰∏™Ê∞îÁêÉÔºåÁ¨¨ ( i ) ‰∏™Ê∞îÁêÉÊúâ‰∏Ä‰∏™È¢úËâ≤ ( col_i )ÔºàÁî®‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Ë°®Á§∫Ôºâ„ÄÇËØ∑‰Ω†Ê±ÇÂá∫ÊØèÁßçÊ∞îÁêÉÁöÑ‰∏™Êï∞ÔºåÊåâÁÖßÊ∞îÁêÉÂá∫Áé∞ÁöÑÈ°∫Â∫èËøõË°åÊéíÂ∫èËæìÂá∫„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>ÔºöÁ¨¨‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞ ( T ) Ë°®Á§∫Ê†∑‰æã‰∏™Êï∞„ÄÇ ( (1 \leq T \leq 10) ) ÂØπ‰∫éÊØè‰∏™Ê†∑‰æãÔºåÁ¨¨‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞ ( n ) Ë°®Á§∫Ê∞îÁêÉ‰∏™Êï∞„ÄÇ ( (1 \leq n \leq 100) ) Êé•‰∏ãÊù• ( n ) Ë°åÔºåÊØèË°å‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Ë°®Á§∫ ( col_i )„ÄÇ ( \left(1 \leq |col_i| \leq 50\right) ) Â≠óÁ¨¶‰∏≤‰ªÖÂåÖÂê´Â∞èÂÜôËã±ÊñáÂ≠óÊØç„ÄÇ
<strong>ËæìÂá∫ÊèèËø∞</strong>ÔºöÂØπ‰∫éÊØè‰∏™Ê†∑‰æãÔºåËæìÂá∫ÊâÄÊúâÊ∞îÁêÉÁöÑÁßçÁ±ªÂíå‰∏™Êï∞„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">pos</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">map</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">mp</span><span class="p">;</span> <span class="c1">// mp[s]Ë°®Á§∫sÁöÑÊï∞Èáè
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span>    <span class="c1">// Ë°®Á§∫Â≠óÁ¨¶‰∏≤Âá∫Áé∞ÁöÑÈ°∫Â∫è
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">string</span> <span class="n">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">mp</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">mp</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="n">v</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">mp</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="nl">i</span> <span class="p">:</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span> <span class="o">&lt;&lt;</span> <span class="n">mp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="set">set
</h3><p>setÊòØ‰∏Ä‰∏™Âü∫‰∫éÂπ≥Ë°°‰∫åÂèâÊêúÁ¥¢Ê†ëÔºàÈÄöÂ∏∏ÊòØÁ∫¢ÈªëÊ†ëÔºâÂÆûÁé∞ÁöÑÂÖ≥ËÅîÂÆπÂô®ÔºåÂÆÉÂ≠òÂÇ®ÂîØ‰∏ÄÁöÑÂÖÉÁ¥†ÔºåÂπ∂‰∏îÂÖÉÁ¥†‰ºöÊåâÁÖßÁâπÂÆöÁöÑÈ°∫Â∫è<strong>Ëá™Âä®ÊéíÂ∫è</strong>ÔºàÈªòËÆ§ÂçáÂ∫èÔºâ„ÄÇset‰∏≠ÁöÑ<strong>ÂÖÉÁ¥†ÊòØÂîØ‰∏ÄÁöÑ</strong>ÔºåËøôÊÑèÂë≥ÁùÄ‰∏çÂÖÅËÆ∏ÊúâÈáçÂ§çÁöÑÂÖÉÁ¥†„ÄÇ<strong>ÊèíÂÖ•„ÄÅÂà†Èô§„ÄÅÊü•ÊâæÊïàÁéáÈÉΩÂæàÈ´ò„ÄÇ</strong>
eg:
<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏Ä‰∏™Â§ßÂ∞è‰∏∫ ( n ) ÁöÑÊï¥ÂûãÊï∞ÁªÑ ( a )Ôºå‰Ω†ÈúÄË¶ÅÂØπÂÖ∂ÊåâÁÖßÂçáÂ∫èÊéíÂ∫èÂπ∂ËøõË°åÂéªÈáç„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>:Á¨¨‰∏ÄË°åÔºö‰∏Ä‰∏™Êï¥Êï∞ ( n )„ÄÇ ( (1 \leq n \leq 2 \times 10^5) ) Á¨¨‰∫åË°åÔºö( n ) ‰∏™Êï¥Êï∞ÔºåË°®Á§∫Êï∞ÁªÑ ( a ) ÁöÑÊâÄÊúâÂÖÉÁ¥†„ÄÇ ( \left(-10^9 \leq a_i \leq 10^9, 1 \leq i \leq n\right) )
<strong>ËæìÂá∫ÊèèËø∞</strong>:ÂÖ±‰∏ÄË°åÔºå( n ) ‰∏™Êï¥Êï∞ÔºåË°®Á§∫ËøõË°åÂçáÂ∫èÊéíÂ∫èÂπ∂ËøõË°åÂéªÈáçÂêéÁöÑÊï∞ÁªÑ„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">st</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">st</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="nl">i</span> <span class="p">:</span> <span class="n">st</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="bitset">bitset
</h3><p>bitset ÊòØ‰∏Ä‰∏™<strong>Âõ∫ÂÆöÂ§ßÂ∞è</strong>ÁöÑ‰ΩçÈõÜÂêàÂÆπÂô®ÔºåÂÆÉÊèê‰æõ‰∫Ü‰∏ÄÁßçÈ´òÊïàÁöÑÊñπÂºèÊù•Â≠òÂÇ®ÂíåÊìç‰Ωú‰∫åËøõÂà∂‰Ωç„ÄÇbitset Ê®°ÊùøÁöÑÂèÇÊï∞ÊåáÂÆö‰∫Ü‰ΩçÈõÜÂêà‰∏≠‰ΩçÁöÑÊï∞ÈáèÔºåÂπ∂‰∏îÊâÄÊúâÁöÑ‰ΩçÊúÄÂàùÈÉΩË¢´ËÆæÁΩÆ‰∏∫ 0„ÄÇÂèØ‰ª•ÁêÜËß£‰∏∫‰∏Ä‰∏™ÂæàÈïø‰∫åËøõÂà∂Êï∞ÔºåÂè≥ËæπÊòØ‰Ωé‰ΩçÂ∑¶ËæπÊòØÈ´ò‰ΩçÔºåÊØè‰ΩçÈÉΩÂè™ËÉΩ0/1„ÄÇ<strong>Âè™ÊîØÊåÅ‰ΩçËøêÁÆó‰∏çÊîØÊåÅÁÆóÊúØËøêÁÆó„ÄÇ</strong>
ÂèØ‰ª•ÂΩì‰Ωú‰∏Ä‰∏™bool[]Êù•Áî®„ÄÇ
Â∏∏Áî®ÂáΩÊï∞Ôºö<strong>count()ËøîÂõû1ÁöÑ‰∏™Êï∞</strong>;<strong>reset()ÂêÑ‰ΩçÂÖ®ÈÉ®ÁΩÆÈõ∂</strong>
eg:<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÁªôÂÆö ( n ) ‰∏™Êï¥Êï∞ÔºåÈóÆÁî±Ëøô‰∫õÊï¥Êï∞ÈÄöËøá‚ÄúÂä†Ê≥ï‚ÄùÊìç‰ΩúÔºåÂèØ‰ª•ÁªÑÊàêÂ§öÂ∞ëÁßçÊï∞Â≠óÔºü
<strong>ËæìÂÖ•Ê†ºÂºè</strong>ÔºöÁ¨¨‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞ ( n )„ÄÇ ( \left(1 \leq n \leq 5 \times 10^3\right) ) Á¨¨‰∫åË°å ( n ) ‰∏™Êï¥Êï∞„ÄÇ ( \left(1 \leq a_i \leq 100\right) )
<strong>ËæìÂá∫Ê†ºÂºè</strong>Ôºö‰∏Ä‰∏™Êï¥Êï∞Ë°®Á§∫Á≠îÊ°à„ÄÇ
<strong>ÈúÄË¶ÅÂÄüÂä©dpÔºàÂä®ÊÄÅËßÑÂàíÁöÑÊÄùÊÉ≥Ôºâ</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="mf">5e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">bitset</span><span class="o">&lt;</span><span class="n">M</span><span class="o">&gt;</span> <span class="n">bs</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">bs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">bs</span> <span class="o">|=</span> <span class="p">(</span><span class="n">bs</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ÂÖàÊää‰∏ä‰∏ÄËΩÆÁöÑÂ∑¶Áßªa[i]‰ΩçÔºàÁõ∏ÂΩì‰∫é‰∏ä‰∏ÄËΩÆÁöÑÊØè‰∏™Êï∞ÈÉΩÂä†‰∏äa[i]ÔºâÔºåÂÜç‰∏é‰∏ä‰∏ÄËΩÆÁöÑÁõ∏ÊàñÔºàÁõ∏ÂΩì‰∫éÂ§çÂà∂‰∏ä‰∏ÄËΩÆÁªìÊûúÔºâ„ÄÇ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">bs</span><span class="p">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="4ÂçïË∞ÉÊ†àÂçïË∞ÉÈòüÂàó">4.ÂçïË∞ÉÊ†à„ÄÅÂçïË∞ÉÈòüÂàó
</h2><h3 id="ÂçïË∞ÉÊ†à">ÂçïË∞ÉÊ†à
</h3><p>ÂçïË∞ÉÊ†àÊòØ‰∏ÄÁßç<strong>ÂçïË∞ÉÈÄíÂ¢ûÊàñÂçïË∞ÉÈÄíÂáèÁöÑÊ†à</strong>„ÄÇÂÆÉÂè™ÂÖÅËÆ∏Âú®Ê†àÁöÑÈ°∂ÈÉ®ÊèíÂÖ•ÂíåÂà†Èô§ÂÖÉÁ¥†Ôºå‰ΩÜÊèíÂÖ•ÂíåÂà†Èô§ÁöÑÊìç‰Ωú<strong>ÂèóÂà∞Ê†àÁöÑÂçïË∞ÉÊÄßÈôêÂà∂</strong>„ÄÇ
<strong>‰∏ÄËà¨Áî®ÂçïË∞ÉÊ†à‰∏çÁõ¥Êé•Â≠òÂÖÉÁ¥† ËÄåÊòØÂéªÂ≠òËøô‰∏™ÂÖÉÁ¥†ÁöÑ‰∏ãÊ†á Âõ†‰∏∫Â¶ÇÊûúÁî®ÂÖÉÁ¥†ÊòØÊó†Ê≥ïÂèçÊé®ÂæóÂà∞‰∏ãÊ†áÁöÑ
‰∏îÔºå‰∏ÄËà¨Áî®Êï∞ÁªÑÊù•ÂÆûÁé∞ÂçïË∞ÉÊ†àËÄå‰∏çÊòØstlÈáåÁöÑstack</strong></p>
<p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ ( n ) ÁöÑÊï¥Êï∞Êï∞ÁªÑ ( a )Ôºå‰Ω†ÈúÄË¶ÅÊ±ÇÂá∫ÊØè‰∏™ÂÖÉÁ¥†ÁöÑÂ∑¶ËæπÁ¶ªÂÆÉÊúÄËøë‰∏îÊØîÂÆÉÂ∞èÁöÑÂÖÉÁ¥†„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>:Á¨¨‰∏ÄË°åÔºö‰∏Ä‰∏™Êï¥Êï∞ ( n )„ÄÇ ( \left(1 \leq n \leq 2 \times 10^5\right) ) Á¨¨‰∫åË°åÔºö( n ) ‰∏™Êï¥Êï∞ÔºåË°®Á§∫Êï¥Êï∞Êï∞ÁªÑ ( a )„ÄÇ ( \left(1 \leq a_i \leq 10^9\right) )
<strong>ËæìÂá∫ÊèèËø∞</strong>:ÂÖ±‰∏ÄË°åÔºå( n ) ‰∏™Êï¥Êï∞ÔºåË°®Á§∫ÊØè‰∏™ÂÖÉÁ¥†ÁöÑÂ∑¶ËæπÁ¨¨‰∏Ä‰∏™ÊØîÂÆÉÂ∞èÁöÑÂÖÉÁ¥†ÔºåËã•‰∏çÂ≠òÂú®Âàô‰∏∫ -1„ÄÇ
<strong>ÂçïË∞ÉÊ†àÊ®°ÊùøÈ¢ò 1.Áî®stlÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">// l[N]Â∞±ÊòØÊ±ÇÊØè‰∏™ÂÖÉÁ¥†ÁöÑÂ∑¶ËæπÁ¨¨‰∏Ä‰∏™ÊØîÂÆÉÂ∞èÁöÑÂÖÉÁ¥†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">stack</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">st</span><span class="p">;</span> <span class="c1">// ËøôÈáåÈ¢òÁõÆË¶ÅÊ±ÇÁöÑÂ∞±ÊòØÂÖÉÁ¥†ÂÄº Âõ†Ê≠§‰∏çÁî®‰∏ãÊ†áÔºåÁõ¥Êé•Â≠òvalue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="n">st</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">st</span><span class="p">.</span><span class="n">top</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">st</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// st.size() Áî®‰∫éÁ°Æ‰øùÂú®Ë∞ÉÁî® st.top() ‰πãÂâçÊ†àÊòØÈùûÁ©∫ÁöÑ„ÄÇ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// st.empty() Áî®‰∫éÂú®Âæ™ÁéØÂÜÖÈÉ®Ê£ÄÊü•Ê†àÊòØÂê¶‰∏∫Á©∫ÔºåÂπ∂Ê†πÊçÆÊÉÖÂÜµÊõ¥Êñ∞ l[i] ÁöÑÂÄº„ÄÇ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="n">st</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">            <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="c1">// Ê†à‰∏∫Á©∫
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">top</span><span class="p">();</span> <span class="c1">// Ê†àÈùûÁ©∫
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">st</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÂçïË∞ÉÊ†àÊ®°ÊùøÈ¢ò 2.Áî®Êï∞ÁªÑÂÆûÁé∞ Ê∏ÖÈô§ÊïàÁéáÊõ¥È´òÔºåÂèØ‰ª•lazyclear(ËÑèÊï∞ÊçÆÁïô‰∏ã‰∏çÁî®ÁÆ°‰ªñ Áõ¥Êé•Ê∏ÖÈô§topÂç≥ÂèØ)</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">stk</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">top</span><span class="p">;</span> <span class="c1">// Âú®ÂçïË∞ÉÊ†àstkÈáåÂ≠òÊîæÁöÑÊòØ‰∏ãÊ†á
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="n">top</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">stk</span><span class="p">[</span><span class="n">top</span><span class="p">]]</span> <span class="o">&gt;=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">top</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">top</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">stk</span><span class="p">[</span><span class="n">top</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">stk</span><span class="p">[</span><span class="o">++</span><span class="n">top</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÂçïË∞ÉÈòüÂàó">ÂçïË∞ÉÈòüÂàó
</h3><p>ÂçïË∞ÉÈòüÂàóÊòØ‰∏ÄÁßç<strong>ÂçïË∞ÉÈÄíÂ¢ûÊàñÂçïË∞ÉÈÄíÂáèÁöÑÈòüÂàó</strong>„ÄÇÂÆÉÂÖÅËÆ∏Âú®ÈòüÂàóÁöÑÂâçÁ´ØÂíåÂêéÁ´ØÊèíÂÖ•ÂíåÂà†Èô§ÂÖÉÁ¥†Ôºå‰ΩÜÊèíÂÖ•ÂíåÂà†Èô§ÁöÑÊìç‰Ωú<strong>ÂèóÂà∞ÈòüÂàóÁöÑÂçïË∞ÉÊÄßÈôêÂà∂</strong>„ÄÇ
<strong>ÊôÆÈÄöÁöÑqueueÂè™ËÉΩÂØπÂ§¥ËøõË°åÂºπÂá∫ Âõ†Ê≠§ÊûÑÈÄ†ÂçïË∞ÉÈòüÂàóÊòØ‰∏ÄËà¨Áî®ÂèåÁ´ØÈòüÂàódeque
ÂÖ∂‰∏≠frontÊòØÂ§¥ÔºåbackÊòØÂ∞æ
deque = deque<T>()Êàñwhile(dq.size())dq.pop_back();ÂèØ‰ª•Ê∏ÖÁ©∫</strong>
<strong>ÈòüÂàóÈáåÂ≠òÁöÑ‰πüÊòØ‰∏ãÊ†á ËÄå‰∏çÊòØÂÄº egÔºöx1 x2 x3 x4
ËÄåÊâÄËØ¥ÁöÑÂçïË∞ÉÊòØÊåá f(x)ÂçïË∞ÉÁöÑ Âç≥ f(x1) &gt; f(x2) &gt; f(x3) &gt; f(x4)</strong>
<strong>ÊÄùË∑ØÔºö
1.for()ËøõÂÖ•Âæ™ÁéØ
2.Ê£ÄÊµãÈòüÂ§¥ÂêàÊ≥ïÊÄßÔºöwhile(ÈòüÂàóÈùûÁ©∫‰∏îÂ§¥‰∏çÂêàÊ≥ï)ÂºπÂá∫ÈòüÂ§¥ pop_front
3.Ê£ÄÊµãÈòüÂ∞æ‰ºòË∂äÊÄßÔºöwhile(ÈòüÂàóÈùûÁ©∫‰∏îÂΩìÂâçÁöÑiÁöÑÂÄº‰ºò‰∫éÈòüÂ∞æ) ÂºπÂá∫ÈòüÂ∞æ pop_back
4.push_back(i)
5.ËæìÂá∫ÈòüÂ§¥Âç≥‰∏∫ÊúÄ‰ºò</strong></p>
<p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ $n$ ÁöÑÊï∞ÁªÑ $a$„ÄÇÊúâ‰∏Ä‰∏™Â§ßÂ∞è‰∏∫ $k$ ÁöÑÊªëÂä®Á™óÂè£ÔºàÁ™óÂè£‰∏≠Âè™ËÉΩÁúãÂà∞ $k$ ‰∏™ÂÖÉÁ¥†ÔºâÔºåÂÆÉ‰ªéÊï∞ÁªÑÁöÑÊúÄÂ∑¶ËæπÔºåÊØèÊ¨°ÂêëÂè≥ÁßªÂä®‰∏Ä‰∏™‰ΩçÁΩÆÔºåÁõ¥Âà∞ÁßªÂä®Âà∞ÊúÄÂè≥Ëæπ„ÄÇ‰Ω†ÈúÄË¶ÅÂõûÁ≠îÂá∫ÊªëÂä®Á™óÂè£Âú®ÊØè‰∏™‰ΩçÁΩÆÊó∂ÔºåÁ™óÂè£‰∏≠ÁöÑÊúÄÂ§ßÂÄºÂíåÊúÄÂ∞èÂÄº„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>:Á¨¨‰∏ÄË°åÔºö‰∏§‰∏™Êï¥Êï∞ $n, k$„ÄÇ ($1 \leq k \leq n \leq 2 \times 10^5$)Á¨¨‰∫åË°åÔºö$n$ ‰∏™Êï¥Êï∞Ôºå‰ª£Ë°®Êï∞ÁªÑ $a$„ÄÇ ($-10^6 \leq a_i \leq 10^6, 1 \leq i \leq n$)
<strong>ËæìÂá∫ÊèèËø∞</strong>:Á¨¨‰∏ÄË°åÔºö‰ªéÂ∑¶Âà∞Âè≥ÔºåÊªëÂä®Á™óÂè£Âú®ÊØè‰∏™‰ΩçÁΩÆÁöÑÊúÄÂ§ßÂÄº„ÄÇÁ¨¨‰∫åË°åÔºö‰ªéÂ∑¶Âà∞Âè≥ÔºåÊªëÂä®Á™óÂè£Âú®ÊØè‰∏™‰ΩçÁΩÆÁöÑÊúÄÂ∞èÂÄº„ÄÇ
<strong>ÂçïË∞ÉÈòüÂàó‰ΩúÊªëÂä®Á™óÂè£Ê®°ÊùøÈ¢ò 1.Áî®stlÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">k</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">deque</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">dq</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="c1">// ÊâæÊúÄÂ§ßÂÄº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ‰ª•i‰∏∫Âè≥Á´ØÁÇπ Âå∫Èó¥Â§ßÂ∞è‰∏∫k Âç≥[i-k+1,i]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// 1.ÈòüÂ§¥ÂêàÊ≥ïÊÄßÔºö
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">while</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">dq</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 2.ÈòüÂ∞æ‰ºòË∂äÊÄßÔºö
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">while</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">dq</span><span class="p">.</span><span class="n">back</span><span class="p">()]</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">dq</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">dq</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">dq</span> <span class="o">=</span> <span class="n">deque</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">();</span>           <span class="c1">// Ê∏ÖÁ©∫dq
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="c1">// ÊâæÊúÄÂ∞èÂÄº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ‰ª•i‰∏∫Âè≥Á´ØÁÇπ Âå∫Èó¥Â§ßÂ∞è‰∏∫k Âç≥[i-k+1,i]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">while</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">dq</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">dq</span><span class="p">.</span><span class="n">back</span><span class="p">()]</span> <span class="o">&gt;=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">dq</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">dq</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÂçïË∞ÉÈòüÂàó‰ΩúÊªëÂä®Á™óÂè£Ê®°ÊùøÈ¢ò 2.Áî®Êï∞ÁªÑÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">dq</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">head</span><span class="p">,</span><span class="n">tail</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">;</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">k</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">head</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//Ê±ÇÊúÄÂ§ßÔºö
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span><span class="p">(</span><span class="n">head</span> <span class="o">&lt;=</span> <span class="n">tail</span> <span class="o">&amp;&amp;</span> <span class="n">dq</span><span class="p">[</span><span class="n">head</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span> <span class="n">head</span> <span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span><span class="p">(</span><span class="n">head</span> <span class="o">&lt;=</span> <span class="n">tail</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">dq</span><span class="p">[</span><span class="n">tail</span><span class="p">]]</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">tail</span> <span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">dq</span><span class="p">[</span><span class="o">++</span> <span class="n">tail</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span><span class="n">a</span><span class="p">[</span><span class="n">dq</span><span class="p">[</span><span class="n">head</span><span class="p">]]</span> <span class="o">&lt;&lt;</span><span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">tail</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//Ê±ÇÊúÄÂ∞èÔºö
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span><span class="p">(</span><span class="n">head</span> <span class="o">&lt;=</span> <span class="n">tail</span> <span class="o">&amp;&amp;</span> <span class="n">dq</span><span class="p">[</span><span class="n">head</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span> <span class="n">head</span> <span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span><span class="p">(</span><span class="n">head</span> <span class="o">&lt;=</span> <span class="n">tail</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">dq</span><span class="p">[</span><span class="n">tail</span><span class="p">]]</span> <span class="o">&gt;=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">tail</span> <span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">dq</span><span class="p">[</span><span class="o">++</span> <span class="n">tail</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span><span class="n">a</span><span class="p">[</span><span class="n">dq</span><span class="p">[</span><span class="n">head</span><span class="p">]]</span> <span class="o">&lt;&lt;</span><span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span> <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:ÁªôÂÆö‰∏Ä‰∏™Â§ßÂ∞è‰∏∫nÁöÑÊï¥Êï∞Â∫èÂàóaÔºà‰∏ãÊ†á‰ªé1ÂºÄÂßãÔºâÔºå‰Ω†ÈúÄË¶ÅÊ±ÇÂá∫ËØ•Â∫èÂàóÊâÄÊúâÂ≠êÂå∫Èó¥ÊúÄÂ∞èÂÄºÁöÑÂíåÔºåÂç≥
$$
\sum_{i=1}^{n}\sum_{j=i}^{n}\operatorname{min}\left(a_{i}, a_{i+1},\cdots, a_{j}\right)
$$</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">l</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">r</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="c1">//l[N] : iÂ∑¶ËæπÊúÄËøëÁöÑ&lt;= a[i]ÁöÑ‰ΩçÁΩÆ r[N]ÔºöiÂè≥ËæπÊúÄËøëÁöÑ&lt;a[i]ÁöÑ‰ΩçÁΩÆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">stk</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">top</span><span class="p">;</span> <span class="c1">//Êï∞ÁªÑÊ®°ÊãüÂçïË∞ÉÊ†à
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//ÂÖàÊ±Çl[] &lt; a[i]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span><span class="p">(</span><span class="n">top</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">stk</span><span class="p">[</span><span class="n">top</span><span class="p">]]</span> <span class="o">&gt;=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">top</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//Ê≠§Êó∂Ê†àÈ°∂Â∞±ÊòØl[i]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">top</span><span class="p">)</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">stk</span><span class="p">[</span><span class="n">top</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">stk</span><span class="p">[</span><span class="o">++</span><span class="n">top</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">top</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="o">--</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//‰∏äÈù¢ÊòØ&gt;=ËøôÈáåÂ∞±ÊòØ&lt; Â∑¶Èó≠Âè≥ÂºÄ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">while</span><span class="p">(</span><span class="n">top</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">stk</span><span class="p">[</span><span class="n">top</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">top</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">top</span><span class="p">)</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">stk</span><span class="p">[</span><span class="n">top</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">stk</span><span class="p">[</span><span class="o">++</span><span class="n">top</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">ans</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span><span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span> <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="5Ê†ëÁä∂Êï∞ÁªÑÂíåÁ¶ªÊï£Âåñ">5.Ê†ëÁä∂Êï∞ÁªÑÂíåÁ¶ªÊï£Âåñ
</h2><h3 id="Ê†ëÁä∂Êï∞ÁªÑ">Ê†ëÁä∂Êï∞ÁªÑ
</h3><p>Ê†ëÁä∂Êï∞ÁªÑÔºàBinary Indexed TreeÔºåÁÆÄÁß∞ BIT Êàñ Fenwick TreeÔºâÊòØ‰∏ÄÁßçÊï∞ÊçÆÁªìÊûÑÔºåÁî®‰∫éÈ´òÊïàÂú∞Â§ÑÁêÜÊï∞ÁªÑ‰∏äÁöÑÁ¥ØÁßØÂíåÔºàÂâçÁºÄÂíåÔºâÈóÆÈ¢òÔºåÁâπÂà´ÊòØÂØπ‰∫é<strong>Âå∫Èó¥Ê±ÇÂíå(O(logn))ÂíåÂçïÁÇπÊõ¥Êñ∞(O(1))<strong>Êìç‰Ωú„ÄÇÂÆÉÈÄöËøá</strong>ÊûÑÂª∫‰∏Ä‰∏™ËæÖÂä©Êï∞ÁªÑ</strong>Êù•ÂÆûÁé∞ÂØπÂéüÂßãÊï∞ÁªÑÁöÑÂø´ÈÄüÊü•ËØ¢ÂíåÊõ¥Êñ∞„ÄÇ
Ê†ëÁä∂Êï∞ÁªÑÂπ∂‰∏çÊòØÊ†ëÁªìÊûÑÔºåËÄåÊòØÈÄöËøá‰∏Ä‰∏™<strong>‰∏ÄÁª¥Êï∞ÁªÑ</strong>ÂÆûÁé∞ÁöÑ„ÄÇÂÆÉÂà©Áî®‰∫Ü‰∫åËøõÂà∂Ë°®Á§∫ÁöÑÁâπÊÄßÔºå<strong>Â∞ÜÂéüÂßãÊï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏™ÂÖÉÁ¥†Êò†Â∞ÑÂà∞Ê†ëÁä∂Êï∞ÁªÑ‰∏≠ÁöÑÂ§ö‰∏™‰ΩçÁΩÆ</strong>Ôºå‰ªéËÄåÂÆûÁé∞Âå∫Èó¥ÂíåÁöÑÂø´ÈÄüËÆ°ÁÆó„ÄÇ
<strong>Ê≥®ÊÑèÔºö1.‰∏ÄÂÆö‰∏çËÉΩÁî®0ÂΩì‰∏ãÊ†á
2.ÂºÄÊï∞ÁªÑÁöÑÊó∂ÂÄôÁöÑÂ§ßÂ∞è‰∏éÂéüÊï∞ÁªÑ‰∏ÄÊ†∑</strong>
<strong>lowbit Êìç‰Ωú</strong>ÔºöÂØπ‰∫é‰∏Ä‰∏™Êï¥Êï∞ xÔºålowbit(x) Ë°®Á§∫ x ÁöÑ‰∫åËøõÂà∂Ë°®Á§∫‰∏≠ÊúÄ‰Ωé‰ΩçÁöÑ 1„ÄÇ‰æãÂ¶ÇÔºålowbit(10) = 2ÔºåÂõ†‰∏∫ 10 ÁöÑ‰∫åËøõÂà∂Ë°®Á§∫‰∏∫ 1010ÔºåÊúÄÂè≥ËæπÁöÑ 1 ‰Ωç‰∫éÁ¨¨ 2 ‰ΩçÔºà‰ªé 0 ÂºÄÂßãËÆ°Êï∞Ôºâ
<strong>ÔºÅÔºÅÔºÅÁõ∏ÂΩì‰∫é Ôºàx &amp; -xÔºâÔºÅÔºÅÔºÅ</strong>
<strong>Ê†ëÁä∂Êï∞ÁªÑÁöÑÂéüÁêÜÔºö</strong>
Ê†ëÁä∂Êï∞ÁªÑÁöÑÊ†∏ÂøÉÊÄùÊÉ≥ÊòØÂ∞ÜÂéüÂßãÊï∞ÁªÑÁöÑÊØè‰∏™ÂÖÉÁ¥†Êò†Â∞ÑÂà∞‰∏Ä‰∏™Êñ∞ÁöÑÊï∞ÁªÑÔºàÊ†ëÁä∂Êï∞ÁªÑÔºâ‰∏≠ÁöÑÂ§ö‰∏™‰ΩçÁΩÆÔºå‰ªéËÄåÂÆûÁé∞Âø´ÈÄüÁöÑÂå∫Èó¥Ê±ÇÂíå„ÄÇËøô‰∏™Êò†Â∞ÑÊòØÂü∫‰∫é‰∫åËøõÂà∂Ë°®Á§∫ÁöÑÔºåÁâπÂà´ÊòØÂü∫‰∫é‰∏Ä‰∏™Êï∞ÁöÑ‰∫åËøõÂà∂Ë°®Á§∫‰∏≠ÊúÄ‰Ωé‰ΩçÁöÑ 1ÔºàÂç≥ lowbitÔºâ„ÄÇ
<strong>‰ºòÂäøÔºöÂçïÁÇπ‰øÆÊîπ Âå∫Èó¥Ê±ÇÂíå</strong>
<strong>ÂçïÁÇπ‰øÆÊîπÔºö</strong>
Êõ¥Êñ∞Êìç‰ΩúÊ∂âÂèäÂà∞Â∞Ü‰∏Ä‰∏™ÂÄºÂä†Âà∞ÂéüÂßãÊï∞ÁªÑÁöÑÊüê‰∏™‰ΩçÁΩÆ‰∏äÔºåÁÑ∂ÂêéÊõ¥Êñ∞Ê†ëÁä∂Êï∞ÁªÑ‰∏≠ÊâÄÊúâÂèóÂà∞Ëøô‰∏™Êõ¥Êñ∞ÂΩ±ÂìçÁöÑ‰ΩçÁΩÆ„ÄÇÂÖ∑‰ΩìÊù•ËØ¥Ôºå‰ªé i ÂºÄÂßãÔºåÊØèÊ¨°Â∞Ü<strong>iÂä†‰∏ä lowbit(i)</strong>ÔºåÁõ¥Âà∞ i Ë∂ÖËøáÊï∞ÁªÑÁöÑÂ§ßÂ∞è„ÄÇ
<strong>Âå∫Èó¥Ê±ÇÂíåÔºö</strong>
Êü•ËØ¢Êìç‰ΩúÊ∂âÂèäÂà∞ËÆ°ÁÆóÂéüÂßãÊï∞ÁªÑ‰∏≠‰ªéÁ¥¢Âºï 1 Âà∞ i ÁöÑÊâÄÊúâÂÖÉÁ¥†ÁöÑÁ¥ØÁßØÂíå„ÄÇËøôÂèØ‰ª•ÈÄöËøá<strong>ÈÅçÂéÜÊ†ëÁä∂Êï∞ÁªÑ‰∏≠ÊâÄÊúâ i ÁöÑ lowbit(i)‰ΩçÁΩÆ</strong>Êù•ÂÆûÁé∞ÔºåÂ∞ÜËøô‰∫õ‰ΩçÁΩÆ‰∏äÁöÑÂÄºÁ¥ØÂä†Ëµ∑Êù•„ÄÇ
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="n">n</span> <span class="p">(</span><span class="err">Êï∞ÁªÑÂ§ßÂ∞è</span><span class="p">),</span> <span class="n">arr</span><span class="p">[]</span> <span class="p">(</span><span class="err">ÂàùÂßãÊï∞ÁªÑ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="n">fenwick</span><span class="p">[]</span> <span class="p">(</span><span class="err">Ê†ëÁä∂Êï∞ÁªÑ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">fenwick</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">(</span><span class="err">Â§ßÂ∞è‰∏∫</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="err">ÔºåÂõ†‰∏∫‰ªé</span> <span class="mi">1</span> <span class="err">ÂºÄÂßãÂ≠òÂÇ®</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">ÂçïÁÇπÊõ¥Êñ∞</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">function</span> <span class="n">update</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">while</span> <span class="n">index</span> <span class="o">&lt;=</span> <span class="nl">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">           <span class="n">fenwick</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">+=</span> <span class="n">delta</span>
</span></span><span class="line"><span class="cl">           <span class="n">index</span> <span class="o">+=</span> <span class="n">index</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">-</span><span class="n">index</span><span class="p">)</span>  <span class="err">#</span> <span class="err">ÁßªÂä®Âà∞‰∏ã‰∏Ä‰∏™Áà∂ËäÇÁÇπ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">Êü•ËØ¢ÂâçÁºÄÂíå</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">function</span> <span class="n">query</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">       <span class="k">while</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">           <span class="n">sum</span> <span class="o">+=</span> <span class="n">fenwick</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">           <span class="n">index</span> <span class="o">-=</span> <span class="n">index</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">-</span><span class="n">index</span><span class="p">)</span>  <span class="err">#</span> <span class="err">ÁßªÂä®Âà∞Ââç‰∏Ä‰∏™ËäÇÁÇπ</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">sum</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="err">ÊûÑÂª∫Ê†ëÁä∂Êï∞ÁªÑ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">update</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">5.</span> <span class="err">Êü•ËØ¢‰ªªÊÑèÂå∫Èó¥</span> <span class="p">[</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">]</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">function</span> <span class="n">range_query</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="n">query</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏Ä‰∏™Â§ßÂ∞è‰∏∫ ( n ) ÁöÑÊï∞ÁªÑ ( a ) Âíå ( q ) Ê¨°Êìç‰Ωú„ÄÇÊØèÊ¨°Êìç‰ΩúÂàÜ‰∏∫‰∏ãÈù¢‰∏§ÁßçÔºö</p>
<ul>
<li>&ldquo;1 ( k ) ( v )&quot;ÔºöÁªô ( a_k ) Âä†‰∏ä ( v )„ÄÇ</li>
<li>&ldquo;2 ( l ) ( r )&quot;ÔºöÊü•ËØ¢Âå∫Èó¥ ([l, r]) ÁöÑÂíå„ÄÇ</li>
</ul>
<p>ÂØπ‰∫éÊØèÊ¨°2Êìç‰ΩúÔºåËæìÂá∫ÁªìÊûú„ÄÇ
<strong>ËæìÂÖ•Ê†ºÂºè</strong>:Á¨¨‰∏ÄË°å‰∏§‰∏™Êï¥Êï∞ ( n, q )„ÄÇ ( \left(1 \leq n, q \leq 2 \times 10^5\right) ) Á¨¨‰∫åË°å ( n ) ‰∏™Êï¥Êï∞Ë°®Á§∫Êï∞ÁªÑ ( a )„ÄÇ ( \left(-10^5 \leq a_i \leq 10^5\right) ) Êé•‰∏ãÊù• ( q ) Ë°åÔºåÊØèË°å‰∏Ä‰∏™Êìç‰Ωú„ÄÇ ( (1 \leq l \leq r \leq n, -10^5 \leq v \leq 10^5) )
<strong>ËæìÂá∫Ê†ºÂºè</strong>:ÂØπ‰∫éÊØèÊ¨°2Êìç‰ΩúÔºåÂú®‰∏ÄË°åÂÜÖËæìÂá∫ÁªìÊûú„ÄÇ
<strong>Ê†ëÁä∂Êï∞ÁªÑÂçïÁÇπ‰øÆÊîπÊ®°Êùø</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">// tÊï∞ÁªÑÂç≥Ê†ëÁä∂Êï∞ÁªÑ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">lowbit</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span> <span class="k">return</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">x</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">,</span> <span class="n">ll</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="n">lowbit</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// a_kÂä†Â§öÂ∞ëÔºåÊâÄÊúâË¶ÜÁõñÂà∞a_kÁöÑÊ†ëÁä∂Êï∞ÁªÑ‰πüË¶ÅÂä†Â§öÂ∞ë 
</span></span></span><span class="line"><span class="cl"><span class="c1">// ÈÄöËøáÊØè‰∏Ä‰∏™+lowbitÊâæÂà∞‰∏ã‰∏Ä‰∏™Ë¶ÜÁõña_kÁöÑÊ†ëÁä∂Êï∞ÁªÑ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="nf">getsum</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">-=</span> <span class="n">lowbit</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="n">res</span> <span class="o">+=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="c1">//ÈÄöËøáÊØè‰∏Ä‰∏™-lowbitÊâæÂà∞‰∏éÂΩìÂâçÊ†ëÁä∂Êï∞ÁªÑÊó†ÁºùË°îÊé•ÁöÑ‰∏ä‰∏Ä‰∏™
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="n">update</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">op</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">op</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">op</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ll</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">k</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">update</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ll</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">l</span> <span class="o">&gt;&gt;</span> <span class="n">r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">getsum</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="n">getsum</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>egÔºö<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏Ä‰∏™Â§ßÂ∞è‰∏∫ ( n ) ‰∏™Êï∞ÁªÑ ( a )Ôºå( q ) Ê¨°Êìç‰Ωú„ÄÇÊØèÊ¨°Êìç‰ΩúÂàÜ‰∏∫‰∏ãÈù¢‰∏§ÁßçÔºö</p>
<ul>
<li>&ldquo;1 ( l ) ( r ) ( v )&quot;ÔºöÁªôÂå∫Èó¥ ([l, r]) ‰∏≠ÁöÑÊï∞ÁªÑÂä†‰∏ä ( v )„ÄÇ</li>
<li>&ldquo;2 ( l ) ( r )&quot;ÔºöÊü•ËØ¢Âå∫Èó¥ ([l, r]) ‰∏≠Êï∞Â≠óÁöÑÂíå„ÄÇ</li>
</ul>
<p>ÂØπ‰∫éÊØèÊ¨°2Êìç‰ΩúÔºåËæìÂá∫ÁªìÊûú„ÄÇ
<strong>ËæìÂÖ•Ê†ºÂºè</strong>:Á¨¨‰∏ÄË°å‰∏§‰∏™Êï¥Êï∞ ( n, q )„ÄÇ ( \left(1 \leq n, q \leq 2 \times 10^5\right) ) Á¨¨‰∫åË°å ( n ) ‰∏™Êï¥Êï∞Ë°®Á§∫Êï∞ÁªÑ ( a )„ÄÇ ( \left(-10^5 \leq a_i \leq 10^5\right) ) Êé•‰∏ãÊù• ( q ) Ë°åÔºåÊØèË°å‰∏Ä‰∏™Êìç‰Ωú„ÄÇ ( \left(1 \leq l \leq r \leq n, -10^5 \leq v \leq 10^5\right) )
<strong>ËæìÂá∫Ê†ºÂºè</strong>:ÂØπ‰∫éÊØèÊ¨°2Êìç‰ΩúÔºåÂú®‰∏ÄË°åÂÜÖËæìÂá∫ÁªìÊûú„ÄÇ
<strong>ÊÄùË∑ØÔºö</strong>
Áî®Ê†ëÁä∂Êï∞ÁªÑÊù•Áª¥Êä§Â∑ÆÂàÜd[]„ÄÇ
a[1]=d[1];a[2]=d[1]+d[2];a[3]=d[1]+d[2]+d[3]‚Ä¶‚Ä¶
ËÄå[
\sum_{i=1}^{r} a_i = \sum_{i=1}^{r} (r+1)d_i - \sum_{i=1}^{r} id_i
]
ÂèØ‰ª•ÊääÂéüÊï∞ÁªÑÊãÜÊàê‰∏§‰∏™Êï∞ÁªÑÔºåÂàÜÂà´Âè´ÂÅöt1ÔºàÊù•Ë°®Á§∫ÂºèÂ≠ê‰∏≠ÁöÑdiÁöÑÁ¥ØÂä†Ôºâ,t2ÔºàÊù•Ë°®Á§∫ÂºèÂ≠ê‰∏≠ÁöÑi*diÁöÑÁ¥ØÂä†Ôºâ„ÄÇÊØè‰∏ÄÊ¨°ÁöÑÂå∫Èó¥‰øÆÊîπÔºåÂ∞±ËΩ¨ÂåñÊàê‰∫ÜÂú®t1Âíåt2Ëøô‰∏§‰∏™Êï∞ÁªÑ‰∏äÁöÑÂçïÁÇπ‰øÆÊîπÔºåÂ∞±ÂèØ‰ª•Âåñ‰∏∫Ê®°Âûã1„ÄÇ
<strong>Ê†ëÁä∂Êï∞ÁªÑÂå∫Èó¥‰øÆÊîπÊ®°Êùø</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">td</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">itd</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">lowbit</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">x</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">,</span> <span class="n">ll</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="n">lowbit</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">td</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">x</span><span class="p">,</span> <span class="n">itd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="nf">getsum</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">-=</span> <span class="n">lowbit</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">+=</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">td</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">itd</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span> <span class="c1">// Áî®Â∑ÆÂàÜÊï∞ÁªÑÁöÑÈÄªËæëÊù•ËøõË°åÂå∫Èó¥‰øÆÊîπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">update</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="n">update</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">op</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">op</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">op</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ll</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">l</span> <span class="o">&gt;&gt;</span> <span class="n">r</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">update</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">update</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ll</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">l</span> <span class="o">&gt;&gt;</span> <span class="n">r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">getsum</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="n">getsum</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ ( n ) ÁöÑÊï∞ÁªÑ ( a )ÔºåÊ±Ç ( a ) ÁöÑÈÄÜÂ∫èÂØπ‰∏™Êï∞„ÄÇÈÄÜÂ∫èÂØπÁöÑÂÆö‰πâÊòØ‰∏Ä‰∏™‰∫åÂÖÉÁªÑ ( (a_i, a_j) )ÔºåÊª°Ë∂≥Ôºö( i &lt; j ) ‰∏î ( a_i &gt; a_j )„ÄÇ
<strong>ËæìÂÖ•Ê†ºÂºè</strong>:‰∏Ä‰∏™Êï¥Êï∞ ( n )„ÄÇ ( \left(1 \leq n \leq 2 \times 10^5\right) ) Êé•‰∏ãÊù•‰∏ÄË°å ( n ) ‰∏™Êï¥Êï∞Ë°®Á§∫Êï∞ÁªÑ ( a )„ÄÇ ( \left(1 \leq a_i \leq 10^9\right) )
<strong>ËæìÂá∫Ê†ºÂºè</strong>:‰∏ÄË°åËæìÂá∫‰∏Ä‰∏™ÁªìÊûú„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">;</span> <span class="c1">// Áî®Êù•ÂÅöÁ¶ªÊï£ÂåñÊï∞ÁªÑ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">bin</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="c1">// ÈÄöËøáÂÖÉÁ¥†Êâæ‰∏ãÊ†á
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">lower_bound</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">X</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">X</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">lowbit</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">x</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">X</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span> <span class="o">+=</span> <span class="n">lowbit</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">getsum</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">-=</span> <span class="n">lowbit</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">+=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">X</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">sort</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">X</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">X</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">X</span><span class="p">.</span><span class="n">end</span><span class="p">()),</span> <span class="n">X</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span> <span class="o">+=</span> <span class="n">getsum</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="o">-</span> <span class="n">getsum</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Âõ†‰∏∫Â∑≤ÁªèÊéíÂ∫è ÊâÄ‰ª•ÔºöÊâÄÊúâÁöÑ - Â∞è‰∫éÁ≠â‰∫éa[i]ÁöÑ = ‰∏•Ê†ºÊØîa[i]Â§ßÁöÑ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">update</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="Á¶ªÊï£Âåñ">Á¶ªÊï£Âåñ
</h3><p>Á¶ªÊï£ÂåñÔºàDiscretizationÔºâÊòØ‰∏ÄÁßç<strong>Â§ÑÁêÜËøûÁª≠Êï∞ÊçÆ</strong>ÁöÑÊäÄÊúØÔºåÂÆÉ<strong>Â∞ÜËøûÁª≠ÁöÑÊï∞ÂÄºÊàñÂå∫Èó¥Êò†Â∞ÑÂà∞Á¶ªÊï£ÁöÑÊï¥Êï∞‰∏ä</strong>„ÄÇËøôÁßçÊñπÊ≥ïÂú®ÁÆóÊ≥ïËÆæËÆ°ÂíåÊï∞ÊçÆÂàÜÊûê‰∏≠ÈùûÂ∏∏ÊúâÁî®ÔºåÂ∞§ÂÖ∂ÊòØÂú®Â§ÑÁêÜ<strong>Âå∫Èó¥ÈóÆÈ¢ò„ÄÅËåÉÂõ¥Êü•ËØ¢„ÄÅÂá†‰ΩïÈóÆÈ¢òÂíå‰ºòÂåñÈóÆÈ¢ò</strong>Êó∂„ÄÇÁ¶ªÊï£ÂåñÁöÑÁõÆÁöÑÊòØÁÆÄÂåñÈóÆÈ¢òÔºå‰ΩøÂÖ∂ËÉΩÂ§üÂú®Êï¥Êï∞‰∏äÈ´òÊïàÂú∞Â§ÑÁêÜ„ÄÇ
<strong>ÊÄùË∑ØÔºö
1.ÊâæÂá∫ÊâÄÊúâ‰∏éÁªìÊûúÊúâÂÖ≥ÁöÑÁõ∏ÂÖ≥ÁÇπ Áî®Á¶ªÊï£ÂåñÊï∞ÁªÑÂ≠ò‰∏ãÊù•
2.Â∞ÜÁõ∏ÂÖ≥ÁÇπÊéíÂ∫èÂπ∂ÂéªÈáçÔºàÊ®°ÊùøÔºâ
3.ÊääÂéüÊï∞ÁªÑÊò†Â∞ÑËá≥Á¶ªÊï£ÂåñÊï∞ÁªÑ‰∏ä Á¶ªÊï£ÂåñÊï∞ÁªÑ‰πüË¶ÅËÉΩÊò†Â∞ÑËá≥ÂéüÊï∞ÁªÑ‰∏≠ÔºàÊâæ‰∏ãÊ†áÔºâ
4.ÊääÂéüÊú¨Âú®ÂéüÊï∞ÁªÑ‰∏äÁöÑÊìç‰ΩúÊîπÂà∞Á¶ªÊï£ÂåñÊï∞ÁªÑ‰∏≠Êù•ÂÅöÔºåÂÆûÁé∞Êï∞ÊçÆÈáèÈôçÁª¥</strong>
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="n">nums</span><span class="p">[]</span> <span class="p">(</span><span class="err">ÈúÄË¶ÅÁ¶ªÊï£ÂåñÁöÑÊï∞ÁªÑ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="n">discrete_map</span> <span class="p">(</span><span class="err">ÂéüÂÄºÂà∞Á¶ªÊï£ÂÄºÁöÑÊò†Â∞Ñ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂéªÈáçÂπ∂ÊéíÂ∫è</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">sorted_nums</span> <span class="o">=</span> <span class="n">sort</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">nums</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">ÊûÑÂª∫Êò†Â∞Ñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">discrete_map</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">len</span><span class="p">(</span><span class="n">sorted_nums</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">discrete_map</span><span class="p">[</span><span class="n">sorted_nums</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">ËΩ¨Êç¢Êï∞ÁªÑ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">discrete_map</span><span class="p">[</span><span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="err">ËøîÂõûÁªìÊûú</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">return</span> <span class="n">nums</span><span class="p">,</span> <span class="n">discrete_map</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>:Â∞èeÊúâ‰∏Ä‰∏™ÂæàÈïøÂæàÈïøÁöÑÊï∞ÁªÑÔºåÊï∞ÁªÑÁöÑ‰∏ãÊ†áËåÉÂõ¥‰∏∫ (\left[0,10^9\right])ÔºåÂàùÂßãÊó∂ÊØè‰∏™ÂÖÉÁ¥†Âùá‰∏∫0„ÄÇÁé∞Âú®Ôºå‰ªñÊÉ≥ËøõË°å ( n ) Ê¨°Êìç‰ΩúÔºåÊØèÊ¨°Êìç‰ΩúÂ∞ÜÊüê‰∏™‰∏ãÊ†á ( i ) Â§ÑÁöÑÂÖÉÁ¥†Âä†‰∏ä ( x )„ÄÇÁÑ∂Âêé‰ªñÁªôÂá∫‰∫Ü ( q ) Ê¨°ËØ¢ÈóÆÔºåÊØè‰∏™ËØ¢ÈóÆÊ†ºÂºè‰∏∫ ( l, r )Ôºå‰Ω†ÈúÄË¶ÅÂõûÁ≠îÂá∫‰∏ãÊ†áÂú®Âå∫Èó¥ ([l, r]) ÂÜÖÁöÑÊâÄÊúâÂÖÉÁ¥†ÁöÑÂíå„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>:Á¨¨‰∏ÄË°åÔºö‰∏§‰∏™Êï¥Êï∞ ( n, q )„ÄÇ ( (1 \leq n, q \leq 10^5) ) Êé•‰∏ãÊù• ( n ) Ë°åÔºöÊØèË°å‰∏§‰∏™Êï¥Êï∞ ( i, x )„ÄÇ ( \left(0 \leq i \leq 10^9, 0 \leq x \leq 10^4\right) ) ÂÜçÊé•‰∏ãÊù• ( q ) Ë°åÔºöÊØèË°å‰∏§‰∏™Êï¥Êï∞ ( l, r )„ÄÇ ( \left(0 \leq l \leq r \leq 10^9\right) )
<strong>ËæìÂá∫ÊèèËø∞</strong>:ÂÖ± ( q ) Ë°åÔºåÊØèË°åËæìÂá∫Áõ∏Â∫îËØ¢ÈóÆÁöÑÁ≠îÊ°à„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">3e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>       <span class="c1">// Â≠òÁ¶ªÊï£ÂåñÊï∞ÁªÑÂØπÂ∫îÁöÑÊï∞ÁªÑ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">;</span> <span class="c1">// Á¶ªÊï£ÂåñÊï∞ÁªÑÔºàÂ≠òÁöÑÊòØ‰∏ãÊ†áÔºâ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">struct</span> <span class="nc">Q</span>       <span class="c1">// ÂàõÂª∫ÁªìÊûÑ‰ΩìÂ≠òÊîæÊìç‰ΩúÂíåËØ¢ÈóÆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">op</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">query</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">getidx</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">)</span> <span class="c1">// Êâæ‰∏ãÊ†á
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// lower_boundÔºöÊâæÂá∫Êï∞ÁªÑ‰∏≠Á¨¨‰∏Ä‰∏™ &gt;= x ÁöÑËø≠‰ª£Âô®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="n">lower_bound</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">X</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">X</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ËøîÂõûÂÄºÁöÑËåÉÂõ¥ÊòØ[1,X.size()]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ll</span> <span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="n">w</span><span class="p">;</span>  <span class="c1">// xÊòØÈ¢ò‰∏≠‰∏ãÊ†áiÔºåwÊòØÂÖÉÁ¥†Âä†ÁöÑÈÇ£‰∏™x
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">X</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="c1">// ËÆ∞ÂΩïÊâÄÊúâÁî®ÂæóÂà∞ÁöÑ‰∏ãÊ†á
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">op</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">q</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ll</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">l</span> <span class="o">&gt;&gt;</span> <span class="n">r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">X</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">X</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">query</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ÊéíÂ∫èÂéªÈáç
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">sort</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">X</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">X</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">X</span><span class="p">.</span><span class="n">end</span><span class="p">()),</span> <span class="n">X</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">getidx</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">ll</span> <span class="n">w</span> <span class="o">=</span> <span class="n">op</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">X</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span> <span class="c1">// Êõ¥Êñ∞a[i]Áõ¥Êé•‰ΩúÂâçÁºÄÂíå
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">q</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="n">getidx</span><span class="p">(</span><span class="n">query</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">getidx</span><span class="p">(</span><span class="n">query</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="6ÂõæÁöÑÂ≠òÂÇ®dfsbfs">6.ÂõæÁöÑÂ≠òÂÇ®„ÄÅDFS„ÄÅBFS
</h2><h3 id="ÂõæÁöÑÂ≠òÂÇ®">ÂõæÁöÑÂ≠òÂÇ®
</h3><h4 id="ÈÇªÊé•Áü©Èòµ">ÈÇªÊé•Áü©Èòµ
</h4><p>ÈÇªÊé•Áü©ÈòµÊòØ‰∏ÄÁßçÁî®‰∫éË°®Á§∫ÂõæÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÂÆÉ‰ΩøÁî®‰∏Ä‰∏™<strong>‰∫åÁª¥Êï∞ÁªÑ</strong>Êù•Â≠òÂÇ®Âõæ‰∏≠È°∂ÁÇπ‰πãÈó¥ÁöÑËøûÊé•ÂÖ≥Á≥ª„ÄÇÂú®ÈÇªÊé•Áü©Èòµ‰∏≠Ôºå<strong>Ë°åÂíåÂàóÂàÜÂà´‰ª£Ë°®Âõæ‰∏≠ÁöÑÈ°∂ÁÇπÔºåËÄåÁü©Èòµ‰∏≠ÁöÑÂÖÉÁ¥†Ë°®Á§∫È°∂ÁÇπ‰πãÈó¥ÁöÑËæπ„ÄÇ</strong>
Ë°®Á§∫Êó†ÂêëÂõæÂíåÊúâÂêëÂõæÔºöÈÇªÊé•Áü©ÈòµÂèØ‰ª•Ë°®Á§∫<strong>Êó†ÂêëÂõæÂíåÊúâÂêëÂõæ</strong>„ÄÇÂØπ‰∫éÊó†ÂêëÂõæÔºåÈÇªÊé•Áü©ÈòµÊòØ<strong>ÂØπÁß∞</strong>ÁöÑÔºõÂØπ‰∫éÊúâÂêëÂõæÔºåÂ¶ÇÊûúÂ≠òÂú®‰ªéÈ°∂ÁÇπ i Âà∞È°∂ÁÇπ j ÁöÑËæπÔºåÂàô matrix[i][j] ÂåÖÂê´ËæπÁöÑÊùÉÈáçÊàñÂ≠òÂú®ÊÄßÔºåËÄå matrix[j][i] ÈÄöÂ∏∏‰∏∫ 0 Êàñ‰∏çÂåÖÂê´Ëæπ„ÄÇ
<strong>‰∏ÄËà¨Áî®ÁöÑÊØîËæÉÂ∞ë</strong></p>
<h3 id="Ê∑±Â∫¶‰ºòÂÖàÊêúÁ¥¢dfs">Ê∑±Â∫¶‰ºòÂÖàÊêúÁ¥¢ÔºàDFSÔºâ
</h3><p>ÁâπÁÇπÔºö‰∏ÄÊù°Ë∑ØËµ∞Âà∞Èªë
DFS ‰ªéËµ∑ÂßãËäÇÁÇπÂºÄÂßãÔºå<strong>Ê≤øÁùÄÂõæÁöÑËæπÂ∞ΩÂèØËÉΩÊ∑±Âú∞Êé¢Á¥¢ÔºåÁõ¥Âà∞Âà∞Ëææ‰∏Ä‰∏™Ê≤°ÊúâÊú™ËÆøÈóÆÈÇªÂ±ÖÁöÑËäÇÁÇπÔºåÁÑ∂ÂêéÂõûÊ∫ØÂà∞‰∏ä‰∏Ä‰∏™ËäÇÁÇπÔºåÁªßÁª≠Êé¢Á¥¢ÂÖ∂‰ªñÂàÜÊîØ</strong>„ÄÇDFS ‰ΩøÁî®Ê†àÔºàÂèØ‰ª•ÊòØÊòæÂºèÁöÑÊ†àÊàñÈÄíÂΩíË∞ÉÁî®ÁöÑÈöêÂºèÊ†àÔºâÊù•ÁÆ°ÁêÜÂ∑≤ÁªèËÆøÈóÆ‰ΩÜÂ∞öÊú™Êé¢Á¥¢ÂÆåÁöÑËäÇÁÇπ„ÄÇDFS ÊòØ<strong>ÈÄíÂΩí</strong>ÂÆûÁé∞ÁöÑÔºåÂèØ‰ª•ÂæàÂÆπÊòìÂú∞Â§ÑÁêÜÂõæ‰∏≠ÁöÑÈÄíÂΩíÁªìÊûÑ„ÄÇ
<strong>Ê≥®ÊÑè Â¶ÇÊûúÂèØËÉΩÂá∫Áé∞ÁéØÁöÑËØù ÈúÄË¶ÅÂ§öÂºÄ‰∏Ä‰∏™Â∏ÉÂ∞îÊàñbitset vis[i]Êï∞ÁªÑ Ë°®Á§∫ÊòØÂê¶Â∑≤ÁªèËµ∞Ëøái‰∫Ü„ÄÇÂΩìÊâÄÊü•ÊâæÁöÑÁÇπvis[i]=tureÔºåÂàôË∑≥Âá∫ÈÄíÂΩíÔºåÊé•ÁùÄÊâæÂÖ∂‰ªñÁöÑÂ≠êËäÇÁÇπ„ÄÇ</strong>
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="n">n</span> <span class="p">(</span><span class="err">ÁÇπÊï∞</span><span class="p">),</span> <span class="n">edges</span><span class="p">[]</span> <span class="p">(</span><span class="err">ËæπË°®</span><span class="p">),</span> <span class="n">start</span> <span class="p">(</span><span class="err">Ëµ∑ÁÇπ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="n">visited</span><span class="p">[]</span> <span class="p">(</span><span class="err">Ê†áËÆ∞ÊòØÂê¶ËÆøÈóÆËøá</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">visited</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span> <span class="p">(</span><span class="err">ÊâÄÊúâÁÇπÊú™ËÆøÈóÆ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">graph</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span> <span class="p">(</span><span class="err">‰ΩøÁî®ÈÇªÊé•Ë°®Ë°®Á§∫Âõæ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">ÊûÑÂª∫Âõæ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">each</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="n">in</span> <span class="nl">edges</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="p">(</span><span class="err">Êó†ÂêëÂõæÈúÄÂä†</span> <span class="n">graph</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="n">DFS</span> <span class="err">ÂáΩÊï∞</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">function</span> <span class="n">dfs</span><span class="p">(</span><span class="n">node</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">visited</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">       <span class="k">for</span> <span class="n">neighbor</span> <span class="n">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">           <span class="k">if</span> <span class="n">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">               <span class="n">dfs</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="err">ÈÅçÂéÜÊâÄÊúâÁÇπ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="n">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">           <span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:
<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏Ä‰∏™ $n$ ‰∏™ÁÇπ $m$ Êù°ËæπÁöÑÊúâÂêëÂõæÔºåÂõæ‰∏≠ÂèØËÉΩÂ≠òÂú®ÈáçËæπÂíåËá™ÁéØÔºåÁÇπÁöÑÁºñÂè∑‰∏∫ $1\sim n$„ÄÇ
‰Ω†ÈúÄË¶ÅÊ±ÇÂá∫‰ªéÁÇπ1Âá∫ÂèëÔºåËÉΩÂ§üÂà∞ËææÁöÑÊâÄÊúâÁÇπ„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>:Á¨¨‰∏ÄË°åÔºö‰∏§‰∏™Êï¥Êï∞ $n, m$ÔºåÂàÜÂà´Ë°®Á§∫ÊúâÂêëÂõæÁöÑÁÇπÊï∞„ÄÅËæπÊï∞„ÄÇ($1 \leq n, m \leq 10^5$)
Êé•‰∏ãÊù• $m$ Ë°åÔºöÊØèË°å‰∏§‰∏™Êï¥Êï∞ $u_i, v_i$ÔºåË°®Á§∫Â≠òÂú®‰∏ÄÊù°‰ªé $u_i$ Âà∞ $v_i$ ÁöÑÊúâÂêëËæπ„ÄÇ ($1 \leq u_i, v_i \leq n$)
<strong>ËæìÂá∫ÊèèËø∞</strong>:ÂÖ±‰∏ÄË°åÔºå‰ªéÂ∞èÂà∞Â§ßËæìÂá∫1Âè∑ÁÇπËÉΩÂ§üÂà∞ËææÁöÑÁÇπÁöÑÁºñÂè∑„ÄÇ
<strong>dfsÊ®°Êùø</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">bitset</span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">vis</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span><span class="p">;</span> <span class="c1">// Ëã•Ëµ∞ËøáÂàôË∑≥Ëøá
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">vis</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="nl">y</span> <span class="p">:</span> <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">dfs</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">m</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">!=</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span> <span class="c1">// Ëã•‰∏çÊòØ‰∏Ä‰∏™ÁÇπÔºåÂàôÊîæÂÖ•ÈÇªÊé•Ë°®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ÂÖ®ÊéíÂàó">ÂÖ®ÊéíÂàó
</h4><p>ÂÖ®ÊéíÂàóÊòØÊåá‰ªéÁªôÂÆöÁöÑ‰∏ÄÁªÑÂÖÉÁ¥†‰∏≠ÔºåÁîüÊàê<strong>ÊâÄÊúâÂèØËÉΩÁöÑÊéíÂàóÁªÑÂêà</strong>„ÄÇÂØπ‰∫é‰∏Ä‰∏™ÂåÖÂê´ n ‰∏™‰∏çÂêåÂÖÉÁ¥†ÁöÑÈõÜÂêàÔºåÂÆÉÁöÑ<strong>ÂÖ®ÊéíÂàóÊï∞ÈáèÊòØ n ÁöÑÈò∂‰πòÔºàn!Ôºâ</strong>ÔºåÂç≥ 1 Âà∞ n ÊâÄÊúâÊ≠£Êï¥Êï∞ÁöÑ‰πòÁßØ„ÄÇ
eg:<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏Ä‰∏™Êï∞Â≠ó $n$ÔºåËØ∑ÊåâÁÖßÂ≠óÂÖ∏Â∫èËæìÂá∫ÊéíÂàó $[1,2,\ldots,n]$ ÁöÑÂÖ®ÊéíÂàó„ÄÇ
<strong>ËæìÂÖ•Ê†ºÂºè</strong>:‰∏Ä‰∏™Êï¥Êï∞ $n$„ÄÇ ($1 \leq n \leq 10$)
<strong>ËæìÂá∫Ê†ºÂºè</strong>    :‰∏ÄË°åËæìÂá∫‰∏Ä‰∏™ÁªìÊûúÔºåÊåâÁÖßÂ≠óÂÖ∏Â∫è‰ªéÂ∞èÂà∞Â§ßÊéíÂàó„ÄÇ
<strong>Áî®dfsÂÆûÁé∞ÂÖ®ÊéíÂàó</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">19</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">bitset</span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">vis</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">dep</span><span class="p">)</span> <span class="c1">// depË°®Á§∫Ê≠§Êó∂ÊâÄÂ§ÑÁöÑÊ∑±Â∫¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">dep</span> <span class="o">==</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">// ËØ¥ÊòéÂ∑≤ÁªèËµ∞Âà∞Âè∂Â≠êËäÇÁÇπÊúÄ‰∏ãÈù¢‰∫Ü ÈúÄËæìÂá∫
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&#34; </span><span class="se">\n</span><span class="s">&#34;</span><span class="p">[</span><span class="n">i</span> <span class="o">==</span> <span class="n">n</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span><span class="p">[</span><span class="n">dep</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">dfs</span><span class="p">(</span><span class="n">dep</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Âéª‰∏ã‰∏ÄÂ±Ç
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// Âá∫Êù•‰πãÂêéÊÅ¢Â§çÁé∞Âú∫Ôºö
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">a</span><span class="p">[</span><span class="n">dep</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÂÖ®ÊéíÂàóÂáΩÊï∞Ê®°Êùø ÊåâÂ≠óÂÖ∏Â∫è‰ªéÂ∞èÂà∞Â§ß</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">19</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">bool</span> <span class="n">go</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">go</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">go</span> <span class="o">=</span> <span class="n">next_permutation</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÂÖ®ÊéíÂàóÂáΩÊï∞Ê®°Êùø ÊåâÂ≠óÂÖ∏Â∫è‰ªéÂ∞èÂà∞Â§ß</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">19</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">bool</span> <span class="n">go</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">go</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">go</span> <span class="o">=</span> <span class="n">prev_permutation</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÂπøÂ∫¶‰ºòÂÖàÊêúÁ¥¢bfs">ÂπøÂ∫¶‰ºòÂÖàÊêúÁ¥¢ÔºàBFSÔºâ
</h3><p>ÁâπÁÇπ:ÂÉèÊ¥ãËë±‰∏ÄÊ†∑‰∏ÄÂ±Ç‰∏ÄÂ±ÇÊã®ÂºÄ‰Ω†ÁöÑÂøÉ
BFS ‰ªéËµ∑ÂßãËäÇÁÇπÂºÄÂßãÔºåÈ¶ñÂÖà<strong>Êé¢Á¥¢ÊâÄÊúâÈÇªÊé•ÁöÑËäÇÁÇπÔºåÁÑ∂ÂêéÂØπÊØè‰∏™ÈÇªÊé•ËäÇÁÇπÁöÑÊú™ËÆøÈóÆÈÇªÊé•ËäÇÁÇπËøõË°åÊé¢Á¥¢</strong>Ôºå‰ª•Ê≠§Á±ªÊé®„ÄÇBFS ‰ΩøÁî®<strong>ÈòüÂàóÊù•ÁÆ°ÁêÜÂæÖËÆøÈóÆÁöÑËäÇÁÇπ</strong>„ÄÇBFS ‰øùËØÅÊâæÂà∞ÁöÑÊòØ<strong>‰ªéËµ∑ÁÇπÂà∞ÁõÆÊ†áËäÇÁÇπÁöÑÊúÄÁü≠Ë∑ØÂæÑ</strong>ÔºàÂ¶ÇÊûúÊâÄÊúâËæπÁöÑÊùÉÈáçÁõ∏ÂêåÔºâ„ÄÇ
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="n">n</span> <span class="p">(</span><span class="err">ÁÇπÊï∞</span><span class="p">),</span> <span class="n">edges</span><span class="p">[]</span> <span class="p">(</span><span class="err">ËæπË°®</span><span class="p">),</span> <span class="n">start</span> <span class="p">(</span><span class="err">Ëµ∑ÁÇπ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="n">dist</span><span class="p">[]</span> <span class="p">(</span><span class="err">Ëµ∑ÁÇπÂà∞ÂÖ∂‰ªñÁÇπÁöÑÊúÄÁü≠Ë∑ùÁ¶ª</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">visited</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span> <span class="p">(</span><span class="err">ÊâÄÊúâÁÇπÊú™ËÆøÈóÆ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">graph</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span> <span class="p">(</span><span class="err">‰ΩøÁî®ÈÇªÊé•Ë°®Ë°®Á§∫Âõæ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="p">(</span><span class="err">ÊâÄÊúâÁÇπÂàùÂßãË∑ùÁ¶ª‰∏∫</span> <span class="o">-</span><span class="mi">1</span><span class="err">ÔºåË°®Á§∫‰∏çÂèØËææ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">queue</span> <span class="o">=</span> <span class="p">[]</span> <span class="p">(</span><span class="err">Á©∫ÈòüÂàó</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">ÊûÑÂª∫Âõæ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">each</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="n">in</span> <span class="nl">edges</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="p">(</span><span class="err">Êó†ÂêëÂõæÈúÄÂä†</span> <span class="n">graph</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="n">BFS</span> <span class="err">ÂáΩÊï∞</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">function</span> <span class="n">bfs</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">queue</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="n">visited</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">       <span class="n">dist</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">       <span class="k">while</span> <span class="n">queue</span> <span class="n">is</span> <span class="n">not</span> <span class="nl">empty</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">           <span class="n">current</span> <span class="o">=</span> <span class="n">queue</span><span class="p">.</span><span class="n">pop_front</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">           <span class="k">for</span> <span class="n">neighbor</span> <span class="n">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">current</span><span class="p">]</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">               <span class="k">if</span> <span class="n">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">visited</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">                   <span class="n">dist</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">current</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                   <span class="n">queue</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="err">Ë∞ÉÁî®</span> <span class="nl">BFS</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">bfs</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏Ä‰∏™ $n$ ‰∏™ÁÇπ $m$ Êù°ËæπÁöÑÊúâÂêëÂõæÔºåÂõæ‰∏≠ÂèØËÉΩÂ≠òÂú®ÈáçËæπÂíåËá™ÁéØÔºåÁÇπÁöÑÁºñÂè∑‰∏∫ $1\sim n$„ÄÇ
‰Ω†ÈúÄË¶ÅÊ±ÇÂá∫‰ªéÁÇπ1Âá∫ÂèëÔºåËÉΩÂ§üÂà∞ËææÁöÑÊâÄÊúâÁÇπ„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>:Á¨¨‰∏ÄË°åÔºö‰∏§‰∏™Êï¥Êï∞ $n, m$ÔºåÂàÜÂà´Ë°®Á§∫ÊúâÂêëÂõæÁöÑÁÇπÊï∞„ÄÅËæπÊï∞„ÄÇ($1 \leq n, m \leq 10^5$)
Êé•‰∏ãÊù• $m$ Ë°åÔºöÊØèË°å‰∏§‰∏™Êï¥Êï∞ $u_i, v_i$ÔºåË°®Á§∫Â≠òÂú®‰∏ÄÊù°‰ªé $u_i$ Âà∞ $v_i$ ÁöÑÊúâÂêëËæπ„ÄÇ ($1 \leq u_i, v_i \leq n$)
<strong>ËæìÂá∫ÊèèËø∞</strong>:ÂÖ±‰∏ÄË°åÔºå‰ªéÂ∞èÂà∞Â§ßËæìÂá∫1Âè∑ÁÇπËÉΩÂ§üÂà∞ËææÁöÑÁÇπÁöÑÁºñÂè∑„ÄÇ
<strong>bfsÊ®°Êùø</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">bitset</span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">vis</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">bfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">st</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">st</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">vis</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="nl">y</span> <span class="p">:</span> <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">y</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">                <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">m</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">!=</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span> <span class="c1">// Ëã•‰∏çÊòØ‰∏Ä‰∏™ÁÇπÔºåÂàôÊîæÂÖ•ÈÇªÊé•Ë°®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">bfs</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏Ä‰∏™Â§ßÂ∞è‰∏∫ $n \times m$ ÁöÑÁü©ÈòµÔºåÁî®Êù•Ë°®Á§∫‰∏Ä‰∏™Ëø∑ÂÆ´ÔºåÁü©Èòµ‰∏≠Ôºö0ÔºåË°®Á§∫Á©∫ÁôΩÂ§ÑÔºåÂèØ‰ª•Ë°åËµ∞Ôºõ1ÔºåË°®Á§∫ÈöúÁ¢çÁâ©Ôºå‰∏çÂèØÈÄöËøá„ÄÇÊúÄÂàùÔºåÂ∞èe‰Ωç‰∫éËø∑ÂÆ´ÁöÑÂ∑¶‰∏äËßí (1,1) Â§ÑÔºåÊØèÁßíÈíüÔºå‰ªñÂèØ‰ª•Âêë‰∏ä„ÄÅÂ∑¶„ÄÅ‰∏ã„ÄÅÂè≥‰ªªÊÑè‰∏Ä‰∏™ÊñπÂêëÁßªÂä®‰∏Ä‰∏™‰ΩçÁΩÆ„ÄÇÁé∞Âú®‰ªñÊÉ≥Ëµ∞Âà∞Ëø∑ÂÆ´ÁöÑÂè≥‰∏ãËßí $(n, m)$ Â§ÑÔºå‰Ω†ËÉΩÂê¶ÂëäËØâ‰ªñÔºå‰ªñËÉΩÂê¶Âà∞ËææÁõÆÁöÑÂú∞Ôºå‰ª•ÂèäËã•ËÉΩÂà∞ËææÔºåÊâÄÈúÄË¶ÅÁöÑÊúÄÁü≠Êó∂Èó¥‰∏∫Â§öÂ∞ëÂë¢Ôºü
<strong>ËæìÂÖ•ÊèèËø∞</strong>:Á¨¨‰∏ÄË°åÔºö‰∏§‰∏™Êï¥Êï∞ $n$ Âíå $m$ ($1 \leq n, m \leq 1000$)ÔºåÂàÜÂà´Ë°®Á§∫Áü©ÈòµÁöÑË°åÊï∞ÂíåÂàóÊï∞„ÄÇÊé•‰∏ãÊù• $n$ Ë°åÔºöÊØèË°å‰∏∫ $m$ ‰∏™Êï¥Êï∞ (0 Êàñ 1)ÔºåË°®Á§∫Ëø∑ÂÆ´Áü©ÈòµÔºåÊï∞ÊçÆ‰øùËØÅ (1,1) Âíå $(n,m)$ Âùá‰∏∫ 0„ÄÇ
<strong>ËæìÂá∫ÊèèËø∞</strong>:Ëã•Êó†Ê≥ïÂà∞Ëææ $(n,m)$ÔºåËæìÂá∫ -1ÔºõÂê¶ÂàôÔºåËæìÂá∫ÊâÄÈúÄË¶ÅÁöÑÊúÄÁü≠Êó∂Èó¥„ÄÇ
<strong>BFS+Ëø™Êù∞ÊñØÁâπÊãâ Ê±ÇÊúÄÁü≠Ë∑ØÂæÑÊ®°Êùø</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">mp</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">];</span> <span class="c1">// Â≠òÂú∞Âõæ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">];</span>  <span class="c1">// Ë°®Á§∫‰ªéËµ∑ÁÇπËµ∞Âà∞(i,j)ÊâÄÈúÄÁöÑÊúÄÂ∞èÊó∂Èó¥/Ë∑ùÁ¶ª
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">bitset</span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">vis</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">dx</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">};</span> <span class="c1">// Ë°®Á§∫‰∏ä‰∏ãÂ∑¶Âè≥ÂàÜÂà´ÂØπxÁöÑÂèòÂåñ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">dy</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span> <span class="c1">// Ë°®Á§∫‰∏ä‰∏ãÂ∑¶Âè≥ÂàÜÂà´ÂØπyÁöÑÂèòÂåñ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">bool</span> <span class="nf">inmp</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&amp;&amp;</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">bfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">sx</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sy</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">queue</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">d</span><span class="p">);</span> <span class="c1">// ÂàùÂßãÂåñ‰∏∫Êó†Á©∑
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">d</span><span class="p">[</span><span class="n">sx</span><span class="p">][</span><span class="n">sy</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">().</span><span class="n">first</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">().</span><span class="n">second</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span><span class="p">;</span> <span class="c1">// Ë°®Á§∫ÊòØÂê¶Â∑≤ÁªèÊõ¥Êñ∞Ëøá
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">vis</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">inmp</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">mp</span><span class="p">[</span><span class="n">nx</span><span class="p">][</span><span class="n">ny</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">d</span><span class="p">[</span><span class="n">nx</span><span class="p">][</span><span class="n">ny</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// ‰∏ã‰∏ÄÊ≠•Âú®Âú∞ÂõæÂÜÖ ‰∏î ‰∏ã‰∏ÄÊ≠•ÂèØËµ∞
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">d</span><span class="p">[</span><span class="n">nx</span><span class="p">][</span><span class="n">ny</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">mp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">bfs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">m</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">m</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÈÇªÊé•Ë°®">ÈÇªÊé•Ë°®
</h3><p>ÈÇªÊé•Ë°®ÊòØÂõæÁöÑÂè¶‰∏ÄÁßçÂ∏∏Áî®Êï∞ÊçÆÁªìÊûÑÔºåÁî®‰∫éË°®Á§∫Âõæ‰∏≠È°∂ÁÇπ‰πãÈó¥ÁöÑÂÖ≥Á≥ª„ÄÇ‰∏éÈÇªÊé•Áü©Èòµ‰∏çÂêåÔºåÈÇªÊé•Ë°®Êõ¥ËäÇÁúÅÁ©∫Èó¥ÔºåÂ∞§ÂÖ∂ÊòØÂØπ‰∫é<strong>Á®ÄÁñèÂõæÔºàËæπÁöÑÊï∞ÈáèËøúÂ∞è‰∫éÈ°∂ÁÇπÂØπÁöÑÊï∞ÈáèÔºâ</strong>„ÄÇ<strong>ÈÇªÊé•Ë°®ÈÄöËøá‰∏∫ÊØè‰∏™È°∂ÁÇπÁª¥Êä§‰∏Ä‰∏™ÂàóË°®Êù•ËÆ∞ÂΩïÂÖ∂Áõ∏ÈÇªÁöÑÈ°∂ÁÇπ</strong>Ôºå‰ªéËÄåË°®Á§∫ÂõæÁöÑÁªìÊûÑ„ÄÇ
<strong>g[i]Ë°®Á§∫È°∂ÁÇπiÁöÑÊâÄÊúâÂá∫ÁÇπÔºàÁî±iËÉΩÂ§üÂà∞ËææÁöÑÁÇπÔºâÁºñÂè∑</strong>
<strong>Âú®Â≠òÊ†ëÊó∂Ôºå‰∏çÈúÄË¶ÅÁü•ÈÅìÊØè‰∏™ÁÇπÁöÑÂá∫ÂÖ•ÁÇπÔºåÂè™ÈúÄË¶ÅÁü•ÈÅìÊØè‰∏™ÁÇπÁöÑÁà∂ËäÇÁÇπÂ∞±Ë°å‰∫Ü„ÄÇÁî®fa[i]Âç≥ÂèØË°®Á§∫„ÄÇ</strong>
<strong>‰∏ÄËà¨Áî®vectorÊù•ÂÆûÁé∞</strong>
eg:<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏ÄÊ£µÂ§ßÂ∞è‰∏∫ $n$ÔºåÊ†π‰∏∫ 1 ÁöÑÊ†ëÔºåÊ±ÇÂá∫ÂÖ∂ dfs Â∫è„ÄÅbfs Â∫è„ÄÇËØ∑Â∞ÜÊâÄÊúâÂá∫ÁÇπÊåâÁÖßÁºñÂè∑‰ªéÂ∞èÂà∞Â§ßÊéíÂ∫èÂêéËøõË°åÈÅçÂéÜ„ÄÇËß£ÈáäÔºödfs ‰∏∫Ê∑±Â∫¶‰ºòÂÖàÊêúÁ¥¢Ôºåbfs ‰∏∫ÂÆΩÂ∫¶‰ºòÂÖàÊêúÁ¥¢„ÄÇ
<strong>ËæìÂÖ•Ê†ºÂºè</strong>:‰∏Ä‰∏™Êï¥Êï∞ $n$ÔºåË°®Á§∫ÁÇπÁöÑ‰∏™Êï∞„ÄÇ ($1 \leq n \leq 50$)Êé•‰∏ãÊù•‰∏ÄË°å $n-1$ ‰∏™Êï¥Êï∞ÔºåÁ¨¨ $i$ ‰∏™Êï∞Â≠ó $fa_i$ Ë°®Á§∫ÁÇπ $i$ ÁöÑÁà∂‰∫≤„ÄÇ($1 \leq fa_i \leq n$)
<strong>ËæìÂá∫Ê†ºÂºè</strong>:Á¨¨‰∏ÄË°åËæìÂá∫ dfs Â∫èÔºåÁ¨¨‰∫åË°åËæìÂá∫ bfs Â∫è„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">fa</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>        <span class="c1">// Â≠òÊîæÁà∂ËäÇÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">// Â≠òÊîæÈÇªÊé•Ë°® Â≠òÊîæÊØè‰∏™ÁÇπÁöÑÂá∫ÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span>   <span class="c1">// pÂç≥Âèå‰∫≤
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="nl">y</span> <span class="p">:</span> <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">dfs</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">bfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">st</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">st</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>  <span class="c1">//xÂ∞±ÊòØÁé∞Âú®ÊâÄÂú®ÁöÑËäÇÁÇπÔºåÂºÄÂßãËµ∞‰ªñÁöÑÂ≠êËäÇÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="nl">y</span> <span class="p">:</span> <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">y</span><span class="p">);</span> <span class="c1">//ÈÅçÂéÜÂÖ®ÈÉ®Â≠êËäÇÁÇπÊîæËøõÈòüÂàó
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">fa</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span><span class="p">[</span><span class="n">fa</span><span class="p">[</span><span class="n">i</span><span class="p">]].</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">sort</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">begin</span><span class="p">(),</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">end</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">bfs</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="7Âπ∂Êü•ÈõÜÊúÄÁü≠Ë∑Ø">7.Âπ∂Êü•ÈõÜ„ÄÅÊúÄÁü≠Ë∑Ø
</h2><h3 id="Âπ∂Êü•ÈõÜ">Âπ∂Êü•ÈõÜ
</h3><p>Âπ∂Êü•ÈõÜÔºàUnion-FindÔºâÊòØ‰∏ÄÁßçÁî®‰∫éÂ§ÑÁêÜ‰∏Ä‰∫õ‰∏ç‰∫§ÈõÜÁöÑÂêàÂπ∂ÂèäÊü•ËØ¢ÈóÆÈ¢òÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÇÂÆÉÂú®ËÆ∏Â§öÁÆóÊ≥ïÈóÆÈ¢ò‰∏≠ÈÉΩÈùûÂ∏∏ÊúâÁî®ÔºåÁâπÂà´ÊòØÂú®ÈÇ£‰∫õÈúÄË¶ÅÂä®ÊÄÅÁª¥Êä§ÂÖÉÁ¥†ÈõÜÂêàÁöÑÂπ∂ÈõÜÂíåÊü•ËØ¢‰∏§‰∏™ÂÖÉÁ¥†ÊòØÂê¶Â±û‰∫éÂêå‰∏ÄÈõÜÂêàÁöÑÂú∫ÊôØ‰∏≠„ÄÇ
Âπ∂Êü•ÈõÜ‰∏ªË¶ÅÊúâ‰∏§‰∏™Êìç‰ΩúÔºö<strong>Êü•Êâæ</strong>ÔºàFindÔºâÔºöÁ°ÆÂÆö‰∏§‰∏™ÂÖÉÁ¥†ÊòØÂê¶Â±û‰∫éÂêå‰∏Ä‰∏™ÈõÜÂêà„ÄÇÔºà<strong>ÂéüÁêÜÊòØÂéªÊâæËäÇÁÇπÁöÑÊ†πÔºåÂ¶ÇÊûú‰∏§‰∏™ËäÇÁÇπÁöÑÊ†πÊòØÂêå‰∏Ä‰∏™ËäÇÁÇπÔºåÂàô‰ªñ‰ª¨Â±û‰∫éÊúâÂêå‰∏Ä‰∏™ËøûÈÄöÂùó</strong>Ôºâ<strong>ÂêàÂπ∂</strong>ÔºàUnionÔºâÔºöÂ∞Ü‰∏§‰∏™ÂÖÉÁ¥†ÊâÄÂú®ÁöÑÈõÜÂêàÂêàÂπ∂„ÄÇÔºà<strong>ÂéüÁêÜÊòØÊää‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÊ†πËøûÂà∞Âè¶‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÊ†πÔºå‰Ωø‰ªñ‰ª¨Ê†πËäÇÁÇπÁõ∏Âêå</strong>Ôºâ
ÊâÄ‰ª• <strong>ÊâÄÊúâÊìç‰ΩúÈÉΩÂú®Ê†π‰∏ä</strong>ÔºåÂπ∂‰∏çÂÖ≥ÂøÉÊüê‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑËäÇÁÇπÔºåËÄåÂè™ÂÖ≥ÂøÉ‰∏Ä‰∏™ËøûÈÄöÂùóÁöÑÊ†π„ÄÇ
<strong>Ë∑ØÂæÑÂéãÁº©</strong>ÔºàPath CompressionÔºâÊòØ‰∏ÄÁßç‰ºòÂåñÊäÄÊúØÔºåÁî®‰∫éÂä†ÈÄüÊü•ÊâæÔºàFindÔºâÊìç‰Ωú„ÄÇÂú®Ê≤°ÊúâË∑ØÂæÑÂéãÁº©ÁöÑÊÉÖÂÜµ‰∏ãÔºåÊü•ÊâæÊìç‰ΩúÂèØËÉΩÈúÄË¶ÅÈÅçÂéÜÂæàÈïøÁöÑË∑ØÂæÑÊâçËÉΩÂà∞ËææÊ†πËäÇÁÇπÔºåËøô‰ºöÂØºËá¥Êü•ÊâæÊìç‰ΩúÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶ËæÉÈ´ò„ÄÇË∑ØÂæÑÂéãÁº©<strong>ÈÄöËøáÂú®Êü•ÊâæËøáÁ®ã‰∏≠Â∞ÜÊü•ÊâæË∑ØÂæÑ‰∏äÁöÑÊâÄÊúâËäÇÁÇπÁõ¥Êé•ËøûÊé•Âà∞Ê†πËäÇÁÇπ</strong>Ôºå‰ªéËÄåÂáèÂ∞ëÊú™Êù•ÁöÑÊü•ÊâæÊìç‰ΩúÁöÑÊó∂Èó¥„ÄÇ
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="n">n</span> <span class="p">(</span><span class="err">ÂÖÉÁ¥†Êï∞Èáè</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="n">parent</span><span class="p">[]</span> <span class="p">(</span><span class="err">ÊØè‰∏™ÁÇπÁöÑÁà∂ËäÇÁÇπ</span><span class="p">),</span> <span class="n">size</span><span class="p">[]</span> <span class="p">(</span><span class="err">ÊØè‰∏™ÈõÜÂêàÁöÑÂ§ßÂ∞è</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">parent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="p">(</span><span class="err">ÊØè‰∏™ÁÇπÂàùÂßãÂåñ‰∏∫Ëá™Â∑±ÁöÑÁà∂ËäÇÁÇπ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">size</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">(</span><span class="err">ÊØè‰∏™ÈõÜÂêàÁöÑÂàùÂßãÂ§ßÂ∞è‰∏∫</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">Êü•ÊâæÊ†πËäÇÁÇπÔºàË∑ØÂæÑÂéãÁº©Ôºâ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">function</span> <span class="n">find</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="n">parent</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="nl">x</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">           <span class="n">parent</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">parent</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="p">(</span><span class="err">ÈÄíÂΩíÊâæÊ†πËäÇÁÇπÂπ∂Ë∑ØÂæÑÂéãÁº©</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">parent</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">ÂêàÂπ∂‰∏§‰∏™ÁÇπÊâÄÂú®ÁöÑÈõÜÂêàÔºàÊåâÁß©ÂêàÂπ∂Ôºâ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">function</span> <span class="k">union</span><span class="err">(</span><span class="nc">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">rootX</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="n">rootY</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="n">rootX</span> <span class="o">!=</span> <span class="nl">rootY</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">           <span class="k">if</span> <span class="n">size</span><span class="p">[</span><span class="n">rootX</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">[</span><span class="n">rootY</span><span class="p">]</span><span class="o">:</span> 
</span></span><span class="line"><span class="cl">               <span class="n">swap</span><span class="p">(</span><span class="n">rootX</span><span class="p">,</span> <span class="n">rootY</span><span class="p">)</span> <span class="p">(</span><span class="err">Á°Æ‰øù</span> <span class="n">rootX</span> <span class="err">ÊòØËæÉÂ§ßÈõÜÂêà</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="n">parent</span><span class="p">[</span><span class="n">rootY</span><span class="p">]</span> <span class="o">=</span> <span class="n">rootX</span> <span class="p">(</span><span class="err">Â∞Ü</span> <span class="n">rootY</span> <span class="err">ÂêàÂπ∂Âà∞</span> <span class="n">rootX</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="n">size</span><span class="p">[</span><span class="n">rootX</span><span class="p">]</span> <span class="o">+=</span> <span class="n">size</span><span class="p">[</span><span class="n">rootY</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="err">Âà§Êñ≠‰∏§‰∏™ÁÇπÊòØÂê¶Âú®Âêå‰∏ÄÈõÜÂêà</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">function</span> <span class="n">isConnected</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">find</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">find</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÁªôÂÆö‰∏Ä‰∏™Êó†ÂêëÂõæÔºåÂåÖÂê´ $n$ ‰∏™ÁÇπÔºå$m$ Êù°ËæπÔºàÊ≤°ÊúâÈáçËæπÂíåËá™ÁéØÔºâ„ÄÇÊ±ÇÂõæ‰∏≠ÊâÄÊúâËÅîÈÄöÂùóÁöÑÂ§ßÂ∞è„ÄÇ
<strong>ËæìÂÖ•Ê†ºÂºè</strong>ÔºöÁ¨¨‰∏ÄË°åÔºö‰∏§‰∏™Êï¥Êï∞ $n$Ôºå$m$ÔºåË°®Á§∫ÁÇπÊï∞ÂíåËæπÊï∞„ÄÇÔºà$1 \leq n, m \leq 2 \times 10^5$ÔºâÊé•‰∏ãÊù• $m$ Ë°åÔºöÊØèË°å‰∏§‰∏™Êï¥Êï∞ $u_i$Ôºå$v_i$ÔºåË°®Á§∫Âú® $u_i$ Âíå $v_i$ ‰πãÈó¥Â≠òÂú®‰∏ÄÊù°Êó†ÂêëËæπ„ÄÇ
<strong>ËæìÂá∫Ê†ºÂºè</strong>Ôºö‰ªéÂ∞èÂà∞Â§ßËæìÂá∫ÊâÄÊúâËÅîÈÄöÂùóÁöÑÂ§ßÂ∞è„ÄÇ
<strong>Âπ∂Êü•ÈõÜÊ®°Êùø</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">pre</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">cnt</span><span class="p">[</span><span class="n">N</span><span class="p">];</span><span class="c1">//pre[i]Ë°®Á§∫iÊâÄÂú®ÁöÑËøûÈÄöÂùó
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">root</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="c1">// ÊâæxÊâÄÂú®ËÅîÈÄöÂùóÁöÑÊ†πËäÇÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">pre</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pre</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span> <span class="o">?</span> <span class="nl">x</span> <span class="p">:</span> <span class="n">root</span><span class="p">(</span><span class="n">pre</span><span class="p">[</span><span class="n">x</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">merge</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="c1">// ÂÅöËøûÈÄöÂùóÂêàÂπ∂
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">pre</span><span class="p">[</span><span class="n">root</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">isConnected</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="c1">// Âà§Êñ≠ÊòØÂê¶Âú®ÂêåÊÑèËøûÈÄöÂùó
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">root</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">root</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">pre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">merge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>    <span class="c1">//ÊØèËæìÂÖ•‰∏ÄÊù°Ëæπ Â∞±Áõ∏ÂΩì‰∫éÊää‰∏§‰∏™ËäÇÁÇπÂêàÂπ∂
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cnt</span><span class="p">[</span><span class="n">root</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">v</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">sort</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">v</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="nl">y</span> <span class="p">:</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">y</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÊúÄÁü≠Ë∑Ø">ÊúÄÁü≠Ë∑Ø
</h3><p>ÊúÄÁü≠Ë∑ØÂæÑÈóÆÈ¢òÊòØÂõæËÆ∫‰∏≠ÁöÑ‰∏Ä‰∏™ÁªèÂÖ∏ÈóÆÈ¢òÔºåÁõÆÁöÑÊòØÊâæÂà∞Âõæ‰∏≠‰∏§‰∏™È°∂ÁÇπ‰πãÈó¥ÁöÑÊúÄÁü≠Ë∑ØÂæÑ„ÄÇÊ†πÊçÆÂõæÁöÑÁ±ªÂûãÔºàÊúâÂêëÂõæÊàñÊó†ÂêëÂõæÔºâÂíåËæπÁöÑÊùÉÈáçÔºàÊ≠£ÊùÉÈáçÊàñË¥üÊùÉÈáçÔºâÔºåÊúÄÁü≠Ë∑ØÂæÑÈóÆÈ¢òÁöÑËß£ÂÜ≥ÊñπÊ≥ï‰πüÊúâÊâÄ‰∏çÂêå„ÄÇ</p>
<h4 id="Â∏∏ËßÅÁöÑÊúÄÁü≠Ë∑ØÂæÑÁÆóÊ≥ï">Â∏∏ËßÅÁöÑÊúÄÁü≠Ë∑ØÂæÑÁÆóÊ≥ï####
</h4><h5 id="dijkstra-ÁÆóÊ≥ï">Dijkstra ÁÆóÊ≥ï
</h5><p><strong>ÂçïÊ∫êÊúÄÁü≠Ë∑ØÂæÑÔºåÈÄÇÁî®‰∫éÊúâÂêëÂõæÊàñÊó†ÂêëÂõæÔºå‰∏îËæπÁöÑÊùÉÈáçÂøÖÈ°ªÈùûË¥ü</strong>„ÄÇ‰ΩøÁî®<strong>Ë¥™ÂøÉÁ≠ñÁï•</strong>Ôºå‰ªéÊ∫êÁÇπÂºÄÂßãÔºåÈÄêÊ≠•Êâ©Â±ïÂà∞Ë∑ùÁ¶ªÊ∫êÁÇπÊúÄËøëÁöÑÈ°∂ÁÇπ„ÄÇÊó∂Èó¥Â§çÊùÇÂ∫¶Ôºö‰ΩøÁî®‰ºòÂÖàÈòüÂàóÊó∂‰∏∫ O((V+E)logV)ÔºåÂÖ∂‰∏≠ V ÊòØÈ°∂ÁÇπÊï∞ÔºåE ÊòØËæπÊï∞„ÄÇ
<strong>ÊÄùË∑Ø</strong>ÔºöÂàõÂª∫‰∏Ä‰∏™Ë∑ùÁ¶ªÊï∞ÁªÑ dist[]ÔºåÂÖ∂‰∏≠ dist[i] Ë°®Á§∫‰ªéÊ∫êÁÇπÂà∞È°∂ÁÇπ i ÁöÑÊúÄÁü≠Ë∑ùÁ¶ª„ÄÇÂàùÂßãÊó∂ÔºåÂ∞ÜÊ∫êÁÇπÂà∞Ëá™Ë∫´ÁöÑË∑ùÁ¶ªËÆæ‰∏∫0ÔºåÂÖ∂‰ªñÊâÄÊúâÈ°∂ÁÇπÁöÑË∑ùÁ¶ªËÆæ‰∏∫Êó†Á©∑Â§ßÔºàINFÔºâ„ÄÇÈÅçÂéÜÊ∫êÁÇπÁöÑÊØè‰∏ÄÊù°ËæπÔºåÁî®ÊØè‰∏ÄÊù°ËæπÂéªÊõ¥Êñ∞ÊúÄÁü≠Ë∑ØÂæÑ„ÄÇÁÑ∂ÂêéÂú®ÊâÄÊúâÁÇπÈáåÊâæË∑ùÁ¶ªÊ∫êÁÇπÊúÄËøëÁöÑÁÇπÔºåÈÅçÂéÜÂÆÉÁöÑÊØè‰∏ÄÊù°ËæπÔºåÁî®ÊØè‰∏ÄÊù°ËæπÂéªÊõ¥Êñ∞ÊúÄÁü≠Ë∑ØÂæÑ„ÄÇ‰∏çÊñ≠ÈÄíÂΩíÔºåÁõ¥Âà∞ÈÅçÂéÜ‰∫ÜÂÖ®ÈÉ®ÁöÑÁÇπ„ÄÇ
‰º™‰ª£Á†ÅÂÆûÁé∞Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="err">Êú¥Á¥†Êï∞ÁªÑÂÆûÁé∞Ôºõ</span>
</span></span><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="n">n</span> <span class="p">(</span><span class="err">ÁÇπÁöÑÊï∞Èáè</span><span class="p">),</span> <span class="n">graph</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="p">(</span><span class="err">ÈÇªÊé•Áü©Èòµ</span><span class="p">,</span> <span class="err">‰∏çÂ≠òÂú®ËæπÊó∂ÂÄº‰∏∫</span> <span class="err">‚àû</span><span class="p">),</span> <span class="n">start</span> <span class="p">(</span><span class="err">Ëµ∑ÁÇπ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="n">dist</span><span class="p">[]</span> <span class="p">(</span><span class="err">‰ªéËµ∑ÁÇπÂà∞ÊØè‰∏™ÁÇπÁöÑÊúÄÁü≠Ë∑ùÁ¶ª</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">dist</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="err">‚àû</span><span class="p">,</span> <span class="err">‚àû</span><span class="p">,</span> <span class="p">...,</span> <span class="err">‚àû</span><span class="p">}</span> <span class="p">(</span><span class="err">ÈïøÂ∫¶‰∏∫</span> <span class="n">n</span><span class="err">ÔºåÊâÄÊúâÁÇπÁöÑÂàùÂßãË∑ùÁ¶ª‰∏∫Êó†Á©∑Â§ß</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">visited</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">false</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="p">...,</span> <span class="nb">false</span><span class="p">}</span> <span class="p">(</span><span class="err">ÈïøÂ∫¶‰∏∫</span> <span class="n">n</span><span class="err">ÔºåÊ†áËÆ∞ÊòØÂê¶ËÆøÈóÆËøá</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">dist</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">(</span><span class="err">Ëµ∑ÁÇπÂà∞Ëá™Ë∫´ÁöÑË∑ùÁ¶ª‰∏∫</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">ÂØπÊØè‰∏™ÁÇπÂæ™ÁéØ</span> <span class="n">n</span> <span class="err">Ê¨°</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">a</span><span class="p">.</span> <span class="err">‰ªéÊú™ËÆøÈóÆÁöÑÁÇπ‰∏≠ÊâæÂà∞Ë∑ùÁ¶ªËµ∑ÁÇπÊúÄËøëÁöÑÁÇπ</span> <span class="nl">u</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">min_dist</span> <span class="o">=</span> <span class="err">‚àû</span>
</span></span><span class="line"><span class="cl">      <span class="n">u</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="n">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="n">and</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nl">min_dist</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">              <span class="n">min_dist</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">              <span class="n">u</span> <span class="o">=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">   <span class="n">b</span><span class="p">.</span> <span class="err">Â¶ÇÊûú</span> <span class="n">u</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="err">Êàñ</span> <span class="n">min_dist</span> <span class="o">==</span> <span class="err">‚àûÔºåÈÄÄÂá∫Âæ™ÁéØ</span> <span class="p">(</span><span class="err">Ââ©‰ΩôÁÇπ‰∏çÂèØËææ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">c</span><span class="p">.</span> <span class="err">Ê†áËÆ∞ÁÇπ</span> <span class="n">u</span> <span class="err">‰∏∫Â∑≤ËÆøÈóÆ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">visited</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">d</span><span class="p">.</span> <span class="err">Êõ¥Êñ∞‰ªé</span> <span class="n">u</span> <span class="err">Âà∞ÂÖ∂‰ªñÁÇπÁöÑÊúÄÁü≠Ë∑ùÁ¶ª</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="n">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="n">and</span> <span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">!=</span> <span class="err">‚àû</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">              <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">dist</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">ËøîÂõû</span> <span class="n">dist</span><span class="p">[]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="err">‰ºòÂÖàÈòüÂàóÂÆûÁé∞Ôºö</span>
</span></span><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="n">n</span> <span class="p">(</span><span class="err">ÁÇπÁöÑÊï∞Èáè</span><span class="p">),</span> <span class="n">graph</span> <span class="p">(</span><span class="err">ÈÇªÊé•Ë°®</span><span class="p">,</span> <span class="err">ÊØè‰∏™ÁÇπÂ≠òÂÆÉÁöÑËæπ</span><span class="p">),</span> <span class="n">start</span> <span class="p">(</span><span class="err">Ëµ∑ÁÇπ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="n">dist</span><span class="p">[]</span> <span class="p">(</span><span class="err">‰ªéËµ∑ÁÇπÂà∞ÊØè‰∏™ÁÇπÁöÑÊúÄÁü≠Ë∑ùÁ¶ª</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">dist</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="err">‚àû</span><span class="p">,</span> <span class="err">‚àû</span><span class="p">,</span> <span class="p">...,</span> <span class="err">‚àû</span><span class="p">}</span> <span class="p">(</span><span class="err">ÊâÄÊúâÁÇπÁöÑÂàùÂßãË∑ùÁ¶ª‰∏∫Êó†Á©∑Â§ß</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">visited</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">false</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="p">...,</span> <span class="nb">false</span><span class="p">}</span> <span class="p">(</span><span class="err">Ê†áËÆ∞ÊòØÂê¶ËÆøÈóÆËøá</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">dist</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">   <span class="err">ÂàõÂª∫‰ºòÂÖàÈòüÂàó</span> <span class="n">pq</span><span class="err">ÔºåÂàùÂßãÊó∂ÊèíÂÖ•</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span> <span class="p">(</span><span class="err">Ë∑ùÁ¶ª‰∏∫</span> <span class="mi">0</span> <span class="err">ÁöÑËµ∑ÁÇπ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">ÂΩìÈòüÂàó</span> <span class="n">pq</span> <span class="err">‰∏ç‰∏∫Á©∫Êó∂</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">a</span><span class="p">.</span> <span class="err">‰ªéÈòüÂàó‰∏≠ÂºπÂá∫ÂΩìÂâçË∑ùÁ¶ªÊúÄËøëÁöÑÁÇπ</span> <span class="p">(</span><span class="n">du</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="n">du</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="o">=</span> <span class="n">pq</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="n">visited</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">          <span class="k">continue</span>
</span></span><span class="line"><span class="cl">      <span class="err">Ê†áËÆ∞</span> <span class="n">u</span> <span class="err">‰∏∫Â∑≤ËÆøÈóÆ</span><span class="o">:</span> <span class="n">visited</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">b</span><span class="p">.</span> <span class="err">ÈÅçÂéÜ</span> <span class="n">u</span> <span class="err">ÁöÑÊâÄÊúâÁõ∏ÈÇªÁÇπ</span> <span class="nl">v</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="n">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">          <span class="err">Êñ∞Ë∑ùÁ¶ª</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">weight</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="err">Êñ∞Ë∑ùÁ¶ª</span> <span class="o">&lt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">              <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="err">Êñ∞Ë∑ùÁ¶ª</span>
</span></span><span class="line"><span class="cl">              <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">((</span><span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">v</span><span class="p">))</span> <span class="p">(</span><span class="err">Â∞ÜÊõ¥Êñ∞ÂêéÁöÑÁÇπÂä†ÂÖ•ÈòüÂàó</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">ËøîÂõû</span> <span class="n">dist</span><span class="p">[]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÁªôÂÆö‰∏Ä‰∏™ $n$ ‰∏™ÁÇπ„ÄÅ$m$ Êù°ËæπÁöÑÊúâÂêëÂõæÔºåË¶ÅÊ±ÇËÆ°ÁÆóÂá∫ÁÇπ 1 Âà∞ÁÇπ $n$ ÁöÑÊúÄÁü≠Ë∑ùÁ¶ª„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>ÔºöÁ¨¨‰∏ÄË°åÔºö‰∏§‰∏™Êï¥Êï∞ $n, m$„ÄÇ ($1 \leq n \leq 10^3, 1 \leq m \leq 10^5$)Êé•‰∏ãÊù• $m$ Ë°åÔºöÊØèË°å‰∏â‰∏™Êï¥Êï∞ $u_i, v_i, w_i$ÔºåË°®Á§∫Â≠òÂú®‰∏ÄÊù°‰ªé $u_i$ Âà∞ $v_i$ÔºåÊùÉÂÄº‰∏∫ $w_i$ ÁöÑÊúâÂêëËæπ„ÄÇ ($1 \leq u_i, v_i \leq n, 1 \leq w_i \leq 10^6$)
<strong>ËæìÂá∫ÊèèËø∞</strong>Ôºö‰∏Ä‰∏™Êï¥Êï∞ÔºåË°®Á§∫ÁÇπ 1 Âà∞ÁÇπ $n$ ÁöÑÊúÄÁü≠Ë∑ùÁ¶ªÔºõËã•‰∏çÂ≠òÂú®‰ªéÁÇπ 1 Âà∞ÁÇπ $n$ ÁöÑË∑ØÂæÑÔºåÂàôËæìÂá∫ -1„ÄÇ
<strong>Êú¥Á¥†dijkstraÊ®°Êùø</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">Edge</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span> <span class="c1">// xË°®Á§∫Âá∫ÁÇπÔºåwË°®Á§∫ÊùÉÂÄº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">dijkstra</span><span class="p">(</span><span class="kt">int</span> <span class="n">st</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span><span class="p">[</span><span class="n">st</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">bitset</span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">vis</span><span class="p">;</span> <span class="c1">// Ë°®Á§∫Â∑≤ÁªèÂà∞ËææËøáÁöÑÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ÊâæÂá∫Ë∑ùÁ¶ªÊ∫êÁÇπÊúÄËøëÁöÑÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">||</span> <span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">d</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">                <span class="n">u</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">vis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Ê≠§Êó∂d[u]Â∞±ÊòØÊúÄËøëÁöÑÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">]</span> <span class="o">:</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">!=</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">dijkstra</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mh">0x3f3f3f3f</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>‰ºòÂÖàÈòüÂàóÁâàdijkstraÊ®°Êùø ÊïàÁéáÊõ¥È´ò</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">Edge</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span> <span class="c1">// xË°®Á§∫Âá∫ÁÇπÔºåwË°®Á§∫ÊùÉÂÄº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">Edge</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">)</span> <span class="k">const</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">w</span> <span class="o">==</span> <span class="n">v</span><span class="p">.</span><span class="n">w</span> <span class="o">?</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">.</span><span class="nl">x</span> <span class="p">:</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ‰ºòÂÖàÊØîËæÉÊùÉÂÄº ÊùÉÂÄºË∂äÂ§ßÔºåÂàôË∂ä&lt; ÂàôË∂ä‰ºòÂÖà
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">dijkstra</span><span class="p">(</span><span class="kt">int</span> <span class="n">st</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span><span class="p">[</span><span class="n">st</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">bitset</span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">vis</span><span class="p">;</span> <span class="c1">// Ë°®Á§∫Â∑≤ÁªèÂà∞ËææËøáÁöÑÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span> <span class="n">pq</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">st</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">st</span><span class="p">]});</span> <span class="c1">//Â∞ÜËµ∑ÁÇπ‰Ωú‰∏∫ÂæÖÂà∞ËææÁöÑÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">while</span> <span class="p">(</span><span class="n">pq</span><span class="p">.</span><span class="n">size</span><span class="p">())</span><span class="c1">//Âè™Ë¶ÅÈòüÂàóÈáåËøòÊúâÁ≠âÂæÖÊãìÂ±ïÁöÑÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">pq</span><span class="p">.</span><span class="n">top</span><span class="p">().</span><span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">pq</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span><span class="p">;</span><span class="c1">//ÂèñÂá∫ÁöÑxÁÇπÂ∑≤ÁªèÂæóÂà∞‰∫ÜÊúÄÁü≠Ë∑ùÁ¶ªd[x]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">vis</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">]</span> <span class="o">:</span> <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">d</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//Ëã•vix[y]ËØ¥ÊòéyÁöÑÊúÄÁü≠Ë∑ùÁ¶ªÂ∑≤ÁªèËÆ°ÁÆóËøáÔºåÊó†ÈúÄÊõ¥Êñ∞
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">d</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">y</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">y</span><span class="p">]});</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">!=</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">dijkstra</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mh">0x3f3f3f3f</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÈáçÁÇπËØ≠Âè•ÂàÜÊûê</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">return</span> <span class="n">w</span> <span class="o">==</span> <span class="n">v</span><span class="p">.</span><span class="n">w</span> <span class="o">?</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">.</span><span class="nl">x</span> <span class="p">:</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂØπ‰∫é w != v.w ÁöÑÊÉÖÂÜµÔºö</p>
<ul>
<li>Â¶ÇÊûú w &gt; v.wÔºåËøîÂõû trueÔºöÂΩìÂâç Edge Ë¢´ËÆ§‰∏∫‚ÄúËæÉÂ∞è‚Äù„ÄÇÂú®Â§ßÈ°∂Â†Ü‰∏≠ÔºåÂÆÉ‰ºòÂÖàÁ∫ßËæÉ‰ΩéÔºåÊéíÂêé„ÄÇ</li>
<li>Â¶ÇÊûú w &lt; v.wÔºåËøîÂõû falseÔºöÂΩìÂâç Edge Ë¢´ËÆ§‰∏∫‚ÄúËæÉÂ§ß‚Äù„ÄÇÂú®Â§ßÈ°∂Â†Ü‰∏≠ÔºåÂÆÉ‰ºòÂÖàÁ∫ßËæÉÈ´òÔºåÊéíÂâç„ÄÇ
<strong>‰ºòÂÖàÈòüÂàóÈªòËÆ§ÊòØÂ§ßÊ†πÂ†Ü„ÄÇ</strong></li>
</ul>
<h5 id="floyd-warshall-ÁÆóÊ≥ï">Floyd-Warshall ÁÆóÊ≥ï
</h5><p><strong>Â§öÊ∫êÊúÄÁü≠Ë∑ØÂæÑÁÆóÊ≥ïÔºåÈÄÇÁî®‰∫éÊúâÂêëÂõæÊàñÊó†ÂêëÂõæÔºåÂèØ‰ª•Â§ÑÁêÜË¥üÊùÉÈáçËæπÔºå‰ΩÜ‰∏çËÉΩÊúâË¥üÊùÉÈáçÁéØ</strong>„ÄÇÈÄöËøáÂä®ÊÄÅËßÑÂàíÊñπÊ≥ïËÆ°ÁÆóÂõæ‰∏≠ÊâÄÊúâÈ°∂ÁÇπÂØπÁöÑÊúÄÁü≠Ë∑ØÂæÑ„ÄÇÊó∂Èó¥Â§çÊùÇÂ∫¶ÔºöO(V^3)„ÄÇ</p>
<p><strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong>Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="n">n</span> <span class="p">(</span><span class="err">ÁÇπÁöÑÊï∞Èáè</span><span class="p">),</span> <span class="n">graph</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="p">(</span><span class="err">ÈÇªÊé•Áü©Èòµ</span><span class="p">,</span> <span class="err">‰∏çÂ≠òÂú®ËæπÊó∂ÂÄº‰∏∫</span> <span class="err">‚àû</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="n">dist</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="p">(</span><span class="err">‰ªªÊÑè‰∏§ÁÇπ‰πãÈó¥ÁöÑÊúÄÁü≠Ë∑ùÁ¶ª</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">graph</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="p">(</span><span class="err">Áõ¥Êé•‰ΩøÁî®ËæìÂÖ•Âõæ‰Ωú‰∏∫ÂàùÂßãË∑ùÁ¶ªÁü©Èòµ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">(</span><span class="err">Ëá™Â∑±Âà∞Ëá™Â∑±Ë∑ùÁ¶ª‰∏∫</span><span class="mi">0</span><span class="p">,</span><span class="err">Ëá™ÁéØÊó∂Ê≥®ÊÑè</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">‰∏âÈáçÂæ™ÁéØ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">n</span><span class="p">:</span>         <span class="p">(</span><span class="err">Êûö‰∏æ‰∏≠Èó¥ÁÇπ</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">n</span><span class="p">:</span>     <span class="p">(</span><span class="err">Êûö‰∏æËµ∑ÁÇπ</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">n</span><span class="p">:</span> <span class="p">(</span><span class="err">Êûö‰∏æÁªàÁÇπ</span> <span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">               <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dist</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">ËøîÂõû</span> <span class="n">dist</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÁªôÂÆö‰∏Ä‰∏™ $n$ ‰∏™ÁÇπ„ÄÅ$m$ Êù°ËæπÁöÑÊúâÂêëÂõæ„ÄÇÂÜçÁªôÂá∫ $q$ Ê¨°ËØ¢ÈóÆÔºåÊØè‰∏™ËØ¢ÈóÆ‰∏∫‰∏§‰∏™Êï¥Êï∞ $u_i, v_i$Ôºå‰Ω†ÈúÄË¶ÅÂõûÁ≠î‰ªé $u_i$ Âà∞ $v_i$ ÁöÑÊúÄÁü≠Ë∑ùÁ¶ª„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>ÔºöÁ¨¨‰∏ÄË°åÔºö‰∏â‰∏™Êï¥Êï∞ $n, m, q$„ÄÇ ($1 \leq n \leq 300, 1 \leq m, q \leq 10^5$)„ÄÇÊé•‰∏ãÊù• $m$ Ë°åÔºöÊØèË°å‰∏â‰∏™Êï¥Êï∞ $u_i, v_i, w_i$ÔºåË°®Á§∫Â≠òÂú®‰∏ÄÊù°‰ªé $u_i$ Âà∞ $v_i$ÔºåÊùÉÂÄº‰∏∫ $w_i$ ÁöÑÊúâÂêëËæπ„ÄÇ ($1 \leq u_i, v_i \leq n, 0 \leq w_i \leq 10^6$)ÂèØËÉΩÂ≠òÂú®ÈáçËæπÂíåËá™ÁéØ„ÄÇÂÜçÊé•‰∏ãÊù• $q$ Ë°åÔºåÊØèË°å‰∏§‰∏™Êï¥Êï∞ $u_i, v_i$ÔºåË°®Á§∫Êü•ËØ¢‰ªé $u_i$ Âà∞ $v_i$ ÁöÑÊúÄÁü≠Ë∑ùÁ¶ª„ÄÇ
<strong>ËæìÂá∫ÊèèËø∞</strong>ÔºöÂÖ± $q$ Ë°åÔºöÊØèË°å‰∏Ä‰∏™Êï¥Êï∞ÔºåË°®Á§∫Êü•ËØ¢ÁöÑÊúÄÁü≠Ë∑ùÁ¶ªÔºõËã•‰∏çÂ≠òÂú®Ë∑ØÂæÑÔºåÂàôËæìÂá∫ -1„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">300</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">ll</span> <span class="n">inf</span> <span class="o">=</span> <span class="mf">4e18</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">d</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ll</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">],</span> <span class="n">w</span><span class="p">);</span> <span class="c1">// Â§ÑÁêÜÈáçËæπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ÂàùÂßãÂåñÔºö
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">inf</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÁÆóÊ≥ïÂØπÊØî">ÁÆóÊ≥ïÂØπÊØî
</h3><div class="table-wrapper"><table>
<thead>
<tr>
<th>ÁÆóÊ≥ï</th>
<th>ÈÄÇÁî®Âú∫ÊôØ</th>
<th>Êó∂Èó¥Â§çÊùÇÂ∫¶</th>
<th>‰ºòÁÇπ</th>
<th>Áº∫ÁÇπ</th>
</tr>
</thead>
<tbody>
<tr>
<td>Dijkstra Êú¥Á¥†Êï∞ÁªÑ</td>
<td>Â∞èËßÑÊ®°Á®†ÂØÜÂõæ (ËæπÂ§ö)</td>
<td>(O(n^2))</td>
<td>ÂÆûÁé∞ÁÆÄÂçï</td>
<td>ÂØπÁ®ÄÁñèÂõæÊÄßËÉΩËæÉÂ∑Æ</td>
</tr>
<tr>
<td>Dijkstra ‰ºòÂÖàÈòüÂàó</td>
<td>Â§ßËßÑÊ®°Á®ÄÁñèÂõæ (ËæπÂ∞ë)</td>
<td>(O((n+m)\log n))</td>
<td>ÊÄßËÉΩ‰ºòÂºÇÔºåÈÄÇÂêàÁ®ÄÁñèÂõæ</td>
<td>ÂÆûÁé∞Á®çÂ§çÊùÇ</td>
</tr>
<tr>
<td>Floyd-Warshall</td>
<td>‰ªªÊÑè‰∏§ÁÇπÁöÑÊúÄÁü≠Ë∑ØÂæÑ (Â∞èËßÑÊ®°Âõæ)</td>
<td>(O(n^3))</td>
<td>Áõ¥Êé•Ê±ÇËß£‰ªªÊÑè‰∏§ÁÇπÊúÄÁü≠Ë∑ØÂæÑÁü©Èòµ</td>
<td>‰ªÖÈÄÇÂêàÂ∞èËßÑÊ®°Âõæ (ÁÇπÂ§öËæπÂ∞ëÊó∂Âä£Âäø)</td>
</tr>
</tbody>
</table></div>
<h2 id="8ÊúÄÂ∞èÁîüÊàêÊ†ëË¥®Âõ†Êï∞ÂàÜËß£">8.ÊúÄÂ∞èÁîüÊàêÊ†ë„ÄÅË¥®Âõ†Êï∞ÂàÜËß£
</h2><h3 id="ÊúÄÂ∞èÁîüÊàêÊ†ë">ÊúÄÂ∞èÁîüÊàêÊ†ë
</h3><p>ÊúÄÂ∞èÁîüÊàêÊ†ëÔºàMSTÔºåMinimum Spanning TreeÔºâÊòØÂõæËÆ∫‰∏≠ÁöÑ‰∏Ä‰∏™ÈáçË¶ÅÈóÆÈ¢òÔºåÂÆÉÊåáÁöÑÊòØÂú®‰∏Ä‰∏™<strong>ËøûÈÄöÂä†ÊùÉÊó†ÂêëÂõæ</strong>‰∏≠ÈÄâÊã©‰∏Ä‰∫õËæπÔºå‰ΩøÂæóÔºö<strong>Âõæ‰∏≠ÊâÄÊúâËäÇÁÇπÈÉΩË¢´ËøûÊé•„ÄÇÊÄªËæπÊùÉÂíåÊúÄÂ∞è„ÄÇ‰∏ç‰ºöÂΩ¢ÊàêÁéØ„ÄÇ</strong></p>
<h4 id="Âü∫‰∫éÁÇπÁöÑÊúÄÂ∞èÁîüÊàêÊ†ëprimÁÆóÊ≥ï">Âü∫‰∫éÁÇπÁöÑÊúÄÂ∞èÁîüÊàêÊ†ëprimÁÆóÊ≥ï
</h4><p>PrimÁÆóÊ≥ïÊòØ‰∏ÄÁßçË¥™ÂøÉÁÆóÊ≥ïÔºåÂÆÉ‰ªé‰∏Ä‰∏™Ëµ∑ÂßãÁÇπÂºÄÂßãÔºå‰∏çÊñ≠Â∞ÜÊú™Âä†ÂÖ•ÁöÑÁÇπ‰ª•ÊúÄÂ∞è‰ª£‰ª∑ËøûÊé•Âà∞ÁîüÊàêÊ†ë‰∏≠ÔºåÁõ¥Âà∞ÊâÄÊúâÁÇπÈÉΩË¢´Âä†ÂÖ•„ÄÇ
ÊÄùÊÉ≥Ôºö
‰ΩøÁî®‰∏Ä‰∏™Êï∞ÁªÑ dist[] Â≠òÂÇ®ÁîüÊàêÊ†ëÂà∞ÊØè‰∏™ÁÇπÁöÑÊúÄÂ∞è‰ª£‰ª∑„ÄÇ
ÊØèÊ¨°ÈÄâÊã© dist[] ‰∏≠‰ª£‰ª∑ÊúÄÂ∞èÁöÑÁÇπÂä†ÂÖ•ÁîüÊàêÊ†ë„ÄÇ
Êõ¥Êñ∞ dist[]ÔºåË°®Á§∫ÂΩìÂâçÁîüÊàêÊ†ëÂà∞Êú™Âä†ÂÖ•ÁÇπÁöÑÊúÄÂ∞è‰ª£‰ª∑„ÄÇ
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞ÔºöÊó†‰ºòÂåñÁöÑÊú¥Á¥†prim</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="err">ÂõæÁöÑÈÇªÊé•Áü©Èòµ</span> <span class="n">graph</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="p">(</span><span class="err">Êó†ÂêëÂõæ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="err">ÊúÄÂ∞èÁîüÊàêÊ†ëÁöÑÊùÉÂÄº</span> <span class="n">sum</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">dist</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="n">INF</span><span class="p">,</span> <span class="n">INF</span><span class="p">,</span> <span class="p">...,</span> <span class="n">INF</span><span class="p">}</span> <span class="p">(</span><span class="err">ÈïøÂ∫¶‰∏∫</span> <span class="n">n</span><span class="err">ÔºåÊâÄÊúâÂÖÉÁ¥†‰∏∫Êó†Á©∑Â§ß</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">intree</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">false</span><span class="p">,</span> <span class="p">...,</span> <span class="nb">false</span><span class="p">}</span> <span class="p">(</span><span class="err">ÈïøÂ∫¶‰∏∫</span> <span class="n">n</span><span class="err">ÔºåË°®Á§∫ÁÇπÊòØÂê¶Âú®ÁîüÊàêÊ†ë‰∏≠</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">(</span><span class="err">‰ªéËäÇÁÇπ</span> <span class="mi">0</span> <span class="err">ÂºÄÂßã</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="n">Prim</span> <span class="err">ÁÆóÊ≥ï</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">(</span><span class="err">ÊúÄÂ∞èÁîüÊàêÊ†ëÁöÑÊùÉÂÄº</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">u</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">       <span class="cp"># ÊâæÂà∞Êú™Âä†ÂÖ•ÁîüÊàêÊ†ëÁöÑÁÇπ‰∏≠Ôºådist ÊúÄÂ∞èÁöÑÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>       <span class="k">for</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">           <span class="k">if</span> <span class="o">!</span><span class="n">intree</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="n">and</span> <span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="n">or</span> <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">u</span><span class="p">])</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">               <span class="n">u</span> <span class="o">=</span> <span class="n">v</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       <span class="cp"># Â∞Ü u Âä†ÂÖ•ÁîüÊàêÊ†ë
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>       <span class="k">if</span> <span class="n">dist</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="nl">INF</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="p">(</span><span class="err">Âõæ‰∏çËøûÈÄö</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="n">intree</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">       <span class="n">sum</span> <span class="o">+=</span> <span class="n">dist</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       <span class="cp"># Êõ¥Êñ∞ dist
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>       <span class="k">for</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">           <span class="k">if</span> <span class="o">!</span><span class="n">intree</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="n">and</span> <span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">               <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">ËøîÂõû</span> <span class="n">sum</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÁªôÂÆö‰∏Ä‰∏™ $n$ ‰∏™ÁÇπ„ÄÅ$m$ Êù°ËæπÁöÑÊó†ÂêëÂ∏¶ÊùÉÂõæÔºåÂõæ‰∏≠ÂèØËÉΩÂ≠òÂú®ÈáçËæπÂíåËá™ÁéØ„ÄÇÊ±ÇËØ•ÂõæÁöÑÊúÄÂ∞èÁîüÊàêÊ†ëÁöÑËæπÊùÉ‰πãÂíåÔºåËã•‰∏çÂ≠òÂú®ÊúÄÂ∞èÁîüÊàêÊ†ëÂàôËæìÂá∫ -1„ÄÇÁîüÊàêÊ†ëÔºöÂØπ‰∫é‰∏Ä‰∏™Êó†ÂêëÂõæÔºåËã•ÂÆÉÁöÑ‰∏Ä‰∏™Â≠êÂõæÊòØÂåÖÂê´ËØ•Êó†ÂêëÂõæÂÖ®ÈÉ®È°∂ÁÇπÁöÑÊ†ëÔºåÈÇ£‰πàËØ•Â≠êÂõæÊòØËØ•Êó†ÂêëÂõæÁöÑ‰∏Ä‰∏™ÁîüÊàêÊ†ë„ÄÇÊúÄÂ∞èÁîüÊàêÊ†ëÔºöÂΩìËøûÊé•È°∂ÁÇπ‰πãÈó¥ÁöÑËæπÊúâÊùÉÈáçÊó∂ÔºåÊùÉÈáç‰πãÂíåÊúÄÂ∞èÁöÑÁîüÊàêÊ†ëÂàô‰∏∫ÊúÄÂ∞èÁîüÊàêÊ†ë„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>ÔºöÁ¨¨‰∏ÄË°åÔºö‰∏§‰∏™Êï¥Êï∞ $n, m$„ÄÇ ($1 \leq n \leq 10^5, 1 \leq m \leq 10^5$)„ÄÇÊé•‰∏ãÊù• $m$ Ë°åÔºöÊØèË°å‰∏â‰∏™Êï¥Êï∞ $u_i, v_i, w_i$ÔºåË°®Á§∫ÁÇπ $u_i$ ÂíåÁÇπ $v_i$ ‰πãÈó¥Â≠òÂú®‰∏ÄÊù°ÊùÉÈáç‰∏∫ $w_i$ ÁöÑÊó†ÂêëËæπ„ÄÇ ($1 \leq u_i, v_i \leq n, 0 \leq w_i \leq 10^6$)
<strong>ËæìÂá∫ÊèèËø∞</strong>ÔºöÂÖ±‰∏ÄË°åÔºåËã•Â≠òÂú®ÊúÄÂ∞èÁîüÊàêÊ†ëÔºåÂàôËæìÂá∫‰∏Ä‰∏™Êï¥Êï∞ÔºåË°®Á§∫ÊúÄÂ∞èÁîüÊàêÊ†ëÁöÑËæπÊùÉ‰πãÂíåÔºõÂê¶ÂàôÔºåËæìÂá∫ -1„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">// aÊòØÈÇªÊé•Áü©ÈòµÔºådÊòØÂà∞iÁÇπÁöÑÊúÄÁü≠Ë∑ùÁ¶ª
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">bitset</span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">intree</span><span class="p">;</span> <span class="c1">// Ë°®Á§∫iËäÇÁÇπÊòØÂê¶ÊîæÂÖ•Ê†ëÂÜÖ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">d</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ll</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">],</span> <span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">u</span><span class="p">],</span> <span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">intree</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Ëµ∑ÂßãÁÇπ1ÔºåÂºÄÂßãÊõ¥Êñ∞‰∏çÂú®Ê†ëÂÜÖÁöÑÁÇπË∑ùÁ¶ªÊ†ëÂÜÖËµ∑ÂßãÁÇπ1ÁöÑÊúÄÁü≠Ë∑ùÁ¶ª
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">intree</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">d</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// uÊòØÊàë‰ª¨Ë¶ÅÊâæÁöÑË∑ùÁ¶ªÊ†ëÂÜÖ‰ªªÊÑè‰∏ÄÁÇπÊúÄËøëÁöÑÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">intree</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">||</span> <span class="p">(</span><span class="o">!</span><span class="n">intree</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">d</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">                <span class="n">u</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">intree</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span> <span class="c1">// Êõ¥Êñ∞ÂΩìÂâç‰∏çÂú®Ê†ëÂÜÖÁöÑÁÇπË∑ùÁ¶ªÊ†ëÂÜÖ‰ªªÊÑè‰∏ÄÁÇπÁöÑÊúÄÁü≠Ë∑ùÁ¶ª
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span><span class="n">intree</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">                <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">d</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>‰º™‰ª£Á†ÅÂÆûÁé∞ÔºöÂ†Ü‰ºòÂåñÁöÑprim
‰ΩøÁî®ÊúÄÂ∞èÂ†Ü‰ª£ÊõøÊú¥Á¥†ÁÆóÊ≥ï‰∏≠ÈÅçÂéÜ dist[] ÁöÑÊìç‰ΩúÔºåÂä†ÈÄüÊúÄÂ∞è‰ª£‰ª∑ÁÇπÁöÑÈÄâÊã©ËøáÁ®ã„ÄÇ</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="err">ÂõæÁöÑÈÇªÊé•Ë°®</span> <span class="n">graph</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="err">ÊúÄÂ∞èÁîüÊàêÊ†ëÁöÑÊùÉÂÄº</span> <span class="n">sum</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">dist</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="n">INF</span><span class="p">,</span> <span class="n">INF</span><span class="p">,</span> <span class="p">...,</span> <span class="n">INF</span><span class="p">}</span> <span class="p">(</span><span class="err">ÈïøÂ∫¶‰∏∫</span> <span class="n">n</span><span class="err">ÔºåÊâÄÊúâÂÖÉÁ¥†‰∏∫Êó†Á©∑Â§ß</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">visited</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">false</span><span class="p">,</span> <span class="p">...,</span> <span class="nb">false</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="n">dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">(</span><span class="err">‰ªéËäÇÁÇπ</span> <span class="mi">0</span> <span class="err">ÂºÄÂßã</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="err">ÂàõÂª∫ÊúÄÂ∞èÂ†Ü</span> <span class="n">pq</span><span class="err">ÔºåÊèíÂÖ•</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="err">Ê†ºÂºè‰∏∫</span> <span class="p">(</span><span class="err">‰ª£‰ª∑</span><span class="p">,</span> <span class="err">ËäÇÁÇπ</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="n">Prim</span> <span class="err">ÁÆóÊ≥ï</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">   <span class="k">while</span> <span class="n">pq</span> <span class="err">‰∏ç‰∏∫Á©∫</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="o">=</span> <span class="n">pq</span><span class="p">.</span><span class="n">top</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">       <span class="n">pq</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       <span class="cp"># Â¶ÇÊûú u Â∑≤ÁªèÂú®ÁîüÊàêÊ†ë‰∏≠ÔºåË∑≥Ëøá
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>       <span class="k">if</span> <span class="n">visited</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">:</span> <span class="k">continue</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       <span class="cp"># Â∞Ü u Âä†ÂÖ•ÁîüÊàêÊ†ë
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>       <span class="n">visited</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">       <span class="n">sum</span> <span class="o">+=</span> <span class="n">cost</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       <span class="cp"># Êõ¥Êñ∞ÈÇªÊé•ÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>       <span class="k">for</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="n">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">           <span class="k">if</span> <span class="o">!</span><span class="n">visited</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="n">and</span> <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nl">weight</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">               <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span>
</span></span><span class="line"><span class="cl">               <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">((</span><span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">v</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">ËøîÂõû</span> <span class="n">sum</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÁªôÂÆö‰∏Ä‰∏™ $n$ ‰∏™ÁÇπ„ÄÅ$m$ Êù°ËæπÁöÑÊó†ÂêëÂ∏¶ÊùÉÂõæÔºåÂõæ‰∏≠ÂèØËÉΩÂ≠òÂú®ÈáçËæπÂíåËá™ÁéØ„ÄÇÊ±ÇËØ•ÂõæÁöÑÊúÄÂ∞èÁîüÊàêÊ†ëÁöÑËæπÊùÉ‰πãÂíåÔºåËã•‰∏çÂ≠òÂú®ÊúÄÂ∞èÁîüÊàêÊ†ëÂàôËæìÂá∫ -1„ÄÇÁîüÊàêÊ†ëÔºöÂØπ‰∫é‰∏Ä‰∏™Êó†ÂêëÂõæÔºåËã•ÂÆÉÁöÑ‰∏Ä‰∏™Â≠êÂõæÊòØÂåÖÂê´ËØ•Êó†ÂêëÂõæÂÖ®ÈÉ®È°∂ÁÇπÁöÑÊ†ëÔºåÈÇ£‰πàËØ•Â≠êÂõæÊòØËØ•Êó†ÂêëÂõæÁöÑ‰∏Ä‰∏™ÁîüÊàêÊ†ë„ÄÇÊúÄÂ∞èÁîüÊàêÊ†ëÔºöÂΩìËøûÊé•È°∂ÁÇπ‰πãÈó¥ÁöÑËæπÊúâÊùÉÈáçÊó∂ÔºåÊùÉÈáç‰πãÂíåÊúÄÂ∞èÁöÑÁîüÊàêÊ†ëÂàô‰∏∫ÊúÄÂ∞èÁîüÊàêÊ†ë„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>ÔºöÁ¨¨‰∏ÄË°åÔºö‰∏§‰∏™Êï¥Êï∞ $n, m$„ÄÇ ($1 \leq n \leq 10^5, 1 \leq m \leq 10^5$)„ÄÇÊé•‰∏ãÊù• $m$ Ë°åÔºöÊØèË°å‰∏â‰∏™Êï¥Êï∞ $u_i, v_i, w_i$ÔºåË°®Á§∫ÁÇπ $u_i$ ÂíåÁÇπ $v_i$ ‰πãÈó¥Â≠òÂú®‰∏ÄÊù°ÊùÉÈáç‰∏∫ $w_i$ ÁöÑÊó†ÂêëËæπ„ÄÇ ($1 \leq u_i, v_i \leq n, 0 \leq w_i \leq 10^6$)
<strong>ËæìÂá∫ÊèèËø∞</strong>ÔºöÂÖ±‰∏ÄË°åÔºåËã•Â≠òÂú®ÊúÄÂ∞èÁîüÊàêÊ†ëÔºåÂàôËæìÂá∫‰∏Ä‰∏™Êï¥Êï∞ÔºåË°®Á§∫ÊúÄÂ∞èÁîüÊàêÊ†ëÁöÑËæπÊùÉ‰πãÂíåÔºõÂê¶ÂàôÔºåËæìÂá∫ -1„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">// dÊòØÂà∞iÁÇπÁöÑÊúÄÁü≠Ë∑ùÁ¶ª
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">struct</span> <span class="nc">Edge</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">Edge</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">)</span> <span class="k">const</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">w</span> <span class="o">==</span> <span class="n">u</span><span class="p">.</span><span class="n">w</span> <span class="o">?</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">u</span><span class="p">.</span><span class="nl">x</span> <span class="p">:</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="n">u</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">// Áî®ÁªìÊûÑ‰ΩìÊù•Â≠òÂõæ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">bitset</span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">intree</span><span class="p">;</span>  <span class="c1">// Ë°®Á§∫iËäÇÁÇπÊòØÂê¶ÊîæÂÖ•Ê†ëÂÜÖ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">d</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ll</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">u</span><span class="p">,</span> <span class="n">w</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span> <span class="n">pq</span><span class="p">;</span> <span class="c1">// Áî®‰ºòÂÖàÈòüÂàóÊù•Âà§Êñ≠Ë∑ùÁ¶ªintreeÊúÄËøëÁöÑÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">pq</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">pq</span><span class="p">.</span><span class="n">top</span><span class="p">().</span><span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">pq</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">intree</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">intree</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Êûö‰∏æÊâÄÊúâÂá∫Ëæπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">]</span> <span class="o">:</span> <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">intree</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">w</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">[</span><span class="n">y</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">d</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">intree</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">ans</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="Âü∫‰∫éËæπÁöÑÊúÄÂ∞èÁîüÊàêÊ†ëkruskalÁÆóÊ≥ï">Âü∫‰∫éËæπÁöÑÊúÄÂ∞èÁîüÊàêÊ†ëkruskalÁÆóÊ≥ï
</h4><p>KruskalÁÆóÊ≥ïÊòØ‰∏ÄÁßçÂü∫‰∫éËæπÁöÑË¥™ÂøÉÁÆóÊ≥ïÔºåÊØèÊ¨°ÈÄâÊã©ÊùÉÂÄºÊúÄÂ∞èÁöÑËæπÂä†ÂÖ•ÁîüÊàêÊ†ëÔºåÂêåÊó∂ÈÅøÂÖçÂΩ¢ÊàêÁéØ„ÄÇ
<strong>‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÁî®ÁöÑÊúÄÂ§öÁöÑÊòØkruskal</strong>
ÊÄùÊÉ≥Ôºö
Â∞ÜÊâÄÊúâËæπÊåâÊùÉÂÄºÂçáÂ∫èÊéíÂ∫è„ÄÇ
ÈÅçÂéÜÊéíÂ∫èÂêéÁöÑËæπÔºå‰ΩøÁî®<strong>Âπ∂Êü•ÈõÜ</strong>Âà§Êñ≠ÂΩìÂâçËæπÊòØÂê¶‰ºöÂΩ¢ÊàêÁéØ„ÄÇ
Â¶ÇÊûú‰∏ç‰ºöÂΩ¢ÊàêÁéØÔºåÂ∞±Â∞ÜËØ•ËæπÂä†ÂÖ•ÁîüÊàêÊ†ë„ÄÇ
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="nl">Input</span><span class="p">:</span> <span class="err">ËæπÂàóË°®</span> <span class="n">edges</span><span class="p">[]</span><span class="err">ÔºåËäÇÁÇπÊï∞</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl"><span class="nl">Output</span><span class="p">:</span> <span class="err">ÊúÄÂ∞èÁîüÊàêÊ†ëÁöÑÊùÉÂÄº</span> <span class="n">sum</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ÂàùÂßãÂåñ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="err">‰ΩøÁî®Âπ∂Êü•ÈõÜ</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">parent</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">...,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">}</span> <span class="p">(</span><span class="err">ÊØè‰∏™ÁÇπÁöÑÁà∂ËäÇÁÇπÂàùÂßãÂåñ‰∏∫Ëá™Â∑±</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="n">size</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">...,</span> <span class="mi">1</span><span class="p">}</span> <span class="p">(</span><span class="err">ÊØè‰∏™ÁÇπÊâÄÂú®ËøûÈÄöÂùóÁöÑÂ§ßÂ∞è</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="err">ÂÆö‰πâ</span> <span class="n">find</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">:</span> <span class="err">Êü•Êâæ</span> <span class="n">x</span> <span class="err">ÁöÑÊ†π</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="n">parent</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="nl">x</span><span class="p">:</span> <span class="n">parent</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">parent</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">parent</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="err">ÂÆö‰πâ</span> <span class="k">union</span><span class="err">(</span><span class="nc">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">:</span> <span class="err">ÂêàÂπ∂</span> <span class="n">x</span> <span class="err">Âíå</span> <span class="n">y</span> <span class="err">ÊâÄÂú®ËøûÈÄöÂùó</span>
</span></span><span class="line"><span class="cl">       <span class="n">root_x</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="n">root_y</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="n">root_x</span> <span class="o">!=</span> <span class="nl">root_y</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">           <span class="k">if</span> <span class="n">size</span><span class="p">[</span><span class="n">root_x</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">[</span><span class="n">root_y</span><span class="p">]</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">               <span class="n">swap</span><span class="p">(</span><span class="n">root_x</span><span class="p">,</span> <span class="n">root_y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="n">parent</span><span class="p">[</span><span class="n">root_y</span><span class="p">]</span> <span class="o">=</span> <span class="n">root_x</span>
</span></span><span class="line"><span class="cl">           <span class="n">size</span><span class="p">[</span><span class="n">root_x</span><span class="p">]</span> <span class="o">+=</span> <span class="n">size</span><span class="p">[</span><span class="n">root_y</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="n">Kruskal</span> <span class="err">ÁÆóÊ≥ï</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">(</span><span class="err">ÊúÄÂ∞èÁîüÊàêÊ†ëÁöÑÊùÉÂÄº</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">edge_count</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">(</span><span class="err">ÁîüÊàêÊ†ë‰∏≠ËæπÁöÑÊï∞Èáè</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="err">Â∞Ü</span> <span class="n">edges</span><span class="p">[]</span> <span class="err">ÊåâÊùÉÂÄºÂçáÂ∫èÊéíÂ∫è</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="n">in</span> <span class="nl">edges</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">!=</span> <span class="n">find</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">           <span class="k">union</span><span class="err">(</span><span class="nc">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">           <span class="n">sum</span> <span class="o">+=</span> <span class="n">weight</span>
</span></span><span class="line"><span class="cl">           <span class="n">edge_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">           <span class="k">if</span> <span class="n">edge_count</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">               <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">Â¶ÇÊûú</span> <span class="n">edge_count</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="p">(</span><span class="err">Âõæ‰∏çËøûÈÄö</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="err">Âê¶Âàô</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">sum</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÁªôÂÆö‰∏Ä‰∏™ $n$ ‰∏™ÁÇπ„ÄÅ$m$ Êù°ËæπÁöÑÊó†ÂêëÂ∏¶ÊùÉÂõæÔºåÂõæ‰∏≠ÂèØËÉΩÂ≠òÂú®ÈáçËæπÂíåËá™ÁéØ„ÄÇÊ±ÇËØ•ÂõæÁöÑÊúÄÂ∞èÁîüÊàêÊ†ëÁöÑËæπÊùÉ‰πãÂíåÔºåËã•‰∏çÂ≠òÂú®ÊúÄÂ∞èÁîüÊàêÊ†ëÂàôËæìÂá∫ -1„ÄÇÁîüÊàêÊ†ëÔºöÂØπ‰∫é‰∏Ä‰∏™Êó†ÂêëÂõæÔºåËã•ÂÆÉÁöÑ‰∏Ä‰∏™Â≠êÂõæÊòØÂåÖÂê´ËØ•Êó†ÂêëÂõæÂÖ®ÈÉ®È°∂ÁÇπÁöÑÊ†ëÔºåÈÇ£‰πàËØ•Â≠êÂõæÊòØËØ•Êó†ÂêëÂõæÁöÑ‰∏Ä‰∏™ÁîüÊàêÊ†ë„ÄÇÊúÄÂ∞èÁîüÊàêÊ†ëÔºöÂΩìËøûÊé•È°∂ÁÇπ‰πãÈó¥ÁöÑËæπÊúâÊùÉÈáçÊó∂ÔºåÊùÉÈáç‰πãÂíåÊúÄÂ∞èÁöÑÁîüÊàêÊ†ëÂàô‰∏∫ÊúÄÂ∞èÁîüÊàêÊ†ë„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>ÔºöÁ¨¨‰∏ÄË°åÔºö‰∏§‰∏™Êï¥Êï∞ $n, m$„ÄÇ ($1 \leq n \leq 10^5, 1 \leq m \leq 10^5$)„ÄÇÊé•‰∏ãÊù• $m$ Ë°åÔºöÊØèË°å‰∏â‰∏™Êï¥Êï∞ $u_i, v_i, w_i$ÔºåË°®Á§∫ÁÇπ $u_i$ ÂíåÁÇπ $v_i$ ‰πãÈó¥Â≠òÂú®‰∏ÄÊù°ÊùÉÈáç‰∏∫ $w_i$ ÁöÑÊó†ÂêëËæπ„ÄÇ ($1 \leq u_i, v_i \leq n, 0 \leq w_i \leq 10^6$)
<strong>ËæìÂá∫ÊèèËø∞</strong>ÔºöÂÖ±‰∏ÄË°åÔºåËã•Â≠òÂú®ÊúÄÂ∞èÁîüÊàêÊ†ëÔºåÂàôËæìÂá∫‰∏Ä‰∏™Êï¥Êï∞ÔºåË°®Á§∫ÊúÄÂ∞èÁîüÊàêÊ†ëÁöÑËæπÊùÉ‰πãÂíåÔºõÂê¶ÂàôÔºåËæìÂá∫ -1„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">// dÊòØÂà∞iÁÇπÁöÑÊúÄÁü≠Ë∑ùÁ¶ª
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">struct</span> <span class="nc">Edge</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">Edge</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">)</span> <span class="k">const</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">w</span> <span class="o">!=</span> <span class="n">m</span><span class="p">.</span><span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">w</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">!=</span> <span class="n">m</span><span class="p">.</span><span class="n">u</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">u</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">.</span><span class="n">u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">.</span><span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">pre</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">root</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">pre</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pre</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span> <span class="o">?</span> <span class="nl">x</span> <span class="p">:</span> <span class="n">root</span><span class="p">(</span><span class="n">pre</span><span class="p">[</span><span class="n">x</span><span class="p">]));</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">d</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span> <span class="n">es</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ll</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">es</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">sort</span><span class="p">(</span><span class="n">es</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">es</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">pre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// Âπ∂Êü•ÈõÜÂàùÂßãÂåñ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">]</span> <span class="o">:</span> <span class="n">es</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">root</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">==</span> <span class="n">root</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span> <span class="o">+=</span> <span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">pre</span><span class="p">[</span><span class="n">root</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">root</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">!=</span> <span class="n">root</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">ans</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="Ë¥®Âõ†Êï∞ÂàÜËß£">Ë¥®Âõ†Êï∞ÂàÜËß£
</h3><h4 id="Ë¥®Êï∞Á¥†Êï∞Âà§Êñ≠">Ë¥®Êï∞ÔºàÁ¥†Êï∞ÔºâÂà§Êñ≠
</h4><p><strong>Ê®°Êùø</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">;</span><span class="c1">//ÂæÖÂà§Êñ≠ÁõÆÊ†á
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">checkPrime</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="Ê±ÇnÁöÑÊâÄÊúâÂõ†Êï∞">Ê±ÇNÁöÑÊâÄÊúâÂõ†Êï∞
</h4><p>ÂàÜÊûêÔºöËÆæa,bÊòØNÁöÑÂõ†Â≠êÂàô
[ N = a \times b \quad (ËÆæa \leq b) ]
ÊâÄ‰ª•Ôºö
[ a \leq \sqrt{N} \leq b ]
Âàô‰ª§Ôºö
[b = \frac{N}{a} ]
Êûö‰∏æaÂç≥ÂèØ
<strong>Ê®°ÊùøÈ¢ò</strong>
egÔºö<strong>È¢òÁõÆÊèèËø∞</strong>Ôºö
ÁªôÂÆö‰∏Ä‰∏™Êï∞Â≠ó $n$ÔºåËØ∑‰ªéÂ∞èÂà∞Â§ßËæìÂá∫ $n$ ÁöÑÊâÄÊúâÂõ†Â≠ê„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>Ôºö‰∏Ä‰∏™Êï¥Êï∞ $n$„ÄÇ ($1 \leq n \leq 10^{12}$)
<strong>ËæìÂá∫ÊèèËø∞</strong>Ôºö‰∏ÄË°å‰ªéÂ∞èÂà∞Â§ßËæìÂá∫ $n$ ÁöÑÊâÄÊúâÂõ†Â≠ê„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="n">ll</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">v</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">v</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">sort</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">v</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="nl">i</span> <span class="p">:</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="Ê±ÇnÁöÑÊâÄÊúâË¥®Âõ†Â≠ê">Ê±ÇNÁöÑÊâÄÊúâË¥®Âõ†Â≠ê
</h4><p><strong>Ê®°ÊùøÈ¢ò</strong>
egÔºö<strong>È¢òÁõÆÊèèËø∞</strong>Ôºö
ÁªôÂÆö‰∏Ä‰∏™Êï∞Â≠ó $n$ÔºåËØ∑‰ªéÂ∞èÂà∞Â§ßËæìÂá∫ $n$ ÁöÑÊâÄÊúâË¥®Âõ†Â≠ê„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>Ôºö‰∏Ä‰∏™Êï¥Êï∞ $n$„ÄÇ ($1 \leq n \leq 10^{12}$)
<strong>ËæìÂá∫ÊèèËø∞</strong>Ôºö‰∏ÄË°å‰ªéÂ∞èÂà∞Â§ßËæìÂá∫ $n$ ÁöÑÊâÄÊúâË¥®Âõ†Â≠ê„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="n">ll</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">v</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">n</span> <span class="o">/=</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// Â∞ÜiÈô§Âπ≤ÂáÄ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">v</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">sort</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">v</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="nl">i</span> <span class="p">:</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="9ÂüÉÊ∞èÁ≠õÊ≥ïgcdÂíålcmÂø´ÈÄüÂπÇ‰πòÊ≥ïÈÄÜÂÖÉ">9.ÂüÉÊ∞èÁ≠õÊ≥ï„ÄÅgcdÂíålcm„ÄÅÂø´ÈÄüÂπÇ„ÄÅ‰πòÊ≥ïÈÄÜÂÖÉ
</h2><h3 id="ÂüÉÊ∞èÁ≠õÊ≥ï">ÂüÉÊ∞èÁ≠õÊ≥ï
</h3><p>ÂüÉÊ∞èÁ≠õÊ≥ïÔºàSieve of EratosthenesÔºâÊòØ‰∏ÄÁßçÈ´òÊïàËÆ°ÁÆóËåÉÂõ¥ÂÜÖÊâÄÊúâÁ¥†Êï∞ÁöÑÁªèÂÖ∏ÁÆóÊ≥ï„ÄÇÂÖ∂Âü∫Êú¨ÊÄùÊÉ≥ÊòØÈÄöËøá<strong>Ê†áËÆ∞ÂêàÊï∞</strong>Êù•Á≠õÈÄâÂá∫Á¥†Êï∞ÔºåÁî®‰∫é<strong>ÊâæÂá∫‰∏Ä‰∏™ÊåáÂÆöÊï¥Êï∞ËåÉÂõ¥ÂÜÖÁöÑÊâÄÊúâÁ¥†Êï∞</strong>„ÄÇËøô‰∏™ÁÆóÊ≥ïÁöÑÂü∫Êú¨ÊÄùÊÉ≥ÊòØÔºö<strong>‰ªéÊúÄÂ∞èÁöÑÁ¥†Êï∞2ÂºÄÂßãÔºåÈÄêÊ≠•Ê†áËÆ∞ÂÖ∂ÂÄçÊï∞‰∏∫ÈùûÁ¥†Êï∞ÔºåÁÑ∂ÂêéÊâæÂà∞‰∏ã‰∏Ä‰∏™Êú™Ë¢´Ê†áËÆ∞ÁöÑÊï∞ÔºåÁªßÁª≠Ê†áËÆ∞ÂÖ∂ÂÄçÊï∞‰∏∫ÈùûÁ¥†Êï∞ÔºåÂ¶ÇÊ≠§ÂèçÂ§çÔºåÁõ¥Âà∞Â§ÑÁêÜÂÆåÊâÄÊúâÂ∞è‰∫éÊàñÁ≠â‰∫éÁªôÂÆöÊï∞ÁöÑÂπ≥ÊñπÊ†πÁöÑÊï∞</strong>„ÄÇ
ÂüÉÊ∞èÁ≠õÊ≥ïÁöÑÊ≠•È™§Ôºö
ÂàõÂª∫‰∏Ä‰∏™ÂàóË°®ÔºöÂåÖÂê´‰ªé2Âà∞nÁöÑÊâÄÊúâÊï¥Êï∞ÔºåÂÖ∂‰∏≠nÊòØË¶ÅÊâæÂá∫Á¥†Êï∞ÁöÑËåÉÂõ¥„ÄÇ
ÂàùÂßãÂåñÔºöÂ∞Ü2Ê†áËÆ∞‰∏∫Á¥†Êï∞„ÄÇ
Á≠õÈÄâÔºö‰ªé2ÁöÑ‰∏ã‰∏Ä‰∏™Êï∞ÂºÄÂßãÔºåÂ¶ÇÊûúËØ•Êï∞Êú™Ë¢´Ê†áËÆ∞‰∏∫ÈùûÁ¥†Êï∞ÔºåÂàôÂ∞ÜÂÖ∂Ê†áËÆ∞‰∏∫Á¥†Êï∞ÔºåÂπ∂Â∞ÜÂÖ∂ÊâÄÊúâÂÄçÊï∞Ê†áËÆ∞‰∏∫ÈùûÁ¥†Êï∞„ÄÇ
ÈáçÂ§çÔºöÈáçÂ§çÊ≠•È™§3ÔºåÁõ¥Âà∞Â§ÑÁêÜÂÆåÊâÄÊúâÂ∞è‰∫éÊàñÁ≠â‰∫énÁöÑÂπ≥ÊñπÊ†πÁöÑÊï∞„ÄÇ
ËæìÂá∫ÔºöÊâÄÊúâÊú™Ë¢´Ê†áËÆ∞‰∏∫ÈùûÁ¥†Êï∞ÁöÑÊï∞Âç≥‰∏∫Á¥†Êï∞„ÄÇ
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong>Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="err">ÂüÉÊ∞èÁ≠õÊ≥ï</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="cp"># ÂàõÂª∫‰∏Ä‰∏™Â∏ÉÂ∞îÊï∞ÁªÑÔºåÈïøÂ∫¶‰∏∫ n+1
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>    <span class="err">ÂàùÂßãÂåñÂ∏ÉÂ∞îÊï∞ÁªÑ</span> <span class="n">is_prime</span><span class="p">[</span><span class="mf">0.</span><span class="p">.</span><span class="n">n</span><span class="p">]</span> <span class="err">‰∏∫</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cp"># 0 Âíå 1 ‰∏çÊòØÁ¥†Êï∞
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>    <span class="n">is_prime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span>
</span></span><span class="line"><span class="cl">    <span class="n">is_prime</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cp"># ‰ªé 2 ÂºÄÂßãÔºåÈÄêÊ≠•Á≠õÈÄâ
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>    <span class="k">for</span> <span class="n">i</span> <span class="err">‰ªé</span> <span class="mi">2</span> <span class="err">Âà∞</span> <span class="err">‚àö</span><span class="nl">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="err">Â¶ÇÊûú</span> <span class="n">is_prime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="err">‰∏∫</span> <span class="nb">true</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="cp"># Â∞Ü i ÁöÑÊâÄÊúâÂÄçÊï∞Ê†áËÆ∞‰∏∫ÈùûÁ¥†Êï∞
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>            <span class="k">for</span> <span class="n">j</span> <span class="err">‰ªé</span> <span class="n">i</span><span class="o">*</span><span class="n">i</span> <span class="err">Âà∞</span> <span class="n">n</span><span class="err">ÔºåÊ≠•Èïø‰∏∫</span> <span class="nl">i</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">is_prime</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cp"># ÈÅçÂéÜÂ∏ÉÂ∞îÊï∞ÁªÑÔºåËæìÂá∫ÊâÄÊúâÁ¥†Êï∞
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>    <span class="k">for</span> <span class="n">k</span> <span class="err">‰ªé</span> <span class="mi">2</span> <span class="err">Âà∞</span> <span class="nl">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="err">Â¶ÇÊûú</span> <span class="n">is_prime</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="err">‰∏∫</span> <span class="nb">true</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="err">ËæìÂá∫</span> <span class="n">k</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Ê®°ÊùøÈ¢ò</strong>
eg:<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏Ä‰∏™Êï¥Êï∞ $n$ÔºåÊ±Ç $[1, n]$ ÁöÑÊâÄÊúâË¥®Êï∞„ÄÇ
<strong>ËæìÂÖ•Ê†ºÂºè</strong>:‰∏Ä‰∏™Êï¥Êï∞ $n$„ÄÇ ($1 \leq n \leq 2 \times 10^6$)
<strong>ËæìÂá∫Ê†ºÂºè</strong>ÊåâÁÖß‰ªéÂ∞èÂà∞Â§ßÁöÑÈ°∫Â∫èËæìÂá∫Á≠îÊ°à„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e6</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">bitset</span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">vis</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">vis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="n">ll</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="p">(</span><span class="n">ll</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">+=</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">vis</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="gcdÂíålcm">gcdÂíålcm
</h3><p>ÁêÜËÆ∫Âü∫Á°ÄÔºö
<strong>ÂîØ‰∏ÄÂàÜËß£ÂÆöÁêÜ</strong>Ôºå‰πüÁß∞‰∏∫ÁÆóÊúØÂü∫Êú¨ÂÆöÁêÜÔºåÊòØÊï∞ËÆ∫‰∏≠ÁöÑ‰∏Ä‰∏™Âü∫Êú¨ÂÆöÁêÜ„ÄÇÂÆÉÊåáÂá∫Ôºå‰ªª‰Ωï‰∏Ä‰∏™Â§ß‰∫é1ÁöÑËá™ÁÑ∂Êï∞ n ÈÉΩÂèØ‰ª•ÂÜôÊàêÁ¥†Êï∞ÁöÑ‰πòÁßØÂΩ¢ÂºèÔºåÂπ∂‰∏îËøôÁßçÂàÜËß£ÊñπÂºèÊòØÂîØ‰∏ÄÁöÑÔºå‰∏çËÄÉËôëÂõ†Â≠êÁöÑÈ°∫Â∫è„ÄÇ
<strong>GCD‰∏éÂîØ‰∏ÄÂàÜËß£ÂÆöÁêÜ</strong>
ÊúÄÂ§ßÂÖ¨Á∫¶Êï∞ÊòØ‰∏§‰∏™ÊàñÂ§ö‰∏™Êï¥Êï∞ÂÖ±ÊúâÁöÑÊúÄÂ§ßÁöÑËÉΩÊï¥Èô§ÂÆÉ‰ª¨ÁöÑÊ≠£Êï¥Êï∞„ÄÇÊ†πÊçÆÂîØ‰∏ÄÂàÜËß£ÂÆöÁêÜÔºå‰ªª‰ΩïÊï¥Êï∞ÈÉΩÂèØ‰ª•ÂîØ‰∏ÄÂú∞ÂàÜËß£‰∏∫Á¥†Êï∞ÁöÑ‰πòÁßØ„ÄÇÂõ†Ê≠§Ôºå‰∏§‰∏™Êï∞ÁöÑGCDÂèØ‰ª•ÈÄöËøáÊØîËæÉÂÆÉ‰ª¨ÁöÑÁ¥†Âõ†Â≠êÊù•Á°ÆÂÆöÔºö</p>
<ol>
<li>ÂàÜËß£ÔºöÂ∞Ü‰∏§‰∏™Êï∞ÂàÜÂà´ÂàÜËß£‰∏∫Á¥†Êï∞ÁöÑ‰πòÁßØ„ÄÇ</li>
<li>ÂÖ¨ÂÖ±Á¥†Âõ†Â≠êÔºöÊâæÂá∫‰∏§‰∏™ÂàÜËß£‰∏≠Áõ∏ÂêåÁöÑÁ¥†Âõ†Â≠ê„ÄÇ</li>
<li>ËÆ°ÁÆóGCDÔºöÂ∞ÜËøô‰∫õ<strong>ÂÖ¨ÂÖ±Á¥†Âõ†Â≠ê</strong>ÁöÑÊåáÊï∞Âèñ<strong>ÊúÄÂ∞èÂÄº</strong>ÔºåÁÑ∂ÂêéÂ∞ÜÂÆÉ‰ª¨Áõ∏‰πò„ÄÇ
<strong>LCM‰∏éÂîØ‰∏ÄÂàÜËß£ÂÆöÁêÜ</strong>
ÊúÄÂ∞èÂÖ¨ÂÄçÊï∞ÊòØ‰∏§‰∏™ÊàñÂ§ö‰∏™Êï¥Êï∞ÁöÑÊúÄÂ∞èÁöÑÂÖ¨ÂÖ±ÂÄçÊï∞„ÄÇÂà©Áî®ÂîØ‰∏ÄÂàÜËß£ÂÆöÁêÜÔºåÊàë‰ª¨ÂèØ‰ª•Á±ª‰ººÂú∞ËÆ°ÁÆóLCMÔºö</li>
<li>ÂàÜËß£ÔºöÂ∞Ü‰∏§‰∏™Êï∞ÂàÜÂà´ÂàÜËß£‰∏∫Á¥†Êï∞ÁöÑ‰πòÁßØ„ÄÇ</li>
<li>ÂÖ¨ÂÖ±Á¥†Âõ†Â≠êÂíåÁã¨ÊúâÁ¥†Âõ†Â≠êÔºöÊâæÂá∫‰∏§‰∏™ÂàÜËß£‰∏≠Áõ∏ÂêåÁöÑÁ¥†Âõ†Â≠êÂíå‰∏çÂêåÁöÑÁ¥†Âõ†Â≠ê„ÄÇ</li>
<li>ËÆ°ÁÆóLCMÔºöÂ∞ÜÊâÄÊúâÁ¥†Âõ†Â≠êÁöÑ<strong>ÊúÄÈ´òÊåáÊï∞</strong>Áõ∏‰πò„ÄÇ
<strong>Ê¨ßÂá†ÈáåÂæóÁÆóÊ≥ï</strong>
ÁªôÂÆö‰∏§‰∏™Ê≠£Êï¥Êï∞ $a, b \in \mathbb{N}$Ôºå‰∏î $a \leq b$ÔºåÂàôÂÆÉ‰ª¨ÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞ÂèØ‰ª•Ë°®Á§∫‰∏∫Ôºö
<strong>$$ \gcd(a, b) = \gcd(a, b - a) $$</strong>
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞(gcdÁöÑÂéüÁêÜ/ÊâãÂÜôgcdÂáΩÊï∞)</strong></li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">function</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span> <span class="k">return</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="nl">a</span> <span class="p">:</span> <span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="p">);</span> <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Ê≥®Ôºöc++Â∫ìÂáΩÊï∞ÈáåÊúâ__gcd(a,b)ÂáΩÊï∞ Âç≥‰∏äËø∞ÂÆûÁé∞</strong>
<strong>Ë¥ùÁ•ñÁ≠âÂºè</strong>:
ÂÆÉË°®Êòé‰∏§‰∏™Êï¥Êï∞ (a) Âíå (b) ÁöÑ‰πòÁßØÁ≠â‰∫éÂÆÉ‰ª¨ÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞ÔºàGCDÔºâÂíåÊúÄÂ∞èÂÖ¨ÂÄçÊï∞ÔºàLCMÔºâÁöÑ‰πòÁßØÔºåËøô‰∏™ÊÄßË¥®ÂèØ‰ª•Áî®‰ª•‰∏ãÁöÑÊï∞Â≠¶ÂÖ¨ÂºèË°®Á§∫Ôºö
<strong>[ a \times b = \gcd(a, b) \times \text{lcm}(a, b) ]</strong>
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞ÔºàlcmÁöÑÂéüÁêÜ/ÊâãÂÜôlcmÂáΩÊï∞Ôºâ</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">function</span> <span class="nf">lcm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">__gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span><span class="p">;</span> <span class="p">}</span>   
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÁªôÂÆö‰∏§‰∏™Ê≠£Êï¥Êï∞ $a, b$ÔºåÊ±Ç $gcd(a, b)$ Âíå $lcm(a, b)$„ÄÇ$gcd(a, b)$ Ë°®Á§∫ $a, b$ ÁöÑÊúÄÂ§ßÂÖ¨Âõ†Êï∞„ÄÇ$lcm(a, b)$ Ë°®Á§∫ $a, b$ ÁöÑÊúÄÂ∞èÂÖ¨ÂÄçÊï∞„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>ÔºöÁ¨¨‰∏ÄË°åËæìÂÖ•‰∏Ä‰∏™Êï¥Êï∞ $T$ÔºåË°®Á§∫Ê†∑‰æãÁöÑ‰∏™Êï∞„ÄÇ ($1 \leq T \leq 10^5$)„ÄÇÂØπ‰∫éÊØè‰∏™Ê†∑‰æãÔºå‰∏§‰∏™Êï¥Êï∞ $a, b$„ÄÇ ($1 \leq a, b \leq 2 \times 10^9$)
<strong>ËæìÂá∫ÊèèËø∞</strong>ÔºöÂØπ‰∫éÊØè‰∏Ä‰∏™Ê†∑‰æãÔºåÂú®‰∏ÄË°åËæìÂá∫‰∏§‰∏™Êï¥Êï∞Ë°®Á§∫ $gcd$ Âíå $lcm$„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="nl">a</span> <span class="p">:</span> <span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="nf">lcm</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span> <span class="o">&lt;&lt;</span> <span class="n">lcm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="Âø´ÈÄüÂπÇ">Âø´ÈÄüÂπÇ
</h3><p>Âø´ÈÄüÂπÇÔºà‰πüÁß∞‰∏∫Âø´ÈÄüÊåáÊï∞ÊàñÂπÇËøêÁÆóÔºâÊòØ‰∏ÄÁßçÁî®‰∫éÈ´òÊïàËÆ°ÁÆóÊåáÊï∞ËøêÁÆóÁöÑÁÆóÊ≥ïÔºåÂÖ∂‰∏≠ a ÊòØÂ∫ïÊï∞Ôºåb ÊòØÊåáÊï∞„ÄÇËøô‰∏™ÁÆóÊ≥ïÁâπÂà´ÈÄÇÁî®‰∫éÊåáÊï∞ b ÈùûÂ∏∏Â§ßÊó∂ÁöÑÊÉÖÂÜµ„ÄÇÂø´ÈÄüÂπÇÁÆóÊ≥ïÂà©Áî®‰∫ÜÊåáÊï∞ÁöÑ‰∫åËøõÂà∂Ë°®Á§∫ÔºåÈÄöËøáÂ∞ÜÊåáÊï∞ÂàÜËß£‰∏∫2ÁöÑÂπÇÁöÑÂíåÔºå‰ªéËÄåÂáèÂ∞ë‰πòÊ≥ïÁöÑÊ¨°Êï∞„ÄÇ
<strong>Âø´ÈÄüÂπÇÁÆóÊ≥ïÁöÑÂéüÁêÜ</strong>
Âø´ÈÄüÂπÇÁÆóÊ≥ïÂü∫‰∫é‰ª•‰∏ãÊï∞Â≠¶ÂéüÁêÜÔºö</p>
<ol>
<li>ÊåáÊï∞ÂàÜËß£Ôºö‰ªª‰ΩïÊ≠£Êï¥Êï∞ $b$ ÈÉΩÂèØ‰ª•Ë°®Á§∫‰∏∫ 2 ÁöÑÂπÇÁöÑÂíåÔºåÂç≥ $b = 2^0 + 2^1 + 2^2 + \ldots + 2^k$„ÄÇ</li>
<li>ÂπÇÁöÑ‰πòÊ≥ïÔºö $a^b = a^{2^0} \times a^{2^1} \times a^{2^2} \times \ldots \times a^{2^k}$„ÄÇ</li>
</ol>
<p><strong>Ê≠•È™§</strong></p>
<ol>
<li>ÂàùÂßãÂåñÁªìÊûúÔºö $res = 1$„ÄÇ</li>
<li>Âπ≥ÊñπÂíå‰πòÊ≥ïÔºöÂΩì $b &gt; 0$ Êó∂ÔºåÊâßË°å‰ª•‰∏ãÊ≠•È™§Ôºö
<ul>
<li>Â¶ÇÊûú $b$ ÊòØÂ•áÊï∞ÔºåÂ∞ÜÂΩìÂâçÁöÑ $a$ ÂÄº‰πò‰ª•ÁªìÊûú $res$„ÄÇ</li>
<li>Â∞Ü $a$ Âπ≥ÊñπÔºàÂç≥ $a = a \times a$Ôºâ„ÄÇ</li>
<li>Â∞Ü $b$ Âè≥Áßª‰∏Ä‰ΩçÔºàÂç≥ $b = b / 2$Ôºâ„ÄÇ</li>
</ul>
</li>
</ol>
<p><strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">fast_pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">b</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">*</span> <span class="n">a</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">a</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">/</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÊú¨È¢òÊúâ $T$ ÁªÑÊµãËØïÊ†∑‰æã„ÄÇÁªôÂÆö‰∏â‰∏™Êï¥Êï∞ $a, b, c$ÔºåÊ±ÇÔºö
[ a^b \mod c ]
<strong>ËæìÂÖ•Ê†ºÂºè</strong>ÔºöÁ¨¨‰∏ÄË°åËæìÂÖ•‰∏Ä‰∏™Êï¥Êï∞ $T$„ÄÇ ($1 \leq T \leq 1000$)
ÂØπ‰∫éÊØèÁªÑÊ†∑‰æã‰∏ÄË°åÁªôÂá∫‰∏â‰∏™Êï¥Êï∞ $a, b, c$„ÄÇ ($1 \leq a, b, c \leq 10^9$)
<strong>ËæìÂá∫Ê†ºÂºè</strong>Ôºö‰∏Ä‰∏™Êï¥Êï∞Ë°®Á§∫Á≠îÊ°à„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e9</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="nf">fast_pow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">,</span> <span class="n">ll</span> <span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span> <span class="o">*=</span> <span class="n">a</span> <span class="o">%</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">*=</span> <span class="n">a</span> <span class="o">%</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="c1">// ËøôÈÉ®ÂàÜÂÖ∂ÂÆûÂíå‰º™‰ª£Á†ÅÊòØÁõ∏ÂêåËØ≠‰πâ Âè™ÊòØ‰ΩçËøêÁÆóÊõ¥Âø´‰∏ÄÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">fast_pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="‰πòÊ≥ïÈÄÜÂÖÉ">‰πòÊ≥ïÈÄÜÂÖÉ
</h3><p><strong>ÁúãÂà∞ÂèñÊ®°Â∞±ÊúâÂèØËÉΩÁî®ÈÄÜÂÖÉ Áî®Êù•ÊéßÂà∂Êï∞ÊçÆËßÑÊ®°</strong>
ÁêÜËÆ∫Âü∫Á°ÄÔºö
‰πòÊ≥ïÈÄÜÂÖÉÊòØÊï∞ËÆ∫‰∏≠ÁöÑ‰∏Ä‰∏™Ê¶ÇÂøµÔºåÊåáÁöÑÊòØÂú®Ê®°ËøêÁÆó‰∏≠Ôºå‰∏Ä‰∏™Êï∞ $a$ ÁöÑ‰πòÊ≥ïÈÄÜÂÖÉÊòØ‰∏Ä‰∏™Êï∞ $b$Ôºå‰ΩøÂæó $a \times b \mod{m}\equiv 1 $„ÄÇÊç¢Âè•ËØùËØ¥Ôºå$b$ ÊòØ $a$ Âú®Ê®° $m$ ‰∏ãÁöÑÈÄÜÔºåÂΩì‰∏î‰ªÖÂΩì $a$ Âíå $b$ ÁöÑ‰πòÁßØÂØπ $m$ ÂèñÊ®°ÂêéÁ≠â‰∫é 1„ÄÇ
<strong>Ë¥πÈ©¨Â∞èÂÆöÁêÜ</strong>
Ë¥πÈ©¨Â∞èÂÆöÁêÜÊåáÂá∫ÔºåÂ¶ÇÊûú $p$ ÊòØ‰∏Ä‰∏™Ë¥®Êï∞Ôºå$a$ ÊòØ‰∏Ä‰∏™Êï¥Êï∞Ôºå(<strong>pÊòØË¥®Êï∞‰∏îa‰∏çÊòØpÁöÑÂÄçÊï∞</strong>)Âπ∂‰∏î $a$ ‰∏çËÉΩË¢´ $p$ Êï¥Èô§ÔºåÈÇ£‰πà $a^{p-1} \equiv 1 \pmod{p}$„ÄÇËøô‰∏™ÂÆöÁêÜÂèØ‰ª•Êé®ÂπøÂà∞ $a^p \equiv a \pmod{p}$„ÄÇ
<strong>Ë¥πÈ©¨Â∞èÂÆöÁêÜ‰∏é‰πòÊ≥ïÈÄÜÂÖÉÁöÑÂÖ≥Á≥ª</strong>
Ê†πÊçÆË¥πÈ©¨Â∞èÂÆöÁêÜÔºåÊàë‰ª¨ÂèØ‰ª•ÂæóÂá∫ $a^{p-2} \equiv a^{-1} \pmod{p}$ÔºåËøôÊÑèÂë≥ÁùÄ $a^{p-2}$ ÂÆûÈôÖ‰∏äÊòØ $a$ Ê®° $p$ ÁöÑ‰πòÊ≥ïÈÄÜÂÖÉ„ÄÇÂõ†Ê≠§ÔºåÂ¶ÇÊûú $p$ ÊòØË¥®Êï∞Ôºå‰∏î $a$ ‰∏çËÉΩË¢´ $p$ Êï¥Èô§ÔºåÈÇ£‰πà $a$ Ê®° $p$ ÁöÑ‰πòÊ≥ïÈÄÜÂÖÉÂ∞±ÊòØ $a^{p-2}$„ÄÇËÄå $a^{p-2}$ÂèØ‰ª•ÈÄöËøá‰πãÂâçÂ≠¶‰π†ËøáÁöÑÂø´ÈÄüÂπÇÊù•Ê±ÇÂæó„ÄÇ
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞ÔºöË¥πÈ©¨Â∞èÂÆöÁêÜÊ±ÇÈÄÜÂÖÉ</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">mod_inverse</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s">&#34;No inverse exists&#34;</span>  <span class="c1">// a Âíå p ‰∏ç‰∫íË¥®ÔºåÊ≤°ÊúâÈÄÜÂÖÉ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">else</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">fast_pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>  <span class="c1">// ‰ΩøÁî®Âø´ÈÄüÂπÇÁÆóÊ≥ïËÆ°ÁÆó a^(p-2) mod p 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>egÔºö
<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÁªôÂÆö‰∏Ä‰∏™ÂáΩÊï∞ÂΩ¢Âºè:[ f(x) = \frac{ax + b}{cx} ]
Êú¨È¢òÊúâ $T$ ÁªÑÊµãËØïÊ†∑‰æãÔºåÂØπ‰∫éÊØèÁªÑÊ†∑‰æãÔºöÁªôÂÆö‰∏â‰∏™Êï¥Êï∞Ë°®Á§∫ $a, b, c$ Áî®‰∫éÁ°ÆÂÆöÂáΩÊï∞ÔºåÁÑ∂ÂêéÊúâ $q$ Ê¨°ËØ¢ÈóÆÔºåÊØèÊ¨°ËØ¢ÈóÆ‰∏Ä‰∏™ÁÇπÁöÑÂáΩÊï∞ÂÄº„ÄÇÁªìÊûúÂØπ 998244353 ÂèñÊ®°„ÄÇ
<strong>ËæìÂÖ•Ê†ºÂºè</strong>ÔºöÁ¨¨‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞ $T$ÔºåË°®Á§∫Ê†∑‰æãÊï∞„ÄÇ ($1 \leq T \leq 10$)„ÄÇÂØπ‰∫éÊØè‰∏™Ê†∑‰æãÔºöÁ¨¨‰∏ÄË°åÂõõ‰∏™Êï¥Êï∞ $a, b, c, q$„ÄÇ ($1 \leq a, b, c \leq 10^9, 1 \leq q \leq 10^4$)„ÄÇÊé•‰∏ãÊù• $q$ Ë°åÔºåÊØèË°å‰∏Ä‰∏™Êï¥Êï∞Ë°®Á§∫ËØ¢ÈóÆÁÇπ $x_i$„ÄÇ ($1 \leq x \leq 10^9$)
<strong>ËæìÂá∫Ê†ºÂºè</strong>ÔºöÂØπ‰∫éÊØèÊ¨°ËØ¢ÈóÆÔºå‰∏Ä‰∏™Êï¥Êï∞Ë°®Á§∫ÂèñÊ®°ÂêéÁöÑÁªìÊûú„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e9</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">ll</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">998244353</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="nf">fast_pow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">*</span> <span class="n">a</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="nf">inv</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">)</span> <span class="c1">// Ë¥πÈ©¨Â∞èÂÆöÁêÜÊ±ÇÈÄÜÂÖÉ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">fast_pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="nf">f</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">,</span> <span class="n">ll</span> <span class="n">c</span><span class="p">,</span> <span class="n">ll</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">%</span> <span class="n">p</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span> <span class="o">*</span> <span class="n">inv</span><span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">x</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//%pÊòØ‰∏∫‰∫ÜÁº©Â∞èÊï∞ÊçÆÈáè Ëã•‰∏çÊ®°Â∑≤ÁªèÂà∞1e18‰∫Ü ËÄåÂú®Êï∞Â≠¶ËßíÂ∫¶‰∏äÂØπ‰∫é
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ll</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="10ÁªÑÂêàÊï∞01ËÉåÂåÖÂÆåÂÖ®ËÉåÂåÖ">10.ÁªÑÂêàÊï∞„ÄÅ01ËÉåÂåÖ„ÄÅÂÆåÂÖ®ËÉåÂåÖ
</h2><h3 id="ÁªÑÂêàÊï∞">ÁªÑÂêàÊï∞
</h3><p>ÁªÑÂêàÊï∞Ôºå‰πüÁß∞‰∏∫‰∫åÈ°πÂºèÁ≥ªÊï∞ÔºåË°®Á§∫‰∏∫ $C(n, m)$ Êàñ $\binom{n}{m}$ÔºåÊòØÊåá‰ªé $n$ ‰∏™‰∏çÂêåÂÖÉÁ¥†‰∏≠ÈÄâÂèñ $m$ ‰∏™ÂÖÉÁ¥†ÁöÑÁªÑÂêàÊñπÂºèÊï∞ÈáèÔºå‰∏çËÄÉËôëÈÄâÂèñÁöÑÈ°∫Â∫è„ÄÇÁªÑÂêàÊï∞ÁöÑËÆ°ÁÆóÂÖ¨ÂºèÊòØÔºö
[ C(n, m) = \frac{n!}{m!(n-m)!} ]
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞‰∏äÂÖ¨Âºè</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">long</span> <span class="kt">long</span> <span class="nf">combination</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="n">n</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="n">m</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">long</span> <span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÁªÑÂêàÊï∞ÁöÑÊÄßË¥®</strong></p>
<ol>
<li>ÂØπÁß∞ÊÄßÔºö$C(n, m) = C(n, n-m)$„ÄÇ‰ªé $n$ ‰∏™ÂÖÉÁ¥†‰∏≠ÈÄâÂèñ $m$ ‰∏™ÂÖÉÁ¥†ÁöÑÊñπÂºèÊï∞‰∏éÈÄâÂèñ $n-m$ ‰∏™ÂÖÉÁ¥†ÁöÑÊñπÂºèÊï∞Áõ∏Âêå„ÄÇ</li>
<li>ËæπÁïåÊù°‰ª∂Ôºö$C(n, 0) = C(n, n) = 1$„ÄÇÈÄâÂèñ 0 ‰∏™ÊàñÂÖ®ÈÉ® $n$ ‰∏™ÂÖÉÁ¥†ÁöÑÊñπÂºèÂè™Êúâ‰∏ÄÁßç„ÄÇ</li>
<li><strong>Â∏ïÊñØÂç°ÊÅíÁ≠âÂºè</strong>Ôºö<strong>$C(n, m) = C(n-1, m) + C(n-1, m-1)$</strong>„ÄÇËøô‰∏™ÊÅíÁ≠âÂºèË°®ÊòéÔºå‰ªé $n$ ‰∏™ÂÖÉÁ¥†‰∏≠ÈÄâÂèñ $m$ ‰∏™ÂÖÉÁ¥†ÁöÑÊñπÂºèÊï∞Á≠â‰∫é‰ªé $n-1$ ‰∏™ÂÖÉÁ¥†‰∏≠ÈÄâÂèñ $m$ ‰∏™ÂÖÉÁ¥†ÁöÑÊñπÂºèÊï∞Âä†‰∏ä‰ªé $n-1$ ‰∏™ÂÖÉÁ¥†‰∏≠ÈÄâÂèñ $m-1$ ‰∏™ÂÖÉÁ¥†ÁöÑÊñπÂºèÊï∞„ÄÇ</li>
</ol>
<p>eg:<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÁªôÂÆö‰∏§‰∏™Êï¥Êï∞ $n, m$ÔºåÊ±Ç‰∏Ä‰∏™Â§ßÂ∞è $n \times m$ ÁöÑÁü©ÈòµÔºåÂÖ∂‰∏≠Á¨¨ $i$ Ë°åÔºåÁ¨¨ $j$ ÂàóÁöÑÂÖÉÁ¥†‰∏∫ $C(i, j)$„ÄÇ
$C(i, j)$ Ë°®Á§∫‰ªé $i$ ‰∏™‰∏çÂêåÁöÑÁâ©ÂìÅ‰∏≠ÈÄâÂá∫ $j$ ‰∏™ÁöÑÊñπÊ°àÊï∞„ÄÇ
Ê≥®ÊÑèÔºåËøôÈáåÁöÑË°åÂàóÂùá‰∏∫ 0-indexÔºåÂç≥‰∏ãÊ†á‰ªé 0 ÂºÄÂßãËÆ°Êï∞„ÄÇÁªìÊûúÂØπ $1e9 + 7$ ÂèñÊ®°„ÄÇ
<strong>ËæìÂÖ•Ê†ºÂºè</strong>Ôºö‰∏§‰∏™Êï¥Êï∞ $n, m$„ÄÇ ($1 \leq n, m \leq 10^3$)
<strong>ËæìÂá∫Ê†ºÂºè</strong>Ôºö‰∏Ä‰∏™ $n \times m$ ÁöÑÊï¥Êï∞Áü©ÈòµË°®Á§∫Á≠îÊ°à„ÄÇ
<strong>Êú¥Á¥†ÊñπÊ≥ïÔºàÈÄíÂΩíÊ±ÇËß£Ôºâ</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="mf">1e9</span> <span class="o">+</span> <span class="mi">7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">c</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1ll</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&amp;&amp;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂèàÂõ†‰∏∫[ C(n, m) = \frac{n!}{m!(n-m)!} ]
ÊâÄ‰ª•Âú®ËøõË°åÂèñÊ®°ÊÉÖÂ¢É‰∏ãÔºåÂèØ‰ª•ÂØπÂàÜÊØçÈÉ®ÂàÜËΩ¨Âåñ‰∏∫ÈÄÜÂÖÉËøõË°åÂ§ÑÁêÜÔºåÁªìÂêàÂø´ÈÄüÂπÇÂíåÊ±ÇÈÄÜÂÖÉÊù•ÂÅöÔºåÂ¶Ç‰∏ãÈ¢òÊâÄÁ§∫„ÄÇ
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">mod_inverse</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">:</span><span class="c1">// ‰ΩøÁî®Êâ©Â±ïÊ¨ßÂá†ÈáåÂæóÁÆóÊ≥ïÊ±ÇÈÄÜÂÖÉ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">gcd</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">extended_gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">gcd</span> <span class="o">!=</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1">// Êó†ÈÄÜÂÖÉ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">else</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">x</span> <span class="o">%</span> <span class="n">p</span>  <span class="c1">// Ê®° p ‰∏ãÁöÑÈÄÜÂÖÉ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">fast_pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">:</span><span class="c1">// Âø´ÈÄüÂπÇ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">b</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="c1">// 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">combination</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">:</span><span class="c1">//ÁªÑÂêàÊï∞
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="nl">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="err">ÂàÜÊØç</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="n">from</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">m</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="err">ÂàÜÂ≠ê</span> <span class="o">=</span> <span class="p">(</span><span class="err">ÂàÜÂ≠ê</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">        <span class="err">ÂàÜÊØç</span> <span class="o">=</span> <span class="p">(</span><span class="err">ÂàÜÊØç</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">    <span class="err">ÈÄÜÂÖÉÂàÜÊØç</span> <span class="o">=</span> <span class="err">Ê±ÇÈÄÜÂÖÉ</span><span class="p">(</span><span class="err">ÂàÜÊØç</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="err">ËøîÂõû</span> <span class="p">(</span><span class="err">ÂàÜÂ≠ê</span> <span class="o">*</span> <span class="err">ÈÄÜÂÖÉÂàÜÊØç</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:
<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÊúâ $q$ Ê¨°ËØ¢ÈóÆÔºåÊØèÊ¨°ÁªôÂá∫‰∏§‰∏™Êï¥Êï∞ $n, m$ÔºåÊ±Ç $C(n, m)$„ÄÇ$C(n, m)$ Ë°®Á§∫‰ªé $n$ ‰∏™‰∏çÂêåÁöÑÁâ©ÂìÅ‰∏≠ÈÄâÂá∫ $m$ ‰∏™ÁöÑÊñπÊ°àÊï∞„ÄÇÁªìÊûúÂØπ $1e9 + 7$ ÂèñÊ®°„ÄÇ
<strong>ËæìÂÖ•Ê†ºÂºè</strong>ÔºöÁ¨¨‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞ $q$„ÄÇ ($1 \leq \leq 10^5$)
ÂØπ‰∫éÊØè‰∏™ËØ¢ÈóÆÔºå‰∏§‰∏™Êï¥Êï∞ $n, m$„ÄÇ ($1 \leq m \leq n \leq 10^7$)
<strong>ËæìÂá∫Ê†ºÂºè</strong>ÔºöÂØπ‰∫éÊØèÊ¨°ËØ¢ÈóÆÔºåËæìÂá∫‰∏Ä‰∏™Êï¥Êï∞Ë°®Á§∫Á≠îÊ°à„ÄÇ
<strong>Ê®°Êùø</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="mf">1e9</span> <span class="o">+</span> <span class="mi">7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e7</span> <span class="o">+</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">fac</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="nf">quickMi</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">)</span> <span class="c1">// Âø´ÈÄüÂπÇ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">*</span> <span class="n">a</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="nf">inv</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">quickMi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Âø´ÈÄüÂπÇÊ±ÇÈÄÜÂÖÉ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="c1">// Ê±ÇÈò∂‰πò
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">fac</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">fac</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fac</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="nf">C</span><span class="p">(</span><span class="n">ll</span> <span class="n">n</span><span class="p">,</span> <span class="n">ll</span> <span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">fac</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="n">inv</span><span class="p">(</span><span class="n">fac</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">fac</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">init</span><span class="p">(</span><span class="mf">1e7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">C</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="0-1ËÉåÂåÖ">0-1ËÉåÂåÖ
</h3><p><strong>ÈóÆÈ¢òÊèèËø∞</strong>
ÁªôÂÆö:</p>
<ul>
<li>$n$ ‰∏™Áâ©ÂìÅÔºåÊØè‰∏™Áâ©ÂìÅÊúâÈáçÈáè $w_i$ Âíå‰ª∑ÂÄº $v_i$„ÄÇ</li>
<li>ËÉåÂåÖÁöÑÂÆπÈáè‰∏∫ $W$„ÄÇ
Ë¶ÅÊ±Ç:</li>
<li>ÈÄâÊã©‰∏Ä‰∫õÁâ©ÂìÅÊîæÂÖ•ËÉåÂåÖÔºå‰ΩøÂæóËÉåÂåÖ‰∏≠Áâ©ÂìÅÁöÑÊÄªÈáçÈáè‰∏çË∂ÖËøá $W$Ôºå‰∏îÊÄª‰ª∑ÂÄºÊúÄÂ§ß„ÄÇ</li>
</ul>
<p><strong>Ê≠•È™§</strong>Ôºö
1.Áä∂ÊÄÅÂÆö‰πâÔºöÂÆö‰πâ $dp[i][j]$ ‰∏∫ËÄÉËôëÂâç $i$ ‰∏™Áâ©ÂìÅÔºåËÉåÂåÖÂÆπÈáè‰∏∫ $j$ Êó∂ÁöÑÊúÄÂ§ß‰ª∑ÂÄº„ÄÇÁ°ÆÂÆöËæπÁïå
2.ÂàùÂßãÂåñ</p>
<ul>
<li>$dp[0][j] = 0$ ÂØπ‰∫éÊâÄÊúâ $j$ÔºåÂõ†‰∏∫Ê≤°ÊúâÁâ©ÂìÅÊó∂‰ª∑ÂÄº‰∏∫ 0„ÄÇ</li>
<li>$dp[i][0] = 0$ ÂØπ‰∫éÊâÄÊúâ $i$ÔºåÂõ†‰∏∫ÂÆπÈáè‰∏∫ 0 Êó∂Êó†Ê≥ïÊîæÁΩÆ‰ªª‰ΩïÁâ©ÂìÅ„ÄÇ</li>
</ul>
<p>3.ÊâæÁä∂ÊÄÅËΩ¨ÁßªÊñπÁ®ãÔºö
ÂØπ‰∫éÊØè‰∏™Áâ©ÂìÅ $i$ ÂíåÊØè‰∏™ÂÆπÈáè $j$:</p>
<p>[ dp[i][j] = \max(dp[i-1][j], dp[i-1][j-w_i] + v_i) ]</p>
<ul>
<li>Â¶ÇÊûú‰∏çÈÄâÊã©Á¨¨ $i$ ‰∏™Áâ©ÂìÅÔºåÂàôÊúÄÂ§ß‰ª∑ÂÄº‰∏∫ $dp[i-1][j]$„ÄÇ</li>
<li>Â¶ÇÊûúÈÄâÊã©Á¨¨ $i$ ‰∏™Áâ©ÂìÅÔºåÂàôÊúÄÂ§ß‰ª∑ÂÄº‰∏∫ $dp[i-1][j-w_{i}] + v_{i}$ÔºåÂâçÊèêÊòØ $j \geq w_{i}$„ÄÇ</li>
</ul>
<p>4.ÊåâÈ°∫Â∫èËÆ°ÁÆóÔºöÊåâÁâ©ÂìÅ $i$ ÂíåÂÆπÈáè $j$ ‰ªéÂ∞èÂà∞Â§ßÁöÑÈ°∫Â∫èËÆ°ÁÆó $dp[i][j]$„ÄÇ</p>
<p><strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">knapsack</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">w</span><span class="p">[],</span> <span class="n">v</span><span class="p">[],</span> <span class="n">n</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="err">ÂàõÂª∫‰∫åÁª¥Êï∞ÁªÑ</span> <span class="n">dp</span><span class="err">ÔºåÂ§ßÂ∞è‰∏∫</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="n">x</span> <span class="p">(</span><span class="n">W</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="err">ÔºåÂàùÂßãÂÄº‰∏∫</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="n">from</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="n">from</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">W</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nl">j</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dp</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">W</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>egÔºö
<strong>È¢òÁõÆÊèèËø∞</strong>Ôºö‚ÄúÂ≠©Â≠êÔºåËøô‰∏™Â±±Ê¥ûÈáåÊúâ‰∏Ä‰∫õ‰∏çÂêåÁöÑËçâËçØÔºåÈááÊØè‰∏ÄÊ†™ÈÉΩÈúÄË¶Å‰∏Ä‰∫õÊó∂Èó¥ÔºåÊØè‰∏ÄÊ†™‰πüÊúâÂÆÉËá™Ë∫´ÁöÑ‰ª∑ÂÄº„ÄÇÊàë‰ºöÁªô‰Ω†‰∏ÄÊÆµÊó∂Èó¥ÔºåÂú®ËøôÊÆµÊó∂Èó¥ÈáåÔºå‰Ω†ÂèØ‰ª•ÈááÂà∞‰∏Ä‰∫õËçâËçØ„ÄÇÂ¶ÇÊûú‰Ω†ÊòØ‰∏Ä‰∏™ËÅ™ÊòéÁöÑÂ≠©Â≠êÔºå‰Ω†Â∫îËØ•ÂèØ‰ª•ËÆ©ÈááÂà∞ÁöÑËçâËçØÁöÑÊÄª‰ª∑ÂÄºÊúÄÂ§ß„ÄÇ‚Äù
‰Ω†ËÉΩÂÆåÊàêËøô‰∏™‰ªªÂä°ÂêóÔºü
<strong>ËæìÂÖ•ÊèèËø∞</strong>ÔºöËæìÂÖ•ÁöÑÁ¨¨‰∏ÄË°åÊúâ‰∏§‰∏™Êï¥Êï∞ $T (1 \leq T \leq 1000)$ Âíå $M (1 \leq M \leq 100)$Ôºå$T$ ‰ª£Ë°®ÊÄªÂÖ±ËÉΩÂ§üÁî®Êù•ÈááËçØÁöÑÊó∂Èó¥Ôºå$M$ ‰ª£Ë°®Â±±Ê¥ûÈáåÁöÑËçâËçØÁöÑÊï∞ÁõÆ„ÄÇ
Êé•‰∏ãÊù•ÁöÑ $M$ Ë°åÊØèË°åÂåÖÊã¨‰∏§‰∏™Âú® 1 Âà∞ 100 ‰πãÈó¥ÔºàÂåÖÊã¨ 1 Âíå 100ÔºâÁöÑÊï¥Êï∞ÔºåÂàÜÂà´Ë°®Á§∫ÈááÊëòÊüêÊ†™ËçâËçØÁöÑÊó∂Èó¥ÂíåËøôÊ†™ËçâËçØÁöÑ‰ª∑ÂÄº„ÄÇ
<strong>ËæìÂá∫ÊèèËø∞</strong>ÔºöÂèØËÉΩÊúâÂ§öÁªÑÊµãËØïÊï∞ÊçÆÔºåÂØπ‰∫éÊØèÁªÑÊï∞ÊçÆÔºöËæìÂá∫Âè™ÂåÖÊã¨‰∏ÄË°åÔºåËøô‰∏ÄË°åÂè™ÂåÖÂê´‰∏Ä‰∏™Êï¥Êï∞ÔºåË°®Á§∫Âú®ËßÑÂÆöÁöÑÊó∂Èó¥ÂÜÖÔºåÂèØ‰ª•ÈááÂà∞ÁöÑËçâËçØÁöÑÊúÄÂ§ßÊÄª‰ª∑ÂÄº„ÄÇ</p>
<p><strong>ÊªöÂä®Êï∞ÁªÑ‰ºòÂåñ</strong>
ÊªöÂä®Êï∞ÁªÑ‰ºòÂåñÔºå‰πüÁß∞‰∏∫Á©∫Èó¥‰ºòÂåñÔºåÊòØÂä®ÊÄÅËßÑÂàí‰∏≠ÁöÑ‰∏ÄÁßçÊäÄÊúØÔºåÁî®‰∫éÂáèÂ∞ëÁÆóÊ≥ïÁöÑÁ©∫Èó¥Â§çÊùÇÂ∫¶„ÄÇÂú®0-1ËÉåÂåÖÈóÆÈ¢ò‰∏≠Ôºå<strong>Âõ†‰∏∫ÂÆûÈôÖÊØèÊ¨°ÂèÇ‰∏éËÆ°ÁÆóÁöÑÂè™ÊúâÂΩìÂâçÁöÑËøôË°åÂíåÂÆÉÁöÑ‰∏ä‰∏ÄË°å</strong>Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂè™Â≠òÂÇ®ÂΩìÂâçË°åÂíå‰∏ä‰∏ÄË°åÁöÑÂÄºÊù•‰ºòÂåñÁ©∫Èó¥Â§çÊùÇÂ∫¶Ôºå‰ªéËÄåÈôç‰ΩéÁ©∫Èó¥Â§çÊùÇÂ∫¶„ÄÇ
<strong>‰º™‰ª£Á†ÅÂÆûÁé∞</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="err">ÂáΩÊï∞</span> <span class="n">solve</span><span class="p">()</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ÂàùÂßãÂåñ dp Êï∞ÁªÑ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="err">Â∞Ü</span> <span class="n">dp</span> <span class="err">ÁöÑÊâÄÊúâÂÖÉÁ¥†ÂàùÂßãÂåñ‰∏∫</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ËæìÂÖ•ÊØèÊ†™ËçâËçØÁöÑÊó∂Èó¥Âíå‰ª∑ÂÄº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="err">ÂØπ‰∫é</span> <span class="n">i</span> <span class="err">‰ªé</span> <span class="mi">1</span> <span class="err">Âà∞</span> <span class="nl">M</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="err">ËØªÂèñ</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="err">Âíå</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Âä®ÊÄÅËßÑÂàí
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="err">ÂØπ‰∫é</span> <span class="n">i</span> <span class="err">‰ªé</span> <span class="mi">1</span> <span class="err">Âà∞</span> <span class="nl">M</span><span class="p">:</span> <span class="c1">// ÈÅçÂéÜÊØè‰∏ÄÊ†™ËçâËçØ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">current</span> <span class="o">=</span> <span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span>   <span class="c1">// ÂΩìÂâçË°å
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">previous</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">current</span> <span class="c1">// ‰∏ä‰∏ÄË°å
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="err">ÂØπ‰∫é</span> <span class="n">j</span> <span class="err">‰ªé</span> <span class="mi">0</span> <span class="err">Âà∞</span> <span class="nl">T</span><span class="p">:</span> <span class="c1">// ÈÅçÂéÜÊØè‰∏™Êó∂Èó¥ÈôêÂà∂
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="err">Â¶ÇÊûú</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">:</span> <span class="c1">// Â¶ÇÊûúÂΩìÂâçÊó∂Èó¥ËÉΩÈááËøôÊ†™ËçâËçØ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">dp</span><span class="p">[</span><span class="n">current</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">previous</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">previous</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="err">Âê¶Âàô</span><span class="o">:</span> <span class="c1">// ÂΩìÂâçÊó∂Èó¥‰∏çË∂≥‰ª•ÈááËøôÊ†™ËçâËçØ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">dp</span><span class="p">[</span><span class="n">current</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">previous</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dp</span><span class="p">[</span><span class="n">M</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">][</span><span class="n">T</span><span class="p">]</span> <span class="c1">// ÊúÄÁªàÁªìÊûúÂ≠òÂÇ®Âú®ÊúÄÂêé‰∏ÄË°åÂØπÂ∫îÁöÑÂàó‰∏≠
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>eg:Âêå‰∏äÈ¢ò</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">T</span><span class="p">,</span> <span class="n">M</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">t</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">105</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">dp</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1010</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">dp</span><span class="p">));</span> <span class="c1">// ÂàùÂßãÂåñ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">M</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">M</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">current</span> <span class="o">=</span> <span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// Ë°®Á§∫ÂΩìÂâçË°å 1-currentÂç≥Èõ∂‰∏ÄË°å
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">T</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="c1">//ÊªöÂä®Êï∞ÁªÑ‰ºòÂåñÔºö
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">                <span class="n">dp</span><span class="p">[</span><span class="n">current</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="n">current</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="n">current</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">                <span class="n">dp</span><span class="p">[</span><span class="n">current</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="n">current</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">dp</span><span class="p">[</span><span class="n">M</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">][</span><span class="n">T</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">M</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">T</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="Êó†Á©∑ÂÆåÂÖ®ËÉåÂåÖ">Êó†Á©∑/ÂÆåÂÖ®ËÉåÂåÖ
</h3><p><strong>ÈóÆÈ¢òÊèèËø∞</strong>ÁªôÂÆö:</p>
<ul>
<li>$n$ ‰∏™Áâ©ÂìÅÔºåÊØè‰∏™Áâ©ÂìÅÊúâÈáçÈáè $w_i$ Âíå‰ª∑ÂÄº $v_i$„ÄÇ</li>
<li>ËÉåÂåÖÁöÑÂÆπÈáè‰∏∫ $W$„ÄÇ</li>
</ul>
<p>Ë¶ÅÊ±Ç:</p>
<ul>
<li>ÈÄâÊã©‰∏Ä‰∫õÁâ©ÂìÅÊîæÂÖ•ËÉåÂåÖÔºå‰ΩøÂæóËÉåÂåÖ‰∏≠Áâ©ÂìÅÁöÑÊÄªÈáçÈáè‰∏çË∂ÖËøá $W$Ôºå‰∏îÊÄª‰ª∑ÂÄºÊúÄÂ§ß„ÄÇ</li>
</ul>
<p><strong>Ê≠•È™§</strong>Ôºö</p>
<p>1.Áä∂ÊÄÅÂÆö‰πâÔºöÂÆö‰πâ $dp[j]$ ‰∏∫ËÉåÂåÖÂÆπÈáè‰∏∫ $j$ Êó∂ÁöÑÊúÄÂ§ß‰ª∑ÂÄº„ÄÇ
2.ÂàùÂßãÂåñÔºö $dp[0] = 0$ÔºöËÉåÂåÖÂÆπÈáè‰∏∫0Êó∂Ôºå‰ª∑ÂÄº‰∏∫0„ÄÇ
3.Áä∂ÊÄÅËΩ¨ÁßªÊñπÁ®ãÔºöÂØπ‰∫éÊØè‰∏™Áâ©ÂìÅ $i$ ÂíåÊØè‰∏™ÂÆπÈáè $j$:</p>
<p>[ dp[j] = \max(dp[j], dp[j - w_i] + v_i) ]</p>
<p>Ëøô‰∏™Áä∂ÊÄÅËΩ¨ÁßªÊñπÁ®ãÊÑèÂë≥ÁùÄÔºåÂØπ‰∫éÊØè‰∏™Áâ©ÂìÅÔºå‰Ω†ÂèØ‰ª•ÈÄâÊã©‰∏çÊîæÂÆÉ„ÄÅÊîæ1‰∏™„ÄÅÊîæ2‰∏™‚Ä¶‚Ä¶Áõ¥Âà∞ËÉåÂåÖÂÆπÈáèÂÖÅËÆ∏ÁöÑÊúÄÂ§ßÊï∞Èáè„ÄÇÂõ†Ê≠§Ôºå‰Ω†ÈúÄË¶ÅÊ£ÄÊü•ÊâÄÊúâÂèØËÉΩÁöÑÊï∞ÈáèÔºåÊõ¥Êñ∞ $dp[j]$ ÁöÑÂÄº„ÄÇ
4.ËÆ°ÁÆóÔºöÊåâÁâ©ÂìÅ $i$ ÂíåÂÆπÈáè $j$ ‰ªéÂ∞èÂà∞Â§ßÁöÑÈ°∫Â∫èËÆ°ÁÆó $dp[j]$„ÄÇ
<strong>‰∏∫‰ª£Á†ÅÂÆûÁé∞</strong>Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">unbounded_knapsack</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">w</span><span class="p">[],</span> <span class="n">v</span><span class="p">[],</span> <span class="n">n</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="err">ÂàõÂª∫‰∏ÄÁª¥Êï∞ÁªÑ</span> <span class="n">dp</span><span class="err">ÔºåÂ§ßÂ∞è‰∏∫</span> <span class="n">W</span> <span class="o">+</span> <span class="mi">1</span><span class="err">ÔºåÂàùÂßãÂÄº‰∏∫</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="n">from</span> <span class="mi">1</span> <span class="n">to</span> <span class="nl">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="n">from</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="n">to</span> <span class="nl">W</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">dp</span><span class="p">[</span><span class="n">W</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>egÔºö<strong>È¢òÁõÆÊèèËø∞</strong>:Â∞èeÁöÑËÉåÂåÖÂÆπÈáè‰∏∫ $m$ÔºåÁé∞Âú®ÂïÜÂ∫óÈáåÊúâ $n$ ÁßçÂïÜÂìÅ„ÄÇÁî±‰∫éÂú®Ê¢¶Â¢É‰∏≠Ôºå‰ªñÂèØ‰ª•Èõ∂ÂÖÉË¥≠ÔºåÂïÜÂ∫óÈáåÁöÑÊØèÁßçÂïÜÂìÅÈÉΩÊúâÊó†Á©∑‰ª∂ÔºåÊØè‰ª∂ÂïÜÂìÅÊúâ‰∏Ä‰∏™‰ª∑ÂÄº $w_i$ Âíå‰ΩìÁßØ $v_i$„ÄÇÈóÆÂ∞èeÊúÄÂ§öÂèØ‰ª•Â∏¶Ëµ∞Â§öÂ∞ë‰ª∑ÂÄºÁöÑÂïÜÂìÅÔºü
<strong>ËæìÂÖ•Ê†ºÂºè</strong>:Á¨¨‰∏ÄË°å‰∏§‰∏™Êï¥Êï∞Ë°®Á§∫ $m, n$„ÄÇ ($1 \leq m \leq 10^5, 1 \leq n \leq 500$)Êé•‰∏ãÊù• $n$ Ë°åÔºåÊØèË°å‰∏§‰∏™Êï¥Êï∞Ë°®Á§∫ $w_i, v_i$„ÄÇ ($1 \leq w_i \leq 10^9, 1 \leq v_i \leq m$)
<strong>ËæìÂá∫Ê†ºÂºè</strong>:‰∏ÄË°å‰∏Ä‰∏™Êï¥Êï∞Ë°®Á§∫Á≠îÊ°à„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">505</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">M</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">dp</span><span class="p">[</span><span class="n">M</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">w</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">memset</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">dp</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]]);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">dp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÂàÜÊûêËÉåÂåÖÈóÆÈ¢òÁöÑÊó∂ÂÄôË¶ÅÊ≥®ÊÑèÁä∂ÊÄÅËΩ¨Êç¢ÊòØ‰ªéÂΩìÂâçË°åËøòÊòØ‰∏ä‰∏ÄË°å</strong></p>
<h2 id="11Â§öÈáçËÉåÂåÖÁöÑ‰∫åËøõÂà∂‰ºòÂåñÂçïË∞ÉÊ†à‰∫åÂàÜdp">11.Â§öÈáçËÉåÂåÖÁöÑ‰∫åËøõÂà∂‰ºòÂåñ„ÄÅÂçïË∞ÉÊ†à‰∫åÂàÜdp
</h2><h3 id="Â§öÈáçËÉåÂåÖÁöÑ‰∫åËøõÂà∂‰ºòÂåñ">Â§öÈáçËÉåÂåÖÁöÑ‰∫åËøõÂà∂‰ºòÂåñ
</h3><h4 id="Â§öÈáçËÉåÂåÖ">Â§öÈáçËÉåÂåÖ
</h4><p>Â§öÈáçËÉåÂåÖÈóÆÈ¢òÊòØ‰∏ÄÁßçÁªèÂÖ∏ÁöÑÂä®ÊÄÅËßÑÂàíÈóÆÈ¢òÔºåÂÆÉ‰∏é0-1ËÉåÂåÖÈóÆÈ¢òÁ±ª‰ººÔºå‰ΩÜÂå∫Âà´Âú®‰∫éÂ§öÈáçËÉåÂåÖÈóÆÈ¢ò‰∏≠ÊØèÁßçÁâ©ÂìÅÂèØ‰ª•ÈÄâÂèñÂ§öÊ¨°ÔºåËÄå0-1ËÉåÂåÖÈóÆÈ¢ò‰∏≠ÊØèÁßçÁâ©ÂìÅÂè™ËÉΩÈÄâÂèñ‰∏ÄÊ¨°Êàñ‰∏çÈÄâÂèñ„ÄÇ</p>
<p>egÔºö
<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÂ∞èeÁöÑËÉåÂåÖÂÆπÈáè‰∏∫ $m$ÔºåÁé∞Âú®ÂïÜÂ∫óÈáåÊúâ $n$ ÁßçÂïÜÂìÅ„ÄÇÁî±‰∫éÂú®Ê¢¶Â¢É‰∏≠Ôºå‰ªñÂèØ‰ª•Èõ∂ÂÖÉË¥≠Ôºå‰ΩÜÂïÜÂìÅÁöÑÊï∞ÈáèÊúâÈôêÔºåÁ¨¨ $i$ ÁßçÂïÜÂìÅÊúÄÂ§öÂèØ‰ª•Ë¥≠‰π∞ $s_i$ ‰ª∂ÔºåÊØè‰ª∂ÂïÜÂìÅÊúâ‰∏Ä‰∏™‰ª∑ÂÄº $w_i$ Âíå‰ΩìÁßØ $v_i$„ÄÇËØ∑ÈóÆÂ∞èeÊúÄÂ§öÂèØ‰ª•Â∏¶Ëµ∞Â§öÂ∞ë‰ª∑ÂÄºÁöÑÂïÜÂìÅÔºü
<strong>ËæìÂÖ•ÊèèËø∞</strong>ÔºöÁ¨¨‰∏ÄË°åÔºö‰∏§‰∏™Êï¥Êï∞ $m, n$ÔºåË°®Á§∫ËÉåÂåÖÂÆπÈáè„ÄÅÂïÜÂìÅÁßçÊï∞„ÄÇ ($1 \leq m, n \leq 100$)Êé•‰∏ãÊù• $n$ Ë°åÔºöÊØèË°å‰∏â‰∏™Êï¥Êï∞ $s_i, w_i, v_i$ÔºåË°®Á§∫Á¨¨ $i$ ÁßçÂïÜÂìÅÁöÑ‰ª∂Êï∞„ÄÅ‰ª∑ÂÄº„ÄÅ‰ΩìÁßØ„ÄÇ ($0 \leq s_i, w_i, v_i \leq 100$)
<strong>ËæìÂá∫ÊèèËø∞</strong>Ôºö‰∏Ä‰∏™Êï¥Êï∞ÔºåË°®Á§∫Â∞èeËÉΩÂ∏¶Ëµ∞ÁöÑÊúÄÂ§ß‰ª∑ÂÄº„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">dp</span><span class="p">[</span><span class="n">N</span> <span class="o">*</span> <span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ll</span> <span class="n">s</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">w</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="n">s</span><span class="o">--</span><span class="p">)</span> <span class="c1">// Ë∑ësÊ¨°0-1ËÉåÂåÖ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">m</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">v</span><span class="p">;</span> <span class="o">--</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">dp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>‰∏äÈ¢òËß£Âú®Êï∞ÊçÆÈáèËæÉÂ∞èÊó∂ÂèØ‰ª•Êª°Ë∂≥Ë¶ÅÊ±ÇÔºåÊï∞ÊçÆÈáèÂèòÂ§ßÂêéÁî±‰∫éforÔºàwhileÔºàforÔºâÔºâÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶Â§™È´òÔºå‰ºöË∂ÖÊó∂„ÄÇ</strong></p>
<h4 id="Â§öÈáçËÉåÂåÖÁöÑ‰∫åËøõÂà∂‰ºòÂåñ-1">Â§öÈáçËÉåÂåÖÁöÑ‰∫åËøõÂà∂‰ºòÂåñ
</h4><p>Â§öÈáçËÉåÂåÖÈóÆÈ¢òÁöÑ‰∫åËøõÂà∂‰ºòÂåñÊòØ‰∏ÄÁßçÂ∞ÜÈóÆÈ¢òËΩ¨Âåñ‰∏∫ 01 ËÉåÂåÖÈóÆÈ¢òÁöÑÊñπÊ≥ïÔºåÂÖ∂Ê†∏ÂøÉÊÄùÊÉ≥ÊòØÂà©Áî®‰∫åËøõÂà∂Ë°®Á§∫Ê≥ïÂ∞ÜÊØè‰∏™Áâ©ÂìÅÁöÑÊï∞ÈáèÊãÜÂàÜÊàêÂ§ö‰∏™ 1 ÁöÑÂÄçÊï∞Ôºå‰ªéËÄåÂáèÂ∞ëÁä∂ÊÄÅÁöÑÊï∞ÈáèÔºåÊèêÈ´òÁÆóÊ≥ïÊïàÁéá„ÄÇ
<strong>Â§öÈáçËÉåÂåÖÈóÆÈ¢ò‰∫åËøõÂà∂‰ºòÂåñÁöÑÂéüÁêÜ</strong>
ÂØπ‰∫é‰∏Ä‰∏™Áâ©ÂìÅÔºåÂ¶ÇÊûúÂÆÉÊúâ $s$ ‰∏™ÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ÜÂÖ∂ÊãÜÂàÜÊàê 1, 2, 4, 8, &hellip; Áõ¥Âà∞ $2^k - 1$ÔºàÂÖ∂‰∏≠ $k$ ÊòØÊª°Ë∂≥ $2^k - 1 \leq s$ ÁöÑÊúÄÂ§ßÊï¥Êï∞ÔºâÔºåËøôÊ†∑Â∞±ËÉΩË°®Á§∫Âá∫ 0 Âà∞ $s$ ÁöÑÊâÄÊúâÊï∞Èáè„ÄÇËøôÁßçÊñπÊ≥ïÂèØ‰ª•ÂáèÂ∞ëÁâ©ÂìÅÊï∞ÈáèÁöÑË°®Á§∫ËåÉÂõ¥Ôºå‰ªéËÄåÂ∞ÜÂ§öÈáçËÉåÂåÖÈóÆÈ¢òËΩ¨Âåñ‰∏∫ 01 ËÉåÂåÖÈóÆÈ¢ò„ÄÇ
<strong>ÁÆóÊ≥ïÊ≠•È™§</strong></p>
<ol>
<li><strong>‰∫åËøõÂà∂ÊãÜÂàÜ</strong>ÔºöÂØπ‰∫éÊØè‰∏™Áâ©ÂìÅÔºåÊ†πÊçÆÂÖ∂Êï∞Èáè $s$Ôºå‰ΩøÁî®‰∫åËøõÂà∂Ë°®Á§∫Ê≥ïÂ∞ÜÂÖ∂ÊãÜÂàÜÊàêÂ§ö‰∏™ 1 ÁöÑÂÄçÊï∞„ÄÇ‰æãÂ¶ÇÔºåÂ¶ÇÊûú‰∏Ä‰∏™Áâ©ÂìÅÊúâ 10 ‰∏™ÔºåÂèØ‰ª•ÊãÜÂàÜÊàê 1+2+4+3„ÄÇ</li>
<li><strong>Áä∂ÊÄÅËΩ¨Áßª</strong>ÔºöÂ∞ÜÊãÜÂàÜÂêéÁöÑÁâ©ÂìÅËßÜ‰∏∫ 01 ËÉåÂåÖÈóÆÈ¢ò‰∏≠ÁöÑ‰∏çÂêåÁâ©ÂìÅÔºå‰ΩøÁî®Âä®ÊÄÅËßÑÂàíÊ±ÇËß£„ÄÇÂØπ‰∫éÊØè‰∏™Áâ©ÂìÅÔºå‰ªéËÉåÂåÖÁöÑÊúÄÂ§ßÂÆπÈáèÂêë‰∏ãÈÅçÂéÜÔºåÊõ¥Êñ∞ dp Êï∞ÁªÑ„ÄÇ</li>
<li><strong>‰ª£Á†ÅÂÆûÁé∞</strong>ÔºöÂú®‰ª£Á†Å‰∏≠ÔºåÈ¶ñÂÖàÂØπÊØè‰∏™Áâ©ÂìÅËøõË°å‰∫åËøõÂà∂ÊãÜÂàÜÔºåÁÑ∂Âêé‰ΩøÁî® 01 ËÉåÂåÖÁöÑÁä∂ÊÄÅËΩ¨ÁßªÊñπÁ®ãÊ±ÇËß£„ÄÇ</li>
</ol>
<p><strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÂ∞èeÁöÑËÉåÂåÖÂÆπÈáè‰∏∫ $m$ÔºåÁé∞Âú®ÂïÜÂ∫óÈáåÊúâ $n$ ÁßçÂïÜÂìÅ„ÄÇÁî±‰∫éÂú®Ê¢¶Â¢É‰∏≠Ôºå‰ªñÂèØ‰ª•Èõ∂ÂÖÉË¥≠Ôºå‰ΩÜÂïÜÂìÅÁöÑÊï∞ÈáèÊúâÈôêÔºåÁ¨¨ $i$ ÁßçÂïÜÂìÅÊúÄÂ§öÂèØ‰ª•Ë¥≠‰π∞ $s_i$ ‰ª∂ÔºåÊØè‰ª∂ÂïÜÂìÅÊúâ‰∏Ä‰∏™‰ª∑ÂÄº $w_i$ Âíå‰ΩìÁßØ $v_i$„ÄÇËØ∑ÈóÆÂ∞èeÊúÄÂ§öÂèØ‰ª•Â∏¶Ëµ∞Â§öÂ∞ë‰ª∑ÂÄºÁöÑÂïÜÂìÅÔºü
<strong>ËæìÂÖ•ÊèèËø∞</strong>ÔºöÁ¨¨‰∏ÄË°åÔºö‰∏§‰∏™Êï¥Êï∞ $m, n$ÔºåË°®Á§∫ËÉåÂåÖÂÆπÈáè„ÄÅÂïÜÂìÅÁßçÊï∞„ÄÇ ($1 \leq m, n \leq 2000$)Êé•‰∏ãÊù• $n$ Ë°åÔºöÊØèË°å‰∏â‰∏™Êï¥Êï∞ $s_i, w_i, v_i$ÔºåË°®Á§∫Á¨¨ $i$ ÁßçÂïÜÂìÅÁöÑ‰ª∂Êï∞„ÄÅ‰ª∑ÂÄº„ÄÅ‰ΩìÁßØ„ÄÇ ($0 \leq s_i, w_i, v_i \leq 2000$)
<strong>ËæìÂá∫ÊèèËø∞</strong>Ôºö‰∏Ä‰∏™Êï¥Êï∞ÔºåË°®Á§∫Â∞èeËÉΩÂ∏¶Ëµ∞ÁöÑÊúÄÂ§ß‰ª∑ÂÄº„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">2000</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">dp</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ll</span> <span class="n">s</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">w</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">vec</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="n">s</span> <span class="o">&gt;=</span> <span class="n">x</span><span class="p">)</span> <span class="c1">// ËøõË°å‰∫åËøõÂà∂‰ºòÂåñÔºö
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">vec</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">s</span> <span class="o">-=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">x</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">vec</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="nl">k</span> <span class="p">:</span> <span class="n">vec</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">m</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">v</span><span class="p">;</span> <span class="o">--</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="n">k</span> <span class="o">*</span> <span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">dp</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="12dpÂàÜÁ±ª‰∏éÁ≤æËÆ≤Á∫øÊÄßdpÂå∫Èó¥dpÊ†ëÂΩ¢dp">12.DPÂàÜÁ±ª‰∏éÁ≤æËÆ≤Á∫øÊÄßdp„ÄÅÂå∫Èó¥dp„ÄÅÊ†ëÂΩ¢dp
</h2><p>Âä®ÊÄÅËßÑÂàíÔºàDPÔºâÊòØÁÆóÊ≥ï‰∏≠‰∏ÄÁßçÂ∏∏ËßÅ‰∏îÈáçË¶ÅÁöÑÊÄùÊÉ≥ÔºåÂ∫îÁî®ÂπøÊ≥õ„ÄÇ‰ª•‰∏ãÊòØÂ∏∏ËßÅÁöÑÂä®ÊÄÅËßÑÂàíÂàÜÁ±ª‰ª•ÂèäÂÖ∂ÁâπÁÇπÂíåÂÖ∏ÂûãÂ∫îÁî®Ôºö</p>
<h3 id="1-Á∫øÊÄß-dp">1. Á∫øÊÄß DP**
</h3><p><strong>ÁâπÁÇπ</strong>Ôºö</p>
<ul>
<li>ÈóÆÈ¢òÂèØ‰ª•ÂàÜËß£‰∏∫‰∏Ä‰∏™Á∫øÊÄßÈ°∫Â∫èÁöÑÂ≠êÈóÆÈ¢òÔºåÁä∂ÊÄÅ‰πãÈó¥ÊåâÁÖßÂ∫èÂàóÂÖ≥Á≥ªËΩ¨Áßª„ÄÇ</li>
<li>‰∏ªË¶ÅÂ§ÑÁêÜÂÖ∑ÊúâÈ°∫Â∫èÊÄßÂíåÂâçÂêé‰æùËµñÂÖ≥Á≥ªÁöÑÈóÆÈ¢ò„ÄÇ</li>
</ul>
<p><strong>Áä∂ÊÄÅÂÆö‰πâ</strong>Ôºö</p>
<ul>
<li>‰∏ÄËà¨ÂÆö‰πâ‰∏∫ <code>dp[i]</code>ÔºåË°®Á§∫Ââç <code>i</code> ‰∏™Áä∂ÊÄÅÁöÑÊúÄ‰ºòËß£ÔºåÊàñËÄÖ‰ª•Á¨¨ <code>i</code> ‰∏™ÂÖÉÁ¥†‰∏∫ÁªìÂ∞æ/Ëµ∑ÁÇπÁöÑÂ≠êÈóÆÈ¢òÊúÄ‰ºòËß£„ÄÇ</li>
</ul>
<p><strong>ÂÖ∏ÂûãÈóÆÈ¢ò</strong>Ôºö  ÊúÄÈïø‰∏äÂçáÂ≠êÂ∫èÂàóÔºàLISÔºâ„ÄÅÊúÄÈïøÂÖ¨ÂÖ±Â≠êÂ∫èÂàóÔºàLCSÔºâ„ÄÅËÉåÂåÖÈóÆÈ¢òÔºà0-1 ËÉåÂåÖ„ÄÅÂÆåÂÖ®ËÉåÂåÖ„ÄÅÂàÜÁªÑËÉåÂåÖÔºâ„ÄÅËÇ°Á•®‰∫§ÊòìÈóÆÈ¢ò„ÄÅÊúÄÂ§ßÂ≠êÂ∫èÂíå<br>
<strong>ÊúÄÈïø‰∏äÂçáÂ≠êÂ∫èÂàóÊ®°Êùø</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:
<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ $n$ ÁöÑÊï∞ÁªÑ $a$ÔºåÊ±ÇÂÖ∂ÊúÄÈïø‰∏äÂçáÔºàÈùûÈôçÔºâÂ≠êÂ∫èÂàóÁöÑÈïøÂ∫¶„ÄÇ
Ê≥®ÊÑèÔºöÂ≠êÂ∫èÂàó‰∏ç‰∏ÄÂÆöÊòØËøûÁª≠ÁöÑ„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>:
Á¨¨‰∏ÄË°åÔºö‰∏Ä‰∏™Êï¥Êï∞ $n$„ÄÇ ($1 \leq n \leq 10^3$)
Á¨¨‰∫åË°åÔºö$n$ ‰∏™Êï¥Êï∞ÔºåË°®Á§∫ $a_1, a_2, \ldots, a_n$„ÄÇ ($1 \leq a_i \leq 10^9$)
<strong>ËæìÂá∫ÊèèËø∞</strong>:‰∏Ä‰∏™Êï¥Êï∞ÔºåË°®Á§∫Á≠îÊ°à„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">                <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Êï∞ÁªÑÂçïË∞ÉÊ†à‰∫åÂàÜ‰ºòÂåñ</strong>Ôºö
<strong>ÂÆûÈôÖ‰∏äÊ†à‰∏≠ÁöÑÊØè‰∏™ÂÖÉÁ¥†ÊòØ‰∏Ä‰∏™Á¥¢Âºï iÔºåÂÆÉË°®Á§∫Êï∞ÁªÑ nums[i] ÊòØÂΩìÂâçÊúÄÈïø‰∏äÂçáÂ≠êÂ∫èÂàóÁöÑ‰∏Ä‰∏™ÁªìÂ∞æÂÖÉÁ¥†„ÄÇ</strong>
ÂçïË∞ÉÊ†à‰ºòÂåñLISÁöÑÂéüÁêÜ:</p>
<ol>
<li>ÂçïË∞ÉÊ†àÁª¥Êä§Ôºö‰ΩøÁî®‰∏Ä‰∏™Ê†àÊù•Áª¥Êä§ÂΩìÂâçÊâæÂà∞ÁöÑÊúÄÈïø‰∏äÂçáÂ≠êÂ∫èÂàó„ÄÇÊ†àÂÜÖÁöÑÂÖÉÁ¥†ÊòØÈÄíÂ¢ûÁöÑÔºåÂç≥Ê†àÂ∫ïÂà∞Ê†àÈ°∂ÊòØ‰∏•Ê†ºÈÄíÂ¢ûÁöÑÂ∫èÂàó„ÄÇ</li>
<li>ÈÅçÂéÜÊï∞ÁªÑÔºöÈÅçÂéÜÁªôÂÆöÁöÑÊï∞ÁªÑÔºåÂØπ‰∫éÊØè‰∏™ÂÖÉÁ¥†ÔºåÊúâ‰∏§ÁßçÊÉÖÂÜµÔºöÂ¶ÇÊûúÂΩìÂâçÂÖÉÁ¥†Â§ß‰∫éÊ†àÈ°∂ÂÖÉÁ¥†ÔºåËØ¥ÊòéÂΩìÂâçÂÖÉÁ¥†ÂèØ‰ª•Êé•Âú®Ê†àÈ°∂ÂÖÉÁ¥†ÂêéÈù¢ÂΩ¢ÊàêÊõ¥ÈïøÁöÑ‰∏äÂçáÂ≠êÂ∫èÂàóÔºåÂõ†Ê≠§Â∞ÜÂΩìÂâçÂÖÉÁ¥†ÂÖ•Ê†à;Â¶ÇÊûúÂΩìÂâçÂÖÉÁ¥†Â∞è‰∫éÊàñÁ≠â‰∫éÊ†àÈ°∂ÂÖÉÁ¥†ÔºåËØ¥ÊòéÈúÄË¶ÅÂú®Ê†à‰∏≠ÊâæÂà∞‰∏Ä‰∏™ÂêàÈÄÇÁöÑ‰ΩçÁΩÆÊù•ÊõøÊç¢Ê†àÈ°∂ÂÖÉÁ¥†Ôºå‰ΩøÂæóÊ†à‰ªçÁÑ∂‰øùÊåÅÂçïË∞ÉÈÄíÂ¢û„ÄÇËøôÂèØ‰ª•ÈÄöËøá‰∫åÂàÜÊü•ÊâæÊù•ÂÆûÁé∞ÔºåÊâæÂà∞Ê†à‰∏≠Á¨¨‰∏Ä‰∏™Â§ß‰∫éÂΩìÂâçÂÖÉÁ¥†ÁöÑ‰ΩçÁΩÆÔºåÂπ∂Áî®ÂΩìÂâçÂÖÉÁ¥†ÊõøÊç¢ËØ•‰ΩçÁΩÆÁöÑÂÖÉÁ¥†„ÄÇ</li>
<li>Êõ¥Êñ∞Ê†àÔºöÈÄöËøá‰∏äËø∞Ê≠•È™§ÔºåÊ†àÁöÑÈïøÂ∫¶Âç≥‰∏∫ÊúÄÈïø‰∏äÂçáÂ≠êÂ∫èÂàóÁöÑÈïøÂ∫¶„ÄÇ</li>
</ol>
<p>eg:
<strong>È¢òÁõÆÊèèËø∞</strong>:ÁªôÂÆö‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ $n$ ÁöÑÊï∞ÁªÑ $a$ÔºåÊ±ÇÂÖ∂ÊúÄÈïø‰∏äÂçáÔºàÈùûÈôçÔºâÂ≠êÂ∫èÂàóÁöÑÈïøÂ∫¶„ÄÇ
Ê≥®ÊÑèÔºöÂ≠êÂ∫èÂàó‰∏ç‰∏ÄÂÆöÊòØËøûÁª≠ÁöÑ„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>:
Á¨¨‰∏ÄË°åÔºö‰∏Ä‰∏™Êï¥Êï∞ $n$„ÄÇ ($1 \leq n \leq 2√ó10^5$)
Á¨¨‰∫åË°åÔºö$n$ ‰∏™Êï¥Êï∞ÔºåË°®Á§∫ $a_1, a_2, \ldots, a_n$„ÄÇ ($1 \leq a_i \leq 10^9$)
<strong>ËæìÂá∫ÊèèËø∞</strong>:‰∏Ä‰∏™Êï¥Êï∞ÔºåË°®Á§∫Á≠îÊ°à„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">stk</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">top</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ÊâæÊúÄÂêé‰∏Ä‰∏™ &lt;= a[i]ÁöÑ‰ΩçÁΩÆ+1 ‰πüÂ∞±ÊòØÈ¶ñ‰∏™ &gt; a[i]ÁöÑ‰ΩçÁΩÆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">upper_bound</span><span class="p">(</span><span class="n">stk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">stk</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">top</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">stk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//Áî®upper_boundÊù•ÂÆûÁé∞‰∫åÂàÜ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">==</span> <span class="n">top</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">top</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">stk</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">top</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>egÔºö
<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÊüêÂõΩ‰∏∫‰∫ÜÈò≤Âæ°ÊïåÂõΩÁöÑÂØºÂºπË¢≠ÂáªÔºåÂèëÂ±ïÂá∫‰∏ÄÁßçÂØºÂºπÊã¶Êà™Á≥ªÁªü„ÄÇ‰ΩÜÊòØËøôÁßçÂØºÂºπÊã¶Êà™Á≥ªÁªüÊúâ‰∏Ä‰∏™Áº∫Èô∑ÔºöËôΩÁÑ∂ÂÆÉÁöÑÁ¨¨‰∏ÄÂèëÁÇÆÂºπËÉΩÂ§üÂà∞Ëææ‰ªªÊÑèÁöÑÈ´òÂ∫¶Ôºå‰ΩÜÊòØ‰ª•ÂêéÊØè‰∏ÄÂèëÁÇÆÂºπÈÉΩ‰∏çËÉΩÈ´ò‰∫éÂâç‰∏ÄÂèëÁöÑÈ´òÂ∫¶„ÄÇÊüêÂ§©ÔºåÈõ∑ËææÊçïÊçâÂà∞ÊïåÂõΩÁöÑÂØºÂºπÊù•Ë¢≠„ÄÇÁî±‰∫éËØ•Á≥ªÁªüËøòÂú®ËØïÁî®Èò∂ÊÆµÔºåÊâÄ‰ª•Âè™Êúâ‰∏ÄÂ•óÁ≥ªÁªüÔºåÂõ†Ê≠§ÊúâÂèØËÉΩ‰∏çËÉΩÊã¶Êà™ÊâÄÊúâÁöÑÂØºÂºπ„ÄÇËæìÂÖ•ÂØºÂºπ‰æùÊ¨°È£ûÊù•ÁöÑÈ´òÂ∫¶ÔºàÈõ∑ËææÁªôÂá∫ÁöÑÈ´òÂ∫¶Êï∞ÊçÆÊòØ‰∏çÂ§ß‰∫é30000ÁöÑÊ≠£Êï¥Êï∞ÔºâÔºåËÆ°ÁÆóËøôÂ•óÁ≥ªÁªüÊúÄÂ§öËÉΩÊã¶Êà™Â§öÂ∞ëÂØºÂºπÔºåÂ¶ÇÊûúË¶ÅÊã¶Êà™ÊâÄÊúâÂØºÂºπÊúÄÂ∞ëË¶ÅÈÖçÂ§áÂ§öÂ∞ëÂ•óËøôÁßçÂØºÂºπÊã¶Êà™Á≥ªÁªü„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>ÔºöÊØèÁ¨îÊµãËµÑ‰∏ÄË°åÔºöËæìÂÖ•ÂØºÂºπ‰æùÊ¨°È£ûÊù•ÁöÑÈ´òÂ∫¶ÔºåÁ©∫Ê†ºÂàÜÈöîÔºåÂØºÂºπÊï∞‰∏çË∂ÖËøá1000„ÄÇ
<strong>ËæìÂá∫ÊèèËø∞</strong>ÔºöÂØπ‰∫éÊØèÁ¨îÊµãËµÑÔºåËæìÂá∫‰∏§Ë°åÔºöÁ¨¨1Ë°åÔºö1‰∏™Êï¥Êï∞ÔºåË°®Á§∫ÊúÄÂ§öËÉΩÊã¶Êà™ÁöÑÂØºÂºπÊï∞„ÄÇÁ¨¨2Ë°åÔºö1‰∏™Êï¥Êï∞ÔºåË°®Á§∫Ë¶ÅÊã¶Êà™ÊâÄÊúâÂØºÂºπÊúÄÂ∞ëË¶ÅÈÖçÂ§áÁöÑÁ≥ªÁªüÊï∞„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">stk</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">top</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ‰∏çÁü•ÈÅìÊúâÂ§öÂ∞ëËæìÂÖ•ÁöÑÊó∂ÂÄôÂèØ‰ª•ËøôÊ†∑ËÆ∞ÂΩï:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="o">++</span><span class="n">n</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ÊâæÁ¨¨‰∏Ä‰∏™Â∞è‰∫éa[i]ÁöÑ‰ΩçÁΩÆ ËÆ∞ÂΩïÂú®pos‰∏≠
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">upper_bound</span><span class="p">(</span><span class="n">stk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">stk</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">top</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">[](</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                              <span class="p">{</span> <span class="k">return</span> <span class="n">u</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span> <span class="p">})</span> <span class="o">-</span>
</span></span><span class="line"><span class="cl">                  <span class="n">stk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">==</span> <span class="n">top</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">top</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">stk</span><span class="p">[</span><span class="n">top</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">top</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span> <span class="c1">// ÊúÄÈïø‰∏çÂçáÂ≠êÂ∫èÂàóÁöÑÈïøÂ∫¶ËÆ°ÁÆóÂÆåÊàê
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// Ê†πÊçÆÁãÑÂ∞îÊ≤ÉÊñØÂÆöÁêÜÔºåÊúÄÂ∞ëÁöÑÊúÄÈïø‰∏çÂçáÂ≠êÂ∫èÂàóÊù•Ë¶ÜÁõñÊï¥‰∏™Êï∞ÁªÑÁöÑ‰∏™Êï∞ÔºåÊòØÊúÄÈïø‰∏äÂçáÂ≠êÂ∫èÂàóÁöÑÈïøÂ∫¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// Âõ†Ê≠§ÈúÄË¶ÅÂÜçÊ±Ç‰∏Ä‰∏™ÊúÄÈïø‰∏äÂçáÂ≠êÂ∫èÂàó
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">ll</span> <span class="n">ans2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">top</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ÊâæÁ¨¨‰∏Ä‰∏™Â§ß‰∫éÁ≠â‰∫éa[i]ÁöÑ‰ΩçÁΩÆ ËÆ∞ÂΩïÂú®pos‰∏≠
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">lower_bound</span><span class="p">(</span><span class="n">stk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">stk</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">top</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span>
</span></span><span class="line"><span class="cl">                  <span class="n">stk</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">==</span> <span class="n">top</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">top</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">stk</span><span class="p">[</span><span class="n">top</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans2</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ans2</span><span class="p">,</span> <span class="n">top</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans2</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span> <span class="c1">// ÊúÄÈïø‰∏çÂçáÂ≠êÂ∫èÂàóÁöÑÈïøÂ∫¶ËÆ°ÁÆóÂÆå
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>eg:
<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÂ∞èÊòéÁöÑËä±Â∫óÊñ∞ÂºÄÂº†Ôºå‰∏∫‰∫ÜÂê∏ÂºïÈ°æÂÆ¢Ôºå‰ªñÊÉ≥Âú®Ëä±Â∫óÁöÑÈó®Âè£ÊëÜ‰∏ä‰∏ÄÊéíËä±ÔºåÂÖ± $m$ ÁõÜ„ÄÇÈÄöËøáË∞ÉÊü•È°æÂÆ¢ÁöÑÂñúÂ•ΩÔºåÂ∞èÊòéÂàóÂá∫‰∫ÜÈ°æÂÆ¢ÊúÄÂñúÊ¨¢ÁöÑ $n$ ÁßçËä±Ôºå‰ªé 1 Âà∞ $n$ Ê†áÂè∑„ÄÇ‰∏∫‰∫ÜÂú®Èó®Âè£Â±ïÂá∫Êõ¥Â§öÁßçËä±ÔºåËßÑÂÆöÁ¨¨ $i$ ÁßçËä±‰∏çËÉΩË∂ÖËøá $a_i$ ÁõÜÔºåÊëÜËä±Êó∂Âêå‰∏ÄÁßçËä±ÊîæÂú®‰∏ÄËµ∑Ôºå‰∏î‰∏çÂêåÁßçÁ±ªÁöÑËä±ÈúÄÊåâÊ†áÂè∑ÁöÑ‰ªéÂ∞èÂà∞Â§ßÁöÑÈ°∫Â∫è‰æùÊ¨°ÊëÜÂàó„ÄÇËØïÁºñÁ®ãËÆ°ÁÆóÔºå‰∏ÄÂÖ±ÊúâÂ§öÂ∞ëÁßç‰∏çÂêåÁöÑÊëÜËä±ÊñπÊ°à„ÄÇ
<strong>ËæìÂÖ•Ê†ºÂºè</strong>ÔºöÁ¨¨‰∏ÄË°åÂåÖÂê´‰∏§‰∏™Ê≠£Êï¥Êï∞ $n$ Âíå $m$Ôºå‰∏≠Èó¥Áî®‰∏Ä‰∏™Á©∫Ê†ºÈöîÂºÄ„ÄÇÁ¨¨‰∫åË°åÊúâ $n$ ‰∏™Êï¥Êï∞ÔºåÊØè‰∏§‰∏™Êï¥Êï∞‰πãÈó¥Áî®‰∏Ä‰∏™Á©∫Ê†ºÈöîÂºÄÔºå‰æùÊ¨°Ë°®Á§∫ $a_1, a_2, \ldots, a_n$„ÄÇ
<strong>ËæìÂá∫Ê†ºÂºè</strong>Ôºö‰∏Ä‰∏™Êï¥Êï∞ÔºåË°®Á§∫ÊúâÂ§öÂ∞ëÁßçÊñπÊ°à„ÄÇÊ≥®ÊÑèÔºöÂõ†‰∏∫ÊñπÊ°àÊï∞ÂèØËÉΩÂæàÂ§öÔºåËØ∑ËæìÂá∫ÊñπÊ°àÊï∞ÂØπ $10^6 + 7$ ÂèñÊ®°ÁöÑÁªìÊûú„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="mf">1e6</span> <span class="o">+</span> <span class="mi">7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">dp</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ll</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">dp</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// ÂàùÂßãÂåñ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Âà∞Á¨¨iÁßçËä±‰∏∫Ê≠¢‰∏î‰ª•iÁªìÂ∞æÔºà‰πüÂèØËÉΩÊó†iÔºâÁöÑÊñπÊ°àÊï∞
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ÂÖ±Êîæ‰∫ÜjÁõÜËä±ÁöÑÊñπÊ°àÊï∞
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">j</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// ÊúÄÂêéÁ¨¨iÁßçËä±Êîæ‰∫ÜkÁõÜÁöÑÊñπÊ°àÊï∞
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="n">k</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">dp</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">m</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2Âå∫Èó¥dp">2.Âå∫Èó¥DP
</h3><p>Âå∫Èó¥DPÔºàÂä®ÊÄÅËßÑÂàíÔºâÊòØ‰∏ÄÁßçÂ§ÑÁêÜÊ∂âÂèäÂå∫Èó¥ÈóÆÈ¢òÁöÑÂä®ÊÄÅËßÑÂàíÊñπÊ≥ï„ÄÇÂÆÉÈÄöËøáÂ∞ÜÈóÆÈ¢òÂàÜËß£‰∏∫Êõ¥Â∞èÁöÑÂå∫Èó¥ÔºåÂπ∂Ê±ÇËß£Ëøô‰∫õÂ∞èÂå∫Èó¥ÁöÑÊúÄ‰ºòËß£ÔºåÁÑ∂ÂêéÂ∞ÜËøô‰∫õËß£ÂêàÂπ∂‰ª•ÂæóÂà∞Êï¥‰∏™Â§ßÂå∫Èó¥ÁöÑÊúÄ‰ºòËß£„ÄÇ‰ª•‰∏ãÊòØÂå∫Èó¥DPÁöÑ‰∏Ä‰∫õÂÖ≥ÈîÆÁÇπÔºö
<strong>ÂÆö‰πâ</strong>ÔºöÂå∫Èó¥DPÊòØÁ∫øÊÄßDPÁöÑ‰∏ÄÁßçÔºåÂÆÉ‰ª•‚ÄúÂå∫Èó¥ÈïøÂ∫¶‚ÄùÂàíÂàÜÈò∂ÊÆµÔºåÂπ∂‰ª•‰∏§‰∏™ÂùêÊ†áÔºàÂå∫Èó¥ÁöÑÂ∑¶Âè≥Á´ØÁÇπÔºâ‰Ωú‰∏∫Áä∂ÊÄÅÁöÑÁª¥Â∫¶„ÄÇ‰∏Ä‰∏™Áä∂ÊÄÅÈÄöÂ∏∏Áî±Ë¢´ÂÆÉÂåÖÂê´‰∏îÊØîÂÆÉÊõ¥Â∞èÁöÑÂå∫Èó¥Áä∂ÊÄÅËΩ¨ÁßªËÄåÊù•„ÄÇ
<strong>Ê†∏ÂøÉÊÄùË∑Ø</strong>ÔºöÂå∫Èó¥DPÁöÑÊ†∏ÂøÉÊÄùÊÉ≥ÊòØÂ∞Ü‰∏Ä‰∏™Â§ßÂå∫Èó¥ÂàÜÂâ≤ÊàêÂ§ö‰∏™Â∞èÂå∫Èó¥ÔºåÂàÜÂà´Ê±ÇËß£ÊØè‰∏™Â∞èÂå∫Èó¥ÁöÑÊúÄ‰ºòËß£ÔºåÁÑ∂ÂêéÂêàÂπ∂Ëøô‰∫õËß£‰ª•ÂæóÂà∞Êï¥‰∏™Â§ßÂå∫Èó¥ÁöÑÊúÄ‰ºòËß£„ÄÇ
<strong>Â∫îÁî®</strong>ÔºöÂå∫Èó¥DPÂ∏∏Áî®‰∫éËß£ÂÜ≥ÊúÄÈïøÂÖ¨ÂÖ±Â≠êÂ∫èÂàó„ÄÅÊúÄÈïøÂõûÊñáÂ≠ê‰∏≤Á≠âÈóÆÈ¢ò„ÄÇÂú®Âå∫Èó¥DP‰∏≠ÔºåÈÄöÂ∏∏ÈúÄË¶ÅÂÆö‰πâ‰∏Ä‰∏™‰∫åÁª¥Êï∞ÁªÑÊù•Ë°®Á§∫Â≠êÂå∫Èó¥ÁöÑÁä∂ÊÄÅÔºåÂπ∂ÊûÑÂª∫Áä∂ÊÄÅËΩ¨ÁßªÊñπÁ®ã„ÄÇ</p>
<p>egÔºö
<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÊúâ ( n ) Â†ÜÁü≥Â≠êÊéíÈòü‰∏ÄÊéíÔºåÁºñÂè∑‰∏∫ ( 1, 2, 3, \cdots, n )ÔºåÊØèÂ†ÜÁü≥Â≠êÊúâ‰∏Ä‰∏™Ë¥®Èáè ( a_i )„ÄÇÊàë‰ª¨ÊØèÊ¨°ÂèØ‰ª•ÂêàÂπ∂Áõ∏ÈÇªÁöÑ‰∏§Â†ÜÁü≥Â≠êÔºå‰∏îÂêàÂπ∂ÈúÄËä±Ë¥π‰ª£‰ª∑‰∏∫Ëøô‰∏§Â†ÜÁü≥Â≠êÁöÑË¥®Èáè‰πãÂíåÔºåÁé∞Âú®Ë¶ÅÂ∞ÜËøô ( n ) Â†ÜÁü≥Â≠êÂêàÂπ∂Êàê‰∏ÄÂ†Ü„ÄÇÂêàÂπ∂Êó∂Áî±‰∫éÈ°∫Â∫è‰∏çÂêåÔºåÂêàÂπ∂ÁöÑÊÄª‰ª£‰ª∑‰πü‰ºöÊúâÂå∫Âà´ÔºåËØ∑‰Ω†ËÆ°ÁÆóÂá∫ÊâÄÈúÄÁöÑÊúÄÂ∞èÊÄª‰ª£‰ª∑„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>ÔºöÁ¨¨‰∏ÄË°åÔºö‰∏Ä‰∏™Êï¥Êï∞ ( n )ÔºåË°®Á§∫Áü≥Â≠êÁöÑÂ†ÜÊï∞„ÄÇ( ( 1 \leq n \leq 300 ) )Á¨¨‰∫åË°åÔºö( n ) ‰∏™Êï¥Êï∞ÔºåË°®Á§∫ÊØèÂ†ÜÁü≥Â≠êÁöÑË¥®Èáè ( a_i )„ÄÇ( ( 1 \leq a_i \leq 1000 ) )
<strong>ËæìÂá∫ÊèèËø∞</strong>Ôºö‰∏Ä‰∏™Êï¥Êï∞ÔºåË°®Á§∫ÂêàÂπ∂Êàê‰∏ÄÂ†ÜÊâÄÈúÄÁöÑÊúÄÂ∞èÊÄª‰ª£‰ª∑„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">500</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">ll</span> <span class="n">inf</span> <span class="o">=</span> <span class="mf">4e18</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">],</span> <span class="n">prefix</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">prefix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefix</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Êûö‰∏æÂå∫Èó¥ÈïøÂ∫¶k
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">len</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">len</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Êûö‰∏æÂå∫Èó¥Ëµ∑ÁÇπi ‰πüÂ∞±ÂæóÂà∞‰∫ÜÁªàÁÇπj
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">,</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// ÂàùÂßãÂåñÔºö
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">inf</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Êûö‰∏æÂå∫Èó¥‰∏≠Èó¥ÁöÑÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">j</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">dp</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">prefix</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">prefix</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">dp</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3Ê†ëÂΩ¢dp">3.Ê†ëÂΩ¢DP
</h3><p><strong>ÁâπÁÇπ</strong>Ôºö</p>
<ul>
<li>ÂÆö‰πâÂú®Ê†ëÁªìÊûÑ‰∏äÔºåÂà©Áî®Â≠êÊ†ëÈÄíÂΩíÊ±ÇËß£„ÄÇ</li>
<li>Â∏∏Áî®Âú®Ê±ÇÊ†ëÁöÑÊüê‰∫õÊÄßË¥®Ôºå‰æãÂ¶ÇÁõ¥ÂæÑ„ÄÅÊúÄÈïøË∑ØÂæÑ„ÄÅËäÇÁÇπÊùÉÂÄº‰ºòÂåñÁ≠â„ÄÇ</li>
</ul>
<p><strong>Áä∂ÊÄÅÂÆö‰πâ</strong>Ôºö</p>
<ul>
<li>ÈÄöÂ∏∏ÂÆö‰πâ‰∏∫ <code>dp[u]</code>ÔºåË°®Á§∫‰ª•ËäÇÁÇπ <code>u</code> ‰∏∫Ê†πÁöÑÂ≠êÊ†ë‰∏≠ÊüêÁßçÊÄßË¥®ÁöÑÊúÄ‰ºòËß£„ÄÇ</li>
</ul>
<p><strong>ÂÖ∏ÂûãÈóÆÈ¢ò</strong>Ôºö  Ê†ëÁöÑÁõ¥ÂæÑ„ÄÅÊ†ë‰∏äËÉåÂåÖÈóÆÈ¢ò„ÄÅÊ†ëÁöÑÊüìËâ≤ÈóÆÈ¢ò</p>
<p><strong>‰æãÂ≠ê</strong>Ôºö<br>
<strong>Ê†ëÁöÑÁõ¥ÂæÑ</strong>Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">parent</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="nl">v</span> <span class="p">:</span> <span class="n">tree</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">!=</span> <span class="n">parent</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">dp</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Áî®ÂΩíÂ±ûÊ≥ïÔºåÊää‰∏ÄÊ£µÂ≠êÊ†ëÁöÑÊùÉÂÄºÂíåÂΩíÂ±ûÂà∞Ê†πËäÇÁÇπ‰∏ä</strong>
eg:
<strong>È¢òÁõÆÊèèËø∞</strong>ÔºöÁªôÂÆö‰∏ÄÊ£µ ( n ) ‰∏™ËäÇÁÇπÁöÑÊ†ëÔºåÊØè‰∏™ËäÇÁÇπ ( i (1 \leq i \leq n) ) ÈÉΩÊúâ‰∏Ä‰∏™ÊùÉÂÄº ( w_i )„ÄÇÊàë‰ª¨ËßÑÂÆö‰∏Ä‰∏™ËøûÈÄöÂùóÁöÑÊùÉÂÄº‰∏∫ÔºåËøûÈÄöÂùó‰∏≠ÊâÄÊúâËäÇÁÇπÁöÑÊùÉÂÄº‰πãÂíåÔºåËØ∑‰Ω†Ê±ÇÂá∫ÊúÄÂ§ßÁöÑËøûÈÄöÂùóÊùÉÂÄº„ÄÇÊ≥®ÊÑèÔºöËøûÈÄöÂùóÈúÄÂåÖÂê´Ëá≥Â∞ë‰∏Ä‰∏™ËäÇÁÇπ„ÄÇ
<strong>ËæìÂÖ•ÊèèËø∞</strong>ÔºöÁ¨¨‰∏ÄË°åÔºå‰∏Ä‰∏™Êï¥Êï∞ ( t )ÔºåË°®Á§∫Ê°à‰æã‰∏™Êï∞„ÄÇÂØπ‰∫éÊØè‰∏™Ê°à‰æã:Á¨¨‰∏ÄË°åÔºå‰∏Ä‰∏™Êï¥Êï∞ ( n )ÔºåË°®Á§∫ËäÇÁÇπÊï∞„ÄÇ ( \left(1 \leq n \leq 10^5\right) ) Á¨¨‰∫åË°åÔºå( n ) ‰∏™Êï¥Êï∞ÔºåË°®Á§∫ËäÇÁÇπÊùÉÂÄº ( w_i )„ÄÇ ( \left(-10^4 \leq w_i \leq 10^4\right) ) Êé•‰∏ãÊù• ( n-1 ) Ë°åÔºåÊØèË°å‰∏§‰∏™Êï¥Êï∞ ( u, v )ÔºåË°®Á§∫Â≠òÂú®‰∏ÄÊù°ËøûÊé•ËäÇÁÇπ ( u ) Âíå ( v ) ÁöÑËæπ„ÄÇ ( (1 \leq u, v \leq n, u \neq v) ) ËæìÂÖ•‰øùËØÅÔºöÊâÄÊúâÊ°à‰æãÁöÑ ( n ) ‰πãÂíå‰∏çË∂ÖËøá ( 2 \times 10^5 )ÔºåÂç≥ ( 1 \leq \sum n \leq 2 \times 10^5 )„ÄÇ
<strong>ËæìÂá∫ÊèèËø∞</strong>Ôºö‰∏Ä‰∏™Êï¥Êï∞ÔºåË°®Á§∫ÊúÄÂ§ßËøûÈÄöÂùóÊùÉÂÄº„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">dp</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">// Ë°®Á§∫‰ª•i‰∏∫Ê†πÁöÑÂ≠êÊ†ëÁöÑÊùÉÂÄºÂíå
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="n">w</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pre</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">dp</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="nl">y</span> <span class="p">:</span> <span class="n">g</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="c1">// ÈÅçÂéÜÂÑøÂ≠êËäÇÁÇπ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">pre</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">dfs</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">dp</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="n">dp</span><span class="p">[</span><span class="n">x</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span> <span class="c1">// ÂàùÂßãÂåñ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">max_element</span><span class="p">(</span><span class="n">dp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dp</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">_</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">_</span><span class="o">--</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>4. Áä∂ÊÄÅÂéãÁº© DPÔºàÁä∂Âéã DPÔºâ</strong></p>
<p><strong>ÁâπÁÇπ</strong>Ôºö</p>
<ul>
<li>Áî®‰∏Ä‰∏™Êï¥Êï∞ÔºàÈÄöÂ∏∏ÊòØ‰ΩçÊé©Á†ÅÔºâË°®Á§∫‰∏Ä‰∏™Áä∂ÊÄÅÔºå‰ªéËÄåÂéãÁº©Â§çÊùÇÂ∫¶„ÄÇ</li>
<li>Â∏∏Áî®‰∫éÁªÑÂêàÈóÆÈ¢òÔºåÊ∂âÂèäÂ≠êÈõÜ„ÄÅÊéíÂàóÁ≠âÊÉÖÂÜµ„ÄÇ</li>
</ul>
<p><strong>Áä∂ÊÄÅÂÆö‰πâ</strong>Ôºö</p>
<ul>
<li>‰∏ÄËà¨ÊòØ <code>dp[mask]</code>ÔºåË°®Á§∫Áä∂ÊÄÅ‰∏∫ <code>mask</code> Êó∂ÁöÑÊúÄ‰ºòËß£„ÄÇ</li>
</ul>
<p><strong>ÂÖ∏ÂûãÈóÆÈ¢ò</strong>Ôºö  ÊóÖË°åÂïÜÈóÆÈ¢òÔºàTSPÔºâ„ÄÅÊúÄÂ∞èË∑ØÂæÑË¶ÜÁõñÈóÆÈ¢ò„ÄÅÈõÜÂêàË¶ÜÁõñÈóÆÈ¢ò„ÄÅÂ§ö‰∫∫Ê∏∏ÊàèÂçöÂºàÈóÆÈ¢ò</p>
<p><strong>‰æãÂ≠ê</strong>Ôºö<br>
<strong>ÊóÖË°åÂïÜÈóÆÈ¢ò</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">mask</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">mask</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">);</span> <span class="o">++</span><span class="n">mask</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">dp</span><span class="p">[</span><span class="n">mask</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">mask</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">mask</span> <span class="o">^</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">dist</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>5. ÊúüÊúõ DP</strong></p>
<p><strong>ÁâπÁÇπ</strong>Ôºö</p>
<ul>
<li>Áî®‰∫éËÆ°ÁÆóÈöèÊú∫ËøáÁ®ã‰∏≠ÁöÑÊúüÊúõÂÄº„ÄÇ</li>
<li>ÈÄöÂ∏∏ÈúÄË¶ÅÂ∞ÜÁä∂ÊÄÅËΩ¨ÁßªÂÖ¨ÂºèË∞ÉÊï¥‰∏∫ÊúüÊúõÂΩ¢ÂºèÔºå‰æãÂ¶ÇÊ¶ÇÁéáÂä†ÊùÉÂíå„ÄÇ</li>
</ul>
<p><strong>Áä∂ÊÄÅÂÆö‰πâ</strong>Ôºö</p>
<ul>
<li>‰∏ÄËà¨ÂÆö‰πâ‰∏∫ <code>dp[i]</code>ÔºåË°®Á§∫‰ªéÁä∂ÊÄÅ <code>i</code> ÂºÄÂßãÁöÑÊúüÊúõÂÄº„ÄÇ</li>
</ul>
<p><strong>ÂÖ∏ÂûãÈóÆÈ¢ò</strong>Ôºö  Ê∏∏Êàè‰∏≠ÁöÑËÉúÁéáÊúüÊúõ„ÄÅÈ™∞Â≠êÈóÆÈ¢ò„ÄÅÂàÜÊï∞ÊúüÊúõ</p>
<p><strong>‰æãÂ≠ê</strong>Ôºö<br>
<strong>È™∞Â≠êÈóÆÈ¢ò</strong>Ôºö<br>
ÁªôÂÆö‰∏Ä‰∏™È™∞Â≠êÔºåÊ±ÇÊé∑Âá∫Êüê‰∏™ÊÄªÁÇπÊï∞ÊâÄÈúÄÁöÑÊúÄÂ∞ëÊ¨°Êï∞„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">target</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dp</span><span class="p">[</span><span class="n">min</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">)]</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>6. Â≠òÂú®ÊÄß DP</strong></p>
<p><strong>ÁâπÁÇπ</strong>Ôºö</p>
<ul>
<li>Âà§Êñ≠ÊüêÁßçÁä∂ÊÄÅÊòØÂê¶ÂèØË°åÔºåËÄåÈùûÊ±ÇÂÖ∑‰ΩìÂÄº„ÄÇ</li>
<li>ÁªìÊûúÈÄöÂ∏∏ÊòØ <code>true/false</code> Êàñ &ldquo;Yes/No&rdquo;„ÄÇ</li>
</ul>
<p><strong>Áä∂ÊÄÅÂÆö‰πâ</strong>Ôºö</p>
<ul>
<li>‰∏ÄËà¨ÂÆö‰πâ‰∏∫ <code>dp[i]</code>ÔºåË°®Á§∫ÊòØÂê¶ËÉΩËææÂà∞Êüê‰∏™Áä∂ÊÄÅ„ÄÇ</li>
</ul>
<p><strong>ÂÖ∏ÂûãÈóÆÈ¢ò</strong>Ôºö  Â≠êÈõÜÂíåÈóÆÈ¢ò„ÄÅÂà§Êñ≠ÊòØÂê¶ÂèØ‰ª•ÂàÜÂâ≤Êàê‰∏§‰∏™Â≠êÈõÜÔºàÁ≠âÂíåÂàíÂàÜÔºâ„ÄÅÊ∏∏Êàè‰∏≠ÁöÑÂøÖËÉúÊàñÂøÖË¥•Áä∂ÊÄÅ</p>
<p><strong>‰æãÂ≠ê</strong>Ôºö<br>
<strong>Â≠êÈõÜÂíåÈóÆÈ¢ò</strong>Ôºö<br>
ÁªôÂÆö‰∏ÄÁªÑÊï∞ÔºåÂà§Êñ≠ÊòØÂê¶ÂèØ‰ª•ÈÄâÂá∫‰∏Ä‰∏™Â≠êÈõÜÔºå‰ΩøÂÖ∂ÂíåÁ≠â‰∫éÊüê‰∏™ÂÄº„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">target</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="o">--</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">||</span> <span class="n">dp</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>7. Êï∞‰Ωç DP</strong>
<strong>ÁâπÁÇπ</strong>Ôºö</p>
<ul>
<li>Ëß£ÂÜ≥‰∏éÊï∞Â≠óÊúâÂÖ≥ÁöÑËÆ°Êï∞ÈóÆÈ¢òÔºåÈÄöÂ∏∏Ê∂âÂèäÊüê‰∫õÈôêÂà∂Êù°‰ª∂ÔºàÂ¶Ç‰∏çÂåÖÂê´Êüê‰∏™Êï∞Â≠óÔºâ„ÄÇ</li>
<li>Âà©Áî®Êï∞Â≠óÁöÑÈÄê‰ΩçÂàÜËß£ÔºåÂ∞ÜÈóÆÈ¢òËΩ¨Âåñ‰∏∫Áä∂ÊÄÅËΩ¨Áßª„ÄÇ</li>
</ul>
<p><strong>Áä∂ÊÄÅÂÆö‰πâ</strong>Ôºö</p>
<ul>
<li>‰∏ÄËà¨ÂÆö‰πâ‰∏∫ <code>dp[pos][state]</code>ÔºåË°®Á§∫Âú®Á¨¨ <code>pos</code> ‰ΩçÊó∂ÔºåÁä∂ÊÄÅ‰∏∫ <code>state</code> ÁöÑËÆ°Êï∞ÊàñÊñπÊ°àÊï∞„ÄÇ</li>
</ul>
<p><strong>ÂÖ∏ÂûãÈóÆÈ¢ò</strong>Ôºö  ÁªüËÆ°Êª°Ë∂≥Êüê‰∫õÊù°‰ª∂ÁöÑÊï∞Â≠ó‰∏™Êï∞„ÄÅÊï∞Â≠óÊòØÂê¶ÂåÖÂê´Êüê‰∫õÊï∞Â≠ó„ÄÅÊï∞Â≠óÊåâ‰ΩçÂ•áÂÅ∂ÂàÜÂ∏ÉÈóÆÈ¢ò</p>
<p><strong>‰æãÂ≠ê</strong>Ôºö<br>
<strong>‰∏çÂê´Êï∞Â≠ó 4 ÁöÑÊï∞ÁöÑ‰∏™Êï∞</strong>Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="o">++</span><span class="n">pos</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">state</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">;</span> <span class="o">++</span><span class="n">state</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">digit</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">digit</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="o">++</span><span class="n">digit</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">digit</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">dp</span><span class="p">[</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">new_state</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dp</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="n">state</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ÊÄªÁªì"><strong>ÊÄªÁªì</strong>
</h4><div class="table-wrapper"><table>
<thead>
<tr>
<th><strong>ÂàÜÁ±ª</strong></th>
<th><strong>‰∏ªË¶ÅÁâπÁÇπ</strong></th>
<th><strong>ÂÖ∏ÂûãÈóÆÈ¢ò</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Á∫øÊÄß DP</strong></td>
<td>ÊåâÂ∫èÂàóÈÄíÊé®</td>
<td>LIS, ËÉåÂåÖÈóÆÈ¢ò</td>
</tr>
<tr>
<td><strong>Áä∂Âéã DP</strong></td>
<td>Áä∂ÊÄÅÁî®‰ΩçÂéãÁº©Ë°®Á§∫</td>
<td>TSP, Â≠êÈõÜÈóÆÈ¢ò</td>
</tr>
<tr>
<td><strong>ÊúüÊúõ DP</strong></td>
<td>Ê¶ÇÁéáÊùÉÈáçËÆ°ÁÆó</td>
<td>È™∞Â≠êÊúüÊúõÔºåÈöèÊú∫ÂçöÂºà</td>
</tr>
<tr>
<td><strong>Â≠òÂú®ÊÄß DP</strong></td>
<td>Âà§Êñ≠ÊòØÂê¶ÂèØË°å</td>
<td>Â≠êÈõÜÂíå, Ê∏∏ÊàèÂÜ≥Á≠ñÈóÆÈ¢ò</td>
</tr>
<tr>
<td><strong>Ê†ëÂΩ¢ DP</strong></td>
<td>ÂÆö‰πâÂú®Ê†ëÁªìÊûÑ‰∏ä</td>
<td>Ê†ëÁõ¥ÂæÑ, Ê†ëÊüìËâ≤, Ê†ëËÉåÂåÖ</td>
</tr>
<tr>
<td><strong>Êï∞‰Ωç DP</strong></td>
<td>‰∏éÊï∞Â≠óÁõ∏ÂÖ≥ÁöÑËÆ°Êï∞ÈóÆÈ¢ò</td>
<td>ÁªüËÆ°Êï∞Â≠óÊª°Ë∂≥ÁöÑ‰∏™Êï∞</td>
</tr>
</tbody>
</table></div>
<p>Âä®ÊÄÅËßÑÂàíÊú¨Ë¥®‰∏äÊòØÈÄöËøá<strong>ÂÆö‰πâÁä∂ÊÄÅ</strong>Âíå<strong>ÊâæÂá∫Áä∂ÊÄÅËΩ¨ÁßªÂÖ≥Á≥ª</strong>Ëß£ÂÜ≥ÈóÆÈ¢ò„ÄÇÊéåÊè°ÊØèÁßçÁ±ªÂûãÁöÑÊ†∏ÂøÉÊÄùÊÉ≥ÂíåÂ∫îÁî®Âú∫ÊôØÊòØÂ≠¶‰π†Âä®ÊÄÅËßÑÂàíÁöÑÂÖ≥ÈîÆ„ÄÇ</p>

</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Áõ∏ÂÖ≥ÊñáÁ´†</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/git/">
        
        
            <div class="article-image">
                <img src="/p/git/Gitlogo.3538257f7cd518456dd1a85e77c64e71_hu7057219469952975004.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post GitÂÖ•Èó®"
                        data-key="git" 
                        data-hash="md5-NTglf3zVGEVt0ahed8ZOcQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">GitÂÖ•Èó®</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2024 Nanmur
    </section>
    
    <section class="powerby">
        ‰ΩøÁî® <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> ÊûÑÂª∫ <br />
        ‰∏ªÈ¢ò <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.26.0">Stack</a></b> Áî± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> ËÆæËÆ°
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
